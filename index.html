<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta
			name="viewport"
			content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"
		/>
		<link rel="manifest" href="/manifest.json" />
		<link rel="shortcut icon" href="icon.png" />
		<link rel="stylesheet" href="style.css" />
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link
			href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap"
			rel="stylesheet"
		/>
		<link
			href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&display=swap"
			rel="stylesheet"
		/>
		<title>Structure</title>
	</head>
	<body class="app">
		<div class="activitybar">
			<div class="_top">
				<div class="option xkFKbnhZw">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 24 24"
						width="24"
						height="24"
						fill="none"
					>
						<path
							d="M20 8.5V13.5C20 17.2712 20 19.1569 18.8284 20.3284C17.6569 21.5 15.7712 21.5 12 21.5C8.22876 21.5 6.34315 21.5 5.17157 20.3284C4 19.1569 4 17.2712 4 13.5V8.5"
							stroke="currentColor"
							stroke-width="2"
						/>
						<path
							d="M22 10.5L17.6569 6.33548C14.9902 3.77849 13.6569 2.5 12 2.5C10.3431 2.5 9.00981 3.77849 6.34315 6.33548L2 10.5"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
						/>
					</svg>
				</div>
				<div class="option active x18sZv41u">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 24 24"
						width="24"
						height="24"
						fill="none"
					>
						<path
							d="M20 9C19.2048 5.01455 15.5128 2 11.0793 2C6.06549 2 2 5.85521 2 10.61C2 12.8946 2.93819 14.9704 4.46855 16.5108C4.80549 16.85 5.03045 17.3134 4.93966 17.7903C4.78982 18.5701 4.45026 19.2975 3.95305 19.9037C5.26123 20.1449 6.62147 19.9277 7.78801 19.3127C8.20039 19.0954 8.40657 18.9867 8.55207 18.9646C8.65392 18.9492 8.78659 18.9636 9 19.0002"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						/>
						<path
							d="M11 16.2617C11 19.1674 13.4628 21.5234 16.5 21.5234C16.8571 21.5238 17.2132 21.4908 17.564 21.425C17.8165 21.3775 17.9428 21.3538 18.0309 21.3673C18.119 21.3807 18.244 21.4472 18.4938 21.58C19.2004 21.9558 20.0244 22.0885 20.8169 21.9411C20.5157 21.5707 20.31 21.1262 20.2192 20.6496C20.1642 20.3582 20.3005 20.075 20.5046 19.8677C21.4317 18.9263 22 17.6578 22 16.2617C22 13.356 19.5372 11 16.5 11C13.4628 11 11 13.356 11 16.2617Z"
							stroke="currentColor"
							stroke-width="2"
							stroke-linejoin="round"
						/>
					</svg>
				</div>
				<div class="option xu3HFdqzZ">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 24 24"
						fill="none"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					>
						<circle cx="12" cy="12" r="10"></circle>
						<polygon
							points="16.24 7.76 14.12 14.12 7.76 16.24 9.88 9.88 16.24 7.76"
						></polygon>
					</svg>
				</div>
			</div>
			<div class="_bottom">
				<div class="option xyZerx9LS">
					<svg
						xmlns="http://www.w3.org/2000/svg"
						viewBox="0 0 24 24"
						width="24"
						height="24"
						fill="none"
					>
						<path
							d="M21.3175 7.14139L20.8239 6.28479C20.4506 5.63696 20.264 5.31305 19.9464 5.18388C19.6288 5.05472 19.2696 5.15664 18.5513 5.36048L17.3311 5.70418C16.8725 5.80994 16.3913 5.74994 15.9726 5.53479L15.6357 5.34042C15.2766 5.11043 15.0004 4.77133 14.8475 4.37274L14.5136 3.37536C14.294 2.71534 14.1842 2.38533 13.9228 2.19657C13.6615 2.00781 13.3143 2.00781 12.6199 2.00781H11.5051C10.8108 2.00781 10.4636 2.00781 10.2022 2.19657C9.94085 2.38533 9.83106 2.71534 9.61149 3.37536L9.27753 4.37274C9.12465 4.77133 8.84845 5.11043 8.48937 5.34042L8.15249 5.53479C7.73374 5.74994 7.25259 5.80994 6.79398 5.70418L5.57375 5.36048C4.85541 5.15664 4.49625 5.05472 4.17867 5.18388C3.86109 5.31305 3.67445 5.63696 3.30115 6.28479L2.80757 7.14139C2.45766 7.74864 2.2827 8.05227 2.31666 8.37549C2.35061 8.69871 2.58483 8.95918 3.05326 9.48012L4.0843 10.6328C4.3363 10.9518 4.51521 11.5078 4.51521 12.0077C4.51521 12.5078 4.33636 13.0636 4.08433 13.3827L3.05326 14.5354C2.58483 15.0564 2.35062 15.3168 2.31666 15.6401C2.2827 15.9633 2.45766 16.2669 2.80757 16.8741L3.30114 17.7307C3.67443 18.3785 3.86109 18.7025 4.17867 18.8316C4.49625 18.9608 4.85542 18.8589 5.57377 18.655L6.79394 18.3113C7.25263 18.2055 7.73387 18.2656 8.15267 18.4808L8.4895 18.6752C8.84851 18.9052 9.12464 19.2442 9.2775 19.6428L9.61149 20.6403C9.83106 21.3003 9.94085 21.6303 10.2022 21.8191C10.4636 22.0078 10.8108 22.0078 11.5051 22.0078H12.6199C13.3143 22.0078 13.6615 22.0078 13.9228 21.8191C14.1842 21.6303 14.294 21.3003 14.5136 20.6403L14.8476 19.6428C15.0004 19.2442 15.2765 18.9052 15.6356 18.6752L15.9724 18.4808C16.3912 18.2656 16.8724 18.2055 17.3311 18.3113L18.5513 18.655C19.2696 18.8589 19.6288 18.9608 19.9464 18.8316C20.264 18.7025 20.4506 18.3785 20.8239 17.7307L21.3175 16.8741C21.6674 16.2669 21.8423 15.9633 21.8084 15.6401C21.7744 15.3168 21.5402 15.0564 21.0718 14.5354L20.0407 13.3827C19.7887 13.0636 19.6098 12.5078 19.6098 12.0077C19.6098 11.5078 19.7888 10.9518 20.0407 10.6328L21.0718 9.48012C21.5402 8.95918 21.7744 8.69871 21.8084 8.37549C21.8423 8.05227 21.6674 7.74864 21.3175 7.14139Z"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
						/>
						<path
							d="M15.5195 12C15.5195 13.933 13.9525 15.5 12.0195 15.5C10.0865 15.5 8.51953 13.933 8.51953 12C8.51953 10.067 10.0865 8.5 12.0195 8.5C13.9525 8.5 15.5195 10.067 15.5195 12Z"
							stroke="currentColor"
							stroke-width="2"
						/>
					</svg>
				</div>
			</div>
		</div>
		<div class="sidebar">
			<div class="xCzYCeh7x">
				<a class="xbfRemN6Z" href="./">Structure</a>
			</div>
			<div class="x8u3Iqtu9">
				<svg
					class="x1YPTYxid"
					xmlns="http://www.w3.org/2000/svg"
					viewBox="0 0 24 24"
					width="24"
					height="24"
					fill="none"
				>
					<path
						d="M17.5 17.5L22 22"
						stroke="currentColor"
						stroke-width="2"
						stroke-linecap="round"
						stroke-linejoin="round"
					/>
					<path
						d="M20 11C20 6.02944 15.9706 2 11 2C6.02944 2 2 6.02944 2 11C2 15.9706 6.02944 20 11 20C15.9706 20 20 15.9706 20 11Z"
						stroke="currentColor"
						stroke-width="2"
						stroke-linejoin="round"
					/>
				</svg>
				<input
					class="xujXllYgW"
					type="text"
					placeholder="Search..."
					disabled
					maxlength="25"
					tabindex="0"
				/>
			</div>
			<div class="x8FrVw7Ca">
				<div class="xemr1y6ie">No items found</div>
			</div>
		</div>
		<div class="main">
			<div class="header">
				<div class="_left">
					<div class="actionbtn">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="28"
							height="28"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<line x1="4" x2="20" y1="12" y2="12" />
							<line x1="4" x2="20" y1="6" y2="6" />
							<line x1="4" x2="20" y1="18" y2="18" />
						</svg>
					</div>
					<span>Structure</span>
				</div>
				<div class="_right">
					<div class="actionbtn">
						<svg
							xmlns="http://www.w3.org/2000/svg"
							width="24"
							height="24"
							viewBox="0 0 24 24"
							fill="none"
							stroke="currentColor"
							stroke-width="2"
							stroke-linecap="round"
							stroke-linejoin="round"
						>
							<circle cx="12" cy="12" r="1" />
							<circle cx="12" cy="5" r="1" />
							<circle cx="12" cy="19" r="1" />
						</svg>
					</div>
				</div>
			</div>
			<div class="xikyLwDf4 xVjpzmyej">
				<!--忘用Shadow DOM-->
			</div>
			<div class="x9vGRGDgT">
				<div class="xkFjA3rNT">
					<div class="xu3LrfLBe">
						<label class="xqzuE31k1" for="file_uploader">
							<svg
								xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 24 24"
								width="24"
								height="24"
								fill="none"
							>
								<path
									d="M12.5 2H12.7727C16.0339 2 17.6645 2 18.7969 2.79784C19.1214 3.02643 19.4094 3.29752 19.6523 3.60289C20.5 4.66867 20.5 6.20336 20.5 9.27273V11.8182C20.5 14.7814 20.5 16.2629 20.0311 17.4462C19.2772 19.3486 17.6829 20.8491 15.6616 21.5586C14.4044 22 12.8302 22 9.68182 22C7.88275 22 6.98322 22 6.26478 21.7478C5.10979 21.3424 4.19875 20.4849 3.76796 19.3979C3.5 18.7217 3.5 17.8751 3.5 16.1818V12"
									stroke="currentColor"
									stroke-width="2"
									stroke-linecap="round"
									stroke-linejoin="round"
								/>
								<path
									d="M20.5 12C20.5 13.8409 19.0076 15.3333 17.1667 15.3333C16.5009 15.3333 15.716 15.2167 15.0686 15.3901C14.4935 15.5442 14.0442 15.9935 13.8901 16.5686C13.7167 17.216 13.8333 18.0009 13.8333 18.6667C13.8333 20.5076 12.3409 22 10.5 22"
									stroke="currentColor"
									stroke-width="2"
									stroke-linecap="round"
									stroke-linejoin="round"
								/>
								<path
									d="M4.5 4.5C4.99153 3.9943 6.29977 2 7 2M9.5 4.5C9.00847 3.9943 7.70023 2 7 2M7 2L7 10"
									stroke="currentColor"
									stroke-width="2"
									stroke-linecap="round"
									stroke-linejoin="round"
								/>
							</svg>
						</label>
						<input type="file" hidden id="file_uploader" disabled />
						<div
							class="xtsARDHTI"
							contenteditable="false"
							autocomplete="off"
							spellcheck="false"
							tabindex="0"
						></div>
						<div class="xuwRtDpu4" tabindex="0">
							<svg
								class="x1EV2qZZE"
								xmlns="http://www.w3.org/2000/svg"
								viewBox="0 0 24 24"
							>
								<path
									fill="#ffffff"
									d="m12.815 12.197l-7.532 1.255a.5.5 0 0 0-.386.318L2.3 20.728c-.248.64.421 1.25 1.035.942l18-9a.75.75 0 0 0 0-1.341l-18-9c-.614-.307-1.283.303-1.035.942l2.598 6.958a.5.5 0 0 0 .386.318l7.532 1.255a.2.2 0 0 1 0 .395"
								></path>
							</svg>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="xLwq2C6gp">
			<div class="x6xGhJciS">
				<div class="xK6zzHdt3">Please enter the invitation code</div>
				<input
					autofocus
					class="xPgDa0opT"
					type="text"
					spellcheck="false"
					autocomplete="off"
				/>
				<div class="xHiNaAdY7">
					<span>The invitation code cannot be found</span>
				</div>
				<div class="x7dBirbNO" tabindex="0" translate="no">
					<span>OK</span>
				</div>
			</div>
		</div>
		<div class="xaAFBykLS">
			<div class="item" data-conid="edit">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="18"
					height="18"
					viewBox="0 0 24 24"
					fill="none"
					stroke="#e2e3e5"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<path
						d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"
					/>
				</svg>
				<div class="cont">Edit</div>
			</div>
			<div class="item" data-conid="copy">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="18"
					height="18"
					viewBox="0 0 24 24"
					fill="none"
					stroke="#e2e3e5"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<rect width="14" height="14" x="8" y="8" rx="2" ry="2" />
					<path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" />
				</svg>
				<div class="cont">Copy</div>
			</div>
			<div class="separator"></div>
			<div class="item" data-conid="translate">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="18"
					height="18"
					viewBox="0 0 24 24"
					fill="none"
					stroke="#e2e3e5"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<path d="m5 8 6 6" />
					<path d="m4 14 6-6 2-3" />
					<path d="M2 5h12" />
					<path d="M7 2h1" />
					<path d="m22 22-5-10-5 10" />
					<path d="M14 18h6" />
				</svg>
				<div class="cont">Translate</div>
			</div>
			<div class="item" data-conid="share">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="18"
					height="18"
					viewBox="0 0 24 24"
					fill="none"
					stroke="#e2e3e5"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<polyline points="15 17 20 12 15 7" />
					<path d="M4 18v-2a4 4 0 0 1 4-4h12" />
				</svg>
				<div class="cont">Share</div>
			</div>
			<div class="separator"></div>
			<div class="item rd" data-conid="delete">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="18"
					height="18"
					viewBox="0 0 24 24"
					fill="none"
					stroke="#e2e3e5"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<path d="M3 6h18" />
					<path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
					<path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
				</svg>
				<div class="cont">Delete</div>
			</div>
		</div>
		<div class="xaAFBykLS">
			<div class="item rd" data-conid="delete">
				<svg
					xmlns="http://www.w3.org/2000/svg"
					width="18"
					height="18"
					viewBox="0 0 24 24"
					fill="none"
					stroke="#e2e3e5"
					stroke-width="2"
					stroke-linecap="round"
					stroke-linejoin="round"
				>
					<path d="M3 6h18" />
					<path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />
					<path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />
				</svg>
				<div class="cont">Delete</div>
			</div>
		</div>
		<script type="module">
			import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js";
			import {
				getStorage,
				ref as storagRef,
				uploadBytesResumable,
				getDownloadURL,
			} from "https://www.gstatic.com/firebasejs/9.6.1/firebase-storage.js";
			import {
				getDatabase,
				get,
				ref as databaseRef,
				set,
				onValue,
			} from "https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js";

			const firebaseConfig = {
				apiKey: "AIzaSyAp73V5ZsBUtpy4kS3",
				authDomain: "smiling-theory-397204.firebaseapp.com",
				databaseURL:
					"https://smiling-theory-397204-default-rtdb.asia-southeast1.firebasedatabase.app",
				projectId: "smiling-theory-397204",
				storageBucket: "smiling-theory-397204.appspot.com",
				messagingSenderId: "360479398694",
				appId: "1:360479398694:web:a827941ea3db2bc2a8ffe7",
				measurementId: "G-MB98QK6ZCD",
			};

			const firebaseApp = initializeApp(firebaseConfig);
			const storage = getStorage(firebaseApp);
			const database = getDatabase(firebaseApp);

			window.GetData = async function (key) {
				const dataRef = databaseRef(database, key);
				try {
					const snapshot = await get(dataRef);
					if (snapshot.exists()) {
						return snapshot.val();
					} else {
						return null;
					}
				} catch (c) {
					throw c;
				}
			};

			window.WriteData = async function (message, timestamp, uid, sender) {
				const data = {
					message: message,
					timestamp: timestamp,
					uid: uid,
					sender: sender,
				};

				try {
					await set(databaseRef(database, "chat"), data);
				} catch (error) {
					throw error;
				}
			};

			onValue(databaseRef(database, "chat"), (k) => {
				var z = k.val();
				if (z.sender !== window.user_id && _N0 === true) {
					_A25(z.message, z.uid, z.sender, false);
					if (document.visibilityState == "hidden") {
						totalNoSee++;
						var _n = totalNoSee > 99 ? "99+" : totalNoSee;
						document.title = `(${_n}) Structure`;
					}
				}
			});

			function uploadFile(prog, file, h2, info) {
				if (!file) {
					console.error("No file selected.");
					return;
				}

				const storageRef = storagRef(storage, "/resource" + file.name);
				const uploadTask = uploadBytesResumable(storageRef, file);

				uploadTask.on(
					"state_changed",
					(snapshot) => {
						const progress =
							(snapshot.bytesTransferred / snapshot.totalBytes) * 100;
						prog.style.width = progress + "%";
					},
					(error) => {
						console.error("上传失败：", error);
					},
					() => {
						prog.style.opacity = "0";
						console.log("上传成功！");
						getDownloadURL(uploadTask.snapshot.ref).then((downloadURL) => {
							h2.classList.add("x7mSAl4Aa");
							h2.href = downloadURL;
							h2.target = "_blank";
							try {
								WriteData(info.a.innerHTML, info.b, info.c, info.d);
							} catch (r) {
								console.log(r);
							}
						});
					}
				);
			}

			window.uploadFile = uploadFile;
		</script>
		<script src="script.js"></script>
	</body>
</html>
