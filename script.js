/**release 0.19*/
/*! For license information please see bundle.js.LICENSE.txt */ import{initializeApp as e}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-app.js";import{getAuth as t,signInWithPopup as n,GoogleAuthProvider as a,onAuthStateChanged as r,signInWithEmailAndPassword as i,signOut as o}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-auth.js";import{getStorage as s,ref as c,uploadBytesResumable as l,getDownloadURL as d}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-storage.js";import{getFirestore as u,collection as h,setDoc as p,doc as f,getDoc as v,getDocs as $,startAfter as m,onSnapshot as _,query as g,orderBy as x,limit as y}from"https://www.gstatic.com/firebasejs/9.0.2/firebase-firestore.js";(()=>{function b(){"use strict";b=function(){return t};var e,t={},n=Object.prototype,a=n.hasOwnProperty,r=Object.defineProperty||function(e,t,n){e[t]=n.value},i="function"==typeof Symbol?Symbol:{},o=i.iterator||"@@iterator",s=i.asyncIterator||"@@asyncIterator",c=i.toStringTag||"@@toStringTag";function l(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{l({},"")}catch(d){l=function(e,t,n){return e[t]=n}}function u(t,n,a,i){var o,s,c,l,d=Object.create((n&&n.prototype instanceof m?n:m).prototype);return r(d,"_invoke",{value:(o=t,s=a,c=new I(i||[]),l=p,function(t,n){if(l===f)throw Error("Generator is already running");if(l===v){if("throw"===t)throw n;return{value:e,done:!0}}for(c.method=t,c.arg=n;;){var a=c.delegate;if(a){var r=A(a,c);if(r){if(r===$)continue;return r}}if("next"===c.method)c.sent=c._sent=c.arg;else if("throw"===c.method){if(l===p)throw l=v,c.arg;c.dispatchException(c.arg)}else"return"===c.method&&c.abrupt("return",c.arg);l=f;var i=h(o,s,c);if("normal"===i.type){if(l=c.done?v:"suspendedYield",i.arg===$)continue;return{value:i.arg,done:c.done}}"throw"===i.type&&(l=v,c.method="throw",c.arg=i.arg)}})}),d}function h(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(a){return{type:"throw",arg:a}}}t.wrap=u;var p="suspendedStart",f="executing",v="completed",$={};function m(){}function _(){}function g(){}var x={};l(x,o,function(){return this});var y=Object.getPrototypeOf,w=y&&y(y(H([])));w&&w!==n&&a.call(w,o)&&(x=w);var C=g.prototype=m.prototype=Object.create(x);function L(e){["next","throw","return"].forEach(function(t){l(e,t,function(e){return this._invoke(t,e)})})}function E(e,t){var n;r(this,"_invoke",{value:function(r,i){function o(){return new t(function(n,o){!function n(r,i,o,s){var c=h(e[r],e,i);if("throw"!==c.type){var l=c.arg,d=l.value;return d&&"object"==k(d)&&a.call(d,"__await")?t.resolve(d.__await).then(function(e){n("next",e,o,s)},function(e){n("throw",e,o,s)}):t.resolve(d).then(function(e){l.value=e,o(l)},function(e){return n("throw",e,o,s)})}s(c.arg)}(r,i,n,o)})}return n=n?n.then(o,o):o()}})}function A(t,n){var a=n.method,r=t.iterator[a];if(r===e)return n.delegate=null,"throw"===a&&t.iterator.return&&(n.method="return",n.arg=e,A(t,n),"throw"===n.method)||"return"!==a&&(n.method="throw",n.arg=TypeError("The iterator does not provide a '"+a+"' method")),$;var i=h(r,t.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,$;var o=i.arg;return o?o.done?(n[t.resultName]=o.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,$):o:(n.method="throw",n.arg=TypeError("iterator result is not an object"),n.delegate=null,$)}function T(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(T,this),this.reset(!0)}function H(t){if(t||""===t){var n=t[o];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var r=-1,i=function n(){for(;++r<t.length;)if(a.call(t,r))return n.value=t[r],n.done=!1,n;return n.value=e,n.done=!0,n};return i.next=i}}throw TypeError(k(t)+" is not iterable")}return _.prototype=g,r(C,"constructor",{value:g,configurable:!0}),r(g,"constructor",{value:_,configurable:!0}),_.displayName=l(g,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===_||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,g):(e.__proto__=g,l(e,c,"GeneratorFunction")),e.prototype=Object.create(C),e},t.awrap=function(e){return{__await:e}},L(E.prototype),l(E.prototype,s,function(){return this}),t.AsyncIterator=E,t.async=function(e,n,a,r,i){void 0===i&&(i=Promise);var o=new E(u(e,n,a,r),i);return t.isGeneratorFunction(n)?o:o.next().then(function(e){return e.done?e.value:o.next()})},L(C),l(C,c,"Generator"),l(C,o,function(){return this}),l(C,"toString",function(){return"[object Generator]"}),t.keys=function(e){var t=Object(e),n=[];for(var a in t)n.push(a);return n.reverse(),function e(){for(;n.length;){var a=n.pop();if(a in t)return e.value=a,e.done=!1,e}return e.done=!0,e}},t.values=H,I.prototype={constructor:I,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function r(a,r){return s.type="throw",s.arg=t,n.next=a,r&&(n.method="next",n.arg=e),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],s=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var c=a.call(o,"catchLoc"),l=a.call(o,"finallyLoc");if(c&&l){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(c){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!l)throw Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,$):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),$},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),M(n),$}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var r=a.arg;M(n)}return r}}throw Error("illegal catch attempt")},delegateYield:function(t,n,a){return this.delegate={iterator:H(t),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=e),$}},t}function w(e,t,n,a,r,i,o){try{var s=e[i](o),c=s.value}catch(l){return void n(l)}s.done?t(c):Promise.resolve(c).then(a,r)}function C(e){return function(){var t=this,n=arguments;return new Promise(function(a,r){var i=e.apply(t,n);function o(e){w(i,a,r,o,s,"next",e)}function s(e){w(i,a,r,o,s,"throw",e)}o(void 0)})}}function L(e,t,n){return(t=M(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function k(e){return(k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function E(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}function A(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,M(a.key),a)}}function T(e,t,n){return t&&A(e.prototype,t),n&&A(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function M(e){var t=function(e){if("object"!=k(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=k(n))return n;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==k(t)?t:t+""}var I,H,S,O=new(T(function e(){E(this,e),this.resources={check:['<path d="M20 6 9 17l-5-5" />'],loader:['<path d="M21 12a9 9 0 1 1-6.219-8.56" />'],copy:['<rect width="14" height="14" x="8" y="8" rx="2" ry="2" />','<path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2" />'],translate:['<path d="m5 8 6 6" />','<path d="m4 14 6-6 2-3" />','<path d="M2 5h12" />','<path d="M7 2h1" />','<path d="m22 22-5-10-5 10" />','<path d="M14 18h6" />'],calendar:['<path d="M8 2v4" />','<path d="M16 2v4" />','<rect width="18" height="18" x="3" y="4" rx="2" />','<path d="M3 10h18" />'],bot:['<path d="M12 8V4H8" />','<rect width="16" height="12" x="4" y="8" rx="2" />','<path d="M2 14h2" />','<path d="M20 14h2" />','<path d="M15 13v2" />','<path d="M9 13v2" />'],package:['<path d="m7.5 4.27 9 5.15" />','<path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z" />','<path d="m3.3 7 8.7 5 8.7-5" />','<path d="M12 22V12" />'],edit:['<path d="M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z" />'],trash:['<path d="M3 6h18" />','<path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6" />','<path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2" />'],more:['<circle cx="12" cy="12" r="1" />','<circle cx="12" cy="5" r="1" />','<circle cx="12" cy="19" r="1" />'],code:['<path d="m18 16 4-4-4-4"/>','<path d="m6 8-4 4 4 4"/>','<path d="m14.5 4-5 16"/></svg>'],heart:['<path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/>'],image:['<rect width="18" height="18" x="3" y="3" rx="2" ry="2"/>','<circle cx="9" cy="9" r="2"/>','<path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/>'],music:['<path d="M9 18V5l12-2v13"/>','<circle cx="6" cy="18" r="3"/>','<circle cx="18" cy="16" r="3"/>'],threads:['<path stroke="none" d="M0 0h24v24H0z" fill="none"/>','<path d="M19 7.5c-1.333 -3 -3.667 -4.5 -7 -4.5c-5 0 -8 2.5 -8 9s3.5 9 8 9s7 -3 7 -5s-1 -5 -7 -5c-2.5 0 -3 1.25 -3 2.5c0 1.5 1 2.5 2.5 2.5c2.5 0 3.5 -1.5 3.5 -5s-2 -4 -3 -4s-1.833 .333 -2.5 1" />'],twitter:['<path stroke="none" d="M0 0h24v24H0z" fill="none"/>','<path d="M4 4l11.733 16h4.267l-11.733 -16z" />','<path d="M4 20l6.768 -6.768m2.46 -2.46l6.772 -6.772" />'],bluesky:['<path stroke="none" d="M0 0h24v24H0z" fill="none"/>','<path d="M6.335 5.144c-1.654 -1.199 -4.335 -2.127 -4.335 .826c0 .59 .35 4.953 .556 5.661c.713 2.463 3.13 2.75 5.444 2.369c-4.045 .665 -4.889 3.208 -2.667 5.41c1.03 1.018 1.913 1.59 2.667 1.59c2 0 3.134 -2.769 3.5 -3.5c.333 -.667 .5 -1.167 .5 -1.5c0 .333 .167 .833 .5 1.5c.366 .731 1.5 3.5 3.5 3.5c.754 0 1.637 -.571 2.667 -1.59c2.222 -2.203 1.378 -4.746 -2.667 -5.41c2.314 .38 4.73 .094 5.444 -2.369c.206 -.708 .556 -5.072 .556 -5.661c0 -2.953 -2.68 -2.025 -4.335 -.826c-2.293 1.662 -4.76 5.048 -5.665 6.856c-.905 -1.808 -3.372 -5.194 -5.665 -6.856z" />'],telegram:['<path stroke="none" d="M0 0h24v24H0z" fill="none"/>','<path d="M15 10l-4 4l6 6l4 -16l-18 7l4 2l2 6l3 -4" />'],attach:['<path stroke="none" d="M0 0h24v24H0z" fill="none"/>','<path d="M15 7l-6.5 6.5a1.5 1.5 0 0 0 3 3l6.5 -6.5a3 3 0 0 0 -6 -6l-6.5 6.5a4.5 4.5 0 0 0 9 9l6.5 -6.5" />'],send:['<path stroke="none" d="M0 0h24v24H0z" fill="none"/>','<path d="M4.698 4.034l16.302 7.966l-16.302 7.966a.503 .503 0 0 1 -.546 -.124a.555 .555 0 0 1 -.12 -.568l2.468 -7.274l-2.468 -7.274a.555 .555 0 0 1 .12 -.568a.503 .503 0 0 1 .546 -.124z" />','<path d="M6.5 12h14.5" />']}},[{key:"get",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.name,n=e.size,a=void 0===n?20:n,r=e.styles;if(!this.resources[t])throw Error('Icon with name "'.concat(t,'" does not exist'));return'<svg aria-hidden="true" style="'.concat(void 0===r?"":r,'" xmlns="http://www.w3.org/2000/svg" width="').concat(a,'" height="').concat(a,'" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n		').concat(this.resources[t].join(""),"\n		</svg>")}}])),B=T(function e(t){var n=this;E(this,e),L(this,"_handleKeyDown",function(e){27===e.keyCode&&(n.close(),n.trigger.focus())}),this.Root=D("xEHCrF5Oe"),this.Overlay=D("overlay"),this.Content=D("xC3Uih0ex"),this.trigger=t;var a=this.trigger.getBoundingClientRect();this.Content.style.left=a.left+"px",this.Content.style.top=a.top+a.height+"px",this.Root.setAttribute("data-state","open"),this.Root.setAttribute("role","popover"),this.Root.setAttribute("aria-modal","true"),document.body.appendChild(this.Root),this.Root.appendChild(this.Overlay),this.Root.appendChild(this.Content),this.Root.onwheel=function(e){e.ctrlKey&&e.preventDefault()},this.hidden_elements=document.querySelectorAll("body > *:not(.xEHCrF5Oe, script, [hidden])"),this.hidden_elements.forEach(function(e){e.setAttribute("inert","true")}),this.Overlay.addEventListener("click",function(){return n.close()}),this.Overlay.addEventListener("contextmenu",function(){return n.close()}),document.addEventListener("keydown",this._handleKeyDown)},[{key:"_removeListeners",value:function(){document.removeEventListener("keydown",this._handleKeyDown)}},{key:"close",value:function(){var e=this;this._removeListeners(),this.hidden_elements.forEach(function(e){e.removeAttribute("inert")}),this.Root.setAttribute("data-state","closed"),setTimeout(function(){e.Root.remove()},100)}}]),G=T(function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=n.closeOnOverlayClick,r=n.closeOnEsc;E(this,e),L(this,"_handleOverlayClick",function(){t.close(),t._removeListeners()}),L(this,"_handleKeyDown",function(e){27===e.keyCode&&(t.close(),t._removeListeners())}),this.Root=D("x54SkYRT0"),this.Overlay=D("overlay"),this.Content=D("content"),this.Root.setAttribute("data-state","open"),this.Root.appendChild(this.Overlay),this.Root.appendChild(this.Content),this.Root.setAttribute("role","dialog"),this.Root.setAttribute("aria-modal","true"),this.Root.onwheel=function(e){e.ctrlKey&&e.preventDefault()},this.hidden_elements=document.querySelectorAll("body > *:not(.x54SkYRT0, script, style, [hidden])"),this.hidden_elements.forEach(function(e){e.setAttribute("inert","true")}),document.body.appendChild(this.Root),this.Root.classList.add("show"),void 0!==a&&a&&this.Overlay.addEventListener("click",this._handleOverlayClick),void 0!==r&&r&&document.addEventListener("keydown",this._handleKeyDown)},[{key:"_removeListeners",value:function(){this.Overlay.onclick=null,document.removeEventListener("keydown",this._handleKeyDown)}},{key:"close",value:function(){var e=this;this.hidden_elements.forEach(function(e){e.removeAttribute("inert")}),this.Root.setAttribute("data-state","closed"),setTimeout(function(){e.Root.remove()},100)}}]),D=function(e){var t=document.createElement("div");return t.classList.add(e),t},R=function(e){return document.querySelector(e)},j=e({apiKey:"AIzaSyAp73V5ZsBUtpy4kS3-QyGirGSpz71DPWo",authDomain:"smiling-theory-397204.firebaseapp.com",databaseURL:"https://smiling-theory-397204-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"smiling-theory-397204",storageBucket:"smiling-theory-397204.appspot.com",messagingSenderId:"360479398694",appId:"1:360479398694:web:05b7df5ce277f89ea8ffe7",measurementId:"G-6BKTT1K7D1"}),K=u(j),F=s(j),Y=new a,P=t(),V=/(Android|webOS|Windows Phone|iPhone|iPod|iPad)/i.test(window.navigator.platform)||window.innerWidth<550,z=[],Z="setAppBadge"in navigator&&"clearAppBadge"in navigator,W={sidebar:R(".sidebar"),main:R(".main"),messageInput:R(".xtsARDHTI"),searchInput:R(".xujXllYgW"),messageArea:R(".xikyLwDf4"),sendButton:R(".xuwRtDpu4"),fileInput:R(".xVEJA40Qh"),signOutButton:R(".xlifWPlRj#x8Kzd47QX"),backButton:R(".xehdiGgBv .xMyenRl7K .x8JU9DbQZ")},N=["幹","操","草","白癡","智障","死","笨蛋","傻逼"],U=800,q={},Q=!1,J=0,X="",ee=0;function et(){return en.apply(this,arguments)}function en(){return(en=C(b().mark(function e(){var t,n;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=W.messageInput.innerText.trim())&&!(t.length>U)&&X){e.next=3;break}return e.abrupt("return");case 3:var a,r;return t=function(e){var t=RegExp(N.map(function(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}).join("|"),"gi");return e.replace(t,function(e){return"*".repeat(e.length)})}((r=(a=t.replace(/&([^;]+)/g,"&amp;$1").replaceAll("<","&lt;").replaceAll(">","&gt;").replace(/(\r?\n){3,}/g,"\n\n")).replace(/https?:\/\/[^\s/$.?#].[^\s]*/g,function(e){return'<a class="x0ciSQShX" href="'.concat(e,'" target="_blank" rel="noreferrer noopener">').concat(decodeURIComponent(e),"</a>")})).replace(/^\s*[-]{10,}\s*\n?/gm,'<div class="x3nWNfdWy horizontal"></div>').replaceAll("\n","<br>")),W.messageInput.innerHTML="",n=f(h(K,"chats",X,"messages")),e.next=8,p(n,{sender:S,content:t,timestamp:Date.now()});case 8:ea(t,n.id);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ea(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],a=D("xVC8gtuyS"),r=D("xMyW2iRSH"),i=D("xKljxgVJA"),o=D("xu4Celbbq"),s=D("xc4iCj2Gy"),c=D("xRHoYYwoZ");if(a.setAttribute("data-message-id",t),a.classList.add("xiOw4dg0O"),a.appendChild(i),i.appendChild(c),c.appendChild(o),o.appendChild(s),c.appendChild(r),s.innerText="You",r.innerHTML=e,n)W.messageArea.appendChild(a),W.messageArea.scrollTo({top:W.messageArea.scrollHeight,behavior:"instant"});else{var l=W.messageArea.firstChild;W.messageArea.insertBefore(a,l)}}function er(e,t,n,a){var r=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=D("xVC8gtuyS"),o=D("xMyW2iRSH"),s=D("xSYcbYqTG"),c=D("xKljxgVJA"),l=D("xu4Celbbq"),d=D("xc4iCj2Gy"),u=D("xt8fROB2L"),h=D("xRHoYYwoZ"),p=document.createElement("img"),f=D("xvaVnGX8Q");if(r)W.messageArea.appendChild(i),W.messageArea.scrollTo({top:W.messageArea.scrollHeight,behavior:"instant"});else{var v=W.messageArea.firstChild;W.messageArea.insertBefore(i,v)}u.classList.add("xt8fROB2L"),i.appendChild(s),i.appendChild(c),c.appendChild(h),h.appendChild(l),l.appendChild(d),h.appendChild(o),l.appendChild(f),l.appendChild(u),s.appendChild(p),i.setAttribute("data-message-id",t),p.draggable=!1,o.innerHTML=e,el(n).then(function(e){var t,n;u.innerText=(t=a,(n=Math.floor((Date.now()-t)/1e3))<60?"".concat(n," sec ago"):n<3600?"".concat(Math.floor(n/60)," min ago"):n<86400?"".concat(Math.floor(n/3600)," hour ago"):n<2592e3?"".concat(Math.floor(n/86400)," day ago"):n<31536e3?"".concat(Math.floor(n/2592e3)," month ago"):"".concat(eo(Math.floor(n/31536e3))," year ago")),p.src=e.avatarUrl||"/assets/avatar.png",s.classList.add("xWzeTGC6P"),d.innerText=e.name||"Unknown",e.verified&&(f.innerHTML='<span class="xMF0A6T9h" aria-label="Verified">'.concat(O.get({name:"check"}),"</span>"))})}function ei(e){return e.replace(/&([^;]+)/g,"&amp;$1").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll(" ","&nbsp;").replaceAll("\n","<br>")}function eo(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}function es(e,t,n,a){var r,i,o=document.createElement("div"),s=document.createElement("div"),c=document.createElement("div"),l=document.createElement("div"),d=document.createElement("div"),u=document.createElement("div");o.setAttribute("tabindex","0"),o.classList.add("x2fP9fkxS"),d.classList.add("x6HyfOZS7"),u.classList.add("xQkxrD9ZA"),u.setAttribute("aria-label","Actions"),r=t,_(h(K,"chats",r,"messages"),function(e){e.docChanges().forEach(function(e){if(X===r){var t,n=e.doc.data();switch(e.type){case"added":n.sender!==S&&("hidden"===document.visibilityState&&(ee++,document.title="(".concat(ee,") Structure"),Z&&navigator.setAppBadge(ee)),er(n.content,e.doc.id,n.sender,n.timestamp,!0));break;case"removed":try{(t=R('.xikyLwDf4 .xVC8gtuyS[data-message-id="'.concat(e.doc.id,'"]'))).classList.add("deleted"),t.innerHTML="This message has been deleted"}catch(a){console.log("An unknown error occurred",a)}break;case"modified":try{(t=R('.xikyLwDf4 .xVC8gtuyS[data-message-id="'.concat(e.doc.id,'"] .xMyW2iRSH'))).innerHTML=n.content}catch(i){console.log("An unknown error occurred",i)}}}})},function(e){console.error("監聽錯誤:",e)});var p=(i=C(b().mark(function n(){return b().wrap(function(n){for(;;)switch(n.prev=n.next){case 0:(X!==t||V)&&(H=void 0,ef(X=t),W.messageArea.innerHTML="",W.sendButton.classList.remove("disabled"),W.fileInput.removeAttribute("disabled"),R(".xpbRox0hO").classList.remove("disabled"),R(".xpbRox0hO").tabIndex="0",W.messageInput.setAttribute("contenteditable","true"),V||(R(".x2fP9fkxS.active")&&R(".x2fP9fkxS.active").classList.remove("active"),R(".x2fP9fkxS.interim:not(.active)")&&R(".x2fP9fkxS.interim:not(.active)").remove(),o.classList.add("active")),V&&R(".xehdiGgBv .xMyenRl7K .x8JU9DbQZ").setAttribute("tabindex","0"),R(".main").classList.add("x8VAGH6N2"),R(".xvwhg72ii").innerText=e,W.messageInput.setAttribute("contenteditable","true"),W.messageInput.setAttribute("tabindex","0"));case 1:case"end":return n.stop()}},n)})),function(){return i.apply(this,arguments)});o.onclick=function(){p()},o.onkeydown=function(e){13===e.keyCode&&p()},z.push({id:t,name:e,dom:o}),o.appendChild(s),o.appendChild(d),d.appendChild(u),u.tabIndex="0";var f,v=function(){var e=new B(u),n=D("xrQdSHI2A"),a=D("xrQdSHI2A"),r=D("xcoXgMpFW"),i=D("xrQdSHI2A");function o(){e.close(),function(){var e=new G({closeOnEsc:!0,closeOnOverlayClick:!0});e.Content.style.padding="0";var n=D("xrYn5ZY3v");n.classList.add("lf"),n.innerText="Invitation link";var a=D("xKfGtNfnX"),r=D("xMMSyk68x");r.innerText="Some people may not be able to join.";var i=D("xWDUelLWA"),o=document.createElement("div");o.classList.add("xIcrOS5lb");var s="".concat(window.location.origin,"/?join=").concat(t);o.innerText=s;var c=document.createElement("div");c.tabIndex="0",c.classList.add("xGugcvsJF");var l=O.get({name:"copy",size:20,styles:"min-width: 20px"});function d(){navigator.clipboard.writeText(s),c.innerHTML=O.get({name:"check",size:20,styles:"min-width: 20px"}),setTimeout(function(){c.innerHTML=l},1500)}c.innerHTML=l,c.onclick=function(){d()},c.onkeydown=function(e){13===e.keyCode&&d()},i.appendChild(a),i.appendChild(r),a.appendChild(o),a.appendChild(c),e.Content.appendChild(n),e.Content.appendChild(i)}()}function s(){var t;e.close(),(t=new G({closeOnEsc:!0,closeOnOverlayClick:!0})).Content.style.padding="0",t.Content.innerHTML='<div class="xrYn5ZY3v lf">Settings</div><div class="xWDUelLWA">Not yet completed construction</div>'}n.innerText="Invite People",n.style.color="rgb(112, 184, 255)",n.onclick=function(){o()},[n,a,i].forEach(function(e){e.tabIndex="0"}),n.onkeydown=function(e){13===e.keyCode&&o()},a.onkeydown=function(e){13===e.keyCode&&s()},e.Content.appendChild(n),a.innerText="Privacy Settings",a.onclick=function(){s()},e.Content.appendChild(a),e.Content.appendChild(r),i.innerText="Leave",i.style.color="rgb(239, 68, 68)",e.Content.appendChild(i)};u.onkeydown=function(e){e.stopPropagation(),13===e.keyCode&&v()},u.innerHTML=O.get({name:"more",size:20,styles:"min-width: 20px"}),u.onclick=function(e){e.stopPropagation(),v()},s.classList.add("xQ65c0Nkc"),c.classList.add("xybvM5cRF"),s.appendChild(c),c.innerText=e,l.classList.add("xT3Ta8vKw"),f=n||(0===a?"No message":"".concat(eo(a)," messages")),l.innerHTML='\n		<span class="x97KBA8qs">'.concat(f,"</span>\n	"),s.appendChild(l),R(".xemr1y6ie").appendChild(o)}function ec(e){for(var t=["B","KB","MB","GB","TB","PB"],n=e,a=0;n>=1024&&a<t.length-1;)n/=1024,a++;return"".concat(n.toFixed(2)," ").concat(t[a])}function el(e){return ed.apply(this,arguments)}function ed(){return(ed=C(b().mark(function e(t){var n,a,r,i,o;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!q[t]){e.next=3;break}return console.log("Get data from memory cache"),e.abrupt("return",q[t]);case 3:if(!(n=sessionStorage.getItem("userProfile_".concat(t)))){e.next=9;break}return console.log("Get data from sessionStorage"),a=JSON.parse(n),q[t]=a,e.abrupt("return",a);case 9:return e.prev=9,r=f(K,"users",t),e.next=13,v(r);case 13:if(!(i=e.sent).exists()){e.next=22;break}return o=i.data(),q[t]=o,sessionStorage.setItem("userProfile_".concat(t),JSON.stringify(o)),console.log("Get data from Firestore"),e.abrupt("return",o);case 22:return console.log("No data found for this user"),e.abrupt("return",null);case 24:e.next=30;break;case 26:throw e.prev=26,e.t0=e.catch(9),console.error("Error while getting user data:",e.t0.toString()),e.t0;case 30:case"end":return e.stop()}},e,null,[[9,26]])}))).apply(this,arguments)}function eu(e,t,n){return eh.apply(this,arguments)}function eh(){return(eh=C(b().mark(function e(t,n,a){var r;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(h(K,"chats",a,"messages"));case 2:es(t,a,n,(r=e.sent).size);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)}function ep(){return(ep=C(b().mark(function e(t){var n,a;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,void 0===H){e.next=8;break}return e.next=4,$(g(h(K,"chats",t,"messages"),x("timestamp","desc"),m(H),y(10)));case 4:H=10===(n=e.sent).docs.length?n.docs[9]:void 0,n.forEach(function(e){var t=e.data();t.sender===S?ea(t.content,e.id,!1):er(t.content,e.id,t.sender,t.timestamp,!1)}),0!==n.docs.length&&(a=W.messageArea.scrollHeight,W.messageArea.scrollTop=a-I);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),console.error("Error fetching messages: ",e.t0);case 13:case"end":return e.stop()}},e,null,[[0,10]])}))).apply(this,arguments)}function ef(e){return ev.apply(this,arguments)}function ev(){return(ev=C(b().mark(function e(t){var n,a;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,$(g(h(K,"chats",t,"messages"),x("timestamp","desc"),y(10)));case 2:(n=e.sent).docs[9]&&(H=n.docs[9]),a=[],n.forEach(function(e){a.push(e),console.log(e.data().timestamp)}),a.reverse(),a.forEach(function(e){var t=e.data();t.sender===S?ea(t.content,e.id,!0):er(t.content,e.id,t.sender,t.timestamp,!0)}),I=W.messageArea.scrollHeight;case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function e$(){var e=document.createElement("div");e.classList.add("xrYn5ZY3v"),e.innerText="Account Login";var t=document.createElement("div");t.classList.add("xRRuA0Z3S");var r=document.createElement("div");r.id="x7BYgkdiJ",r.tabIndex="0",r.innerHTML='<svg aria-hidden="true" class="xGBqJjpdr" viewBox="0 0 20 20">\n	<path d="M19.6 10.23c0-.82-.1-1.42-.25-2.05H10v3.72h5.5c-.15.96-.74 2.31-2.04 3.22v2.45h3.16c1.89-1.73 2.98-4.3 2.98-7.34z" fill=#4285F4></path>\n	<path d="M13.46 15.13c-.83.59-1.96 1-3.46 1-2.64 0-4.88-1.74-5.68-4.15H1.07v2.52C2.72 17.75 6.09 20 10 20c2.7 0 4.96-.89 6.62-2.42l-3.16-2.45z" fill=#34A853></path>\n	<path d="M3.99 10c0-.69.12-1.35.32-1.97V5.51H1.07A9.973 9.973 0 000 10c0 1.61.39 3.14 1.07 4.49l3.24-2.52c-.2-.62-.32-1.28-.32-1.97z" fill=#FBBC05></path>\n	<path d="M10 3.88c1.88 0 3.13.81 3.85 1.48l2.84-2.76C14.96.99 12.7 0 10 0 6.09 0 2.72 2.25 1.07 5.51l3.24 2.52C5.12 5.62 7.36 3.88 10 3.88z" fill=#EA4335></path></svg>\n	<div>Sign in with Google</div>';var o=document.createElement("div");o.tabIndex="0",o.id="xBnuWNG6V",o.className="actionbtn xYIKBnbHS",r.className="actionbtn xYIKBnbHS",o.innerHTML='<svg aria-hidden="true" class="xGBqJjpdr" viewBox="0 0 20 20">\n	<path d="M1 5.006A2 2 0 012.995 3h14.01A2 2 0 0119 5.006v9.988A2 2 0 0117.005 17H2.995A2 2 0 011 14.994V5.006zM3 5l7 4 7-4v2l-7 4-7-4V5z" fill-rule=evenodd fill=#788aa2></path>\n	</svg>\n	<div>Sign in with email</div>',t.appendChild(r),t.appendChild(o);var s=new G;s.Content.classList.add("bt"),s.Content.appendChild(e),s.Content.appendChild(t),r.onclick=function(){n(P,Y).then(function(e){a.credentialFromResult(e).accessToken;var t=e.user;el(S=t.uid).then(function(e){s.close(),e||e0(t.displayName),console.log(e)}).catch(function(e){console.error(e)})}).catch(function(e){a.credentialFromError(e),console.log(e.code,e.message)})},o.onclick=function(){var e=new G({closeOnEsc:!0,closeOnOverlayClick:!0}),t=document.createElement("div");t.classList.add("xrYn5ZY3v"),t.innerText="Account Login",e.Content.appendChild(t);var n=document.createElement("div");n.classList.add("xZdL9CF5M"),e.Content.appendChild(n);var a=document.createElement("div");a.classList.add("xGGKUZ7B3"),n.appendChild(a);var r=document.createElement("label");r.classList.add("xF37V7xd0"),r.innerText="Email",a.appendChild(r);var o=document.createElement("input");o.classList.add("xYvZ9WF6d"),o.autocomplete="off",o.type="text",o.spellcheck="false",a.appendChild(o);var c=document.createElement("div");c.classList.add("xGGKUZ7B3"),c.style.marginTop="10px",c.style.marginBottom="5px",n.appendChild(c);var l=document.createElement("label");l.classList.add("xF37V7xd0"),l.innerText="Password",c.appendChild(l);var d=document.createElement("input");d.classList.add("xYvZ9WF6d"),d.type="password",d.autocomplete="off",c.appendChild(d);var u=document.createElement("div");u.classList.add("xw0IanPrC"),n.appendChild(u);var h=document.createElement("div");h.innerText="Login",h.tabIndex="0",h.classList.add("x40AApYkW"),n.appendChild(h),o.focus();var p=!0,f=function(t){console.log(t),p&&(p=!1,u.classList.remove("show"),h.innerHTML='\n			<svg aria-hidden="true" class="x3xXCjYFp" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n			<path d="M21 12a9 9 0 1 1-6.219-8.56"/>\n			</svg>',o.disabled=!0,d.disabled=!0,h.classList.add("disabled"),h.tabIndex="-1",h.blur(),i(P,o.value,d.value).then(function(t){try{s.close(),e.close()}catch(n){}var a=t.user;console.log("用户已登录:",a),el(a.uid).then(function(e){e||e0()}).catch(function(e){console.error(e)})}).catch(function(e){setTimeout(function(){var t=e.code;u.classList.add("show"),"auth/invalid-login-credentials"===t?u.innerText="Invalid Login Credentials":"auth/invalid-email"===t?u.innerText="Invalid Email":"auth/network-request-failed"===t&&(u.innerText="Network Request Failed"),h.innerHTML="Login",h.classList.remove("disabled"),h.tabIndex="0",o.disabled=!1,d.disabled=!1,p=!0},3e3)}))};h.onclick=function(){f()},o.onkeydown=function(){13===event.keyCode&&d.focus()},[h,d].forEach(function(e){e.onkeydown=function(e){13===e.keyCode&&f()}})}}function e0(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unnamed",t=new G({closeOnEsc:!1,closeOnOverlayClick:!1});t.Content.style.padding="0",t.Content.classList.add("lg");var n=D("xrYn5ZY3v");n.classList.add("lf"),n.innerText="Edit Profiles",t.Content.appendChild(n);var a=D("xWDUelLWA");t.Content.appendChild(a);var r=D("xGGKUZ7B3");a.appendChild(r);var i=D("xXXboHUhF");r.appendChild(i);var o=document.createElement("label");o.tabIndex="0",o.classList.add("xR8Vsron6"),o.ariaLabel="Edit",o.htmlFor="_Jy2eOVG7",i.appendChild(o);var s=document.createElement("img");s.classList.add("xavESuLfQ"),s.src="assets/avatar.png",s.draggable=!1,o.appendChild(s);var c=document.createElement("input");c.setAttribute("hidden","true"),c.id="_Jy2eOVG7",c.type="file",i.appendChild(c);var l=D("xGGKUZ7B3"),d=document.createElement("label");d.innerText="Display Name",d.classList.add("xF37V7xd0"),d.htmlFor="_rJvAjH9O";var u=document.createElement("input");u.value=e,u.classList.add("xYvZ9WF6d"),u.id="_rJvAjH9O",u.type="text",u.maxLength="20",u.autocomplete="off",u.spellcheck="false",a.appendChild(l),l.appendChild(d),l.appendChild(u);var h=D("xGGKUZ7B3"),v=document.createElement("label");v.innerText="Signature",v.classList.add("xF37V7xd0"),v.htmlFor="_fM6Qcf9q";var $=document.createElement("textarea");$.value="I am a human",$.classList.add("xGuwEx6qN"),$.id="_fM6Qcf9q",$.rows="3",$.maxLength="50",$.autocomplete="off",$.spellcheck="false",a.appendChild(h),h.appendChild(v),h.appendChild($);var m=D("x40AApYkW");function _(){return g.apply(this,arguments)}function g(){return(g=C(b().mark(function e(){return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return m.classList.add("disabled"),m.innerText="Saving...",m.tabIndex="-1",r.classList.add("disabled"),u.disabled=!0,$.disabled=!0,c.disabled=!0,e.next=9,p(f(K,"users",S),{avatarUrl:null,name:u.value,signature:$.value,verified:!1});case 9:t.close();case 10:case"end":return e.stop()}},e)}))).apply(this,arguments)}m.tabIndex="0",m.innerText="Save",m.style.marginTop="5px",a.appendChild(m),m.onclick=function(){_()},m.onkeydown=function(e){13===e.keyCode&&_()}}V&&document.body.classList.add("mobile"),window.onload=C(b().mark(function e(){var t,n,a,r,i,o,s,c;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=new URLSearchParams(window.location.search).get("join"))){e.next=7;break}return n=f(K,"chats",t),e.next=5,v(n);case 5:(a=e.sent).exists()?-1!==a.data().members.indexOf(S)?(console.log("你他媽已經加入了!"),(r=new URL(window.location)).search="",history.replaceState({},"",r)):(i=a.data(),o=new G({closeOnEsc:!0,closeOnOverlayClick:!0}),"public"===i.mode?o.Content.innerHTML="<h2>Request to join: ".concat(i.name,"</h2><p>Number of members: ").concat(i.members.length,"</p>"):o.Content.innerHTML="<h2>Unable to join directly</h2>"):console.log("無法加入");case 7:return e.next=9,$(h(K,"chats"));case 9:s=e.sent,c=0,R(".xemr1y6ie .spinner").remove(),s.forEach(function(e){var t=e.data();-1!==t.members.indexOf(S)&&(c++,eu(t.name,t.description,e.id))}),0===c&&(R(".xemr1y6ie").innerHTML='<div class="xZYFExNlg">There\'s nothing here yet</div>');case 14:case"end":return e.stop()}},e)})),r(P,function(e){e?(S=e.uid,function(){if(!0!==Q){W.searchInput.removeAttribute("disabled"),W.searchInput.setAttribute("tabindex","0"),W.messageArea.classList.remove("xVjpzmyej");var e=(new Date).getHours();er("Good {dl} and welcome back. Let's start the chatting now".replace("{dl}",e>=5&&e<11?"morning":e>=11&&e<14?"afternoon":e>=14&&e<18?"evening":"night"),"0","oKyF1fvm",17040384e5,!0),Q=!0}}()):(S="",e$())}),W.signOutButton.onclick=function(){o(P).then(function(){console.log("User signed out")}).catch(function(e){console.error("Sign out error",e)})},W.fileInput.onchange=function(){var e=C(b().mark(function e(t){var n,a,r,i,o,s,u,v,$,m,_,g;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.target.files[0]){e.next=3;break}return e.abrupt("return");case 3:if((a=new G).Content.classList.add("bt"),(r=document.createElement("div")).classList.add("xrYn5ZY3v"),(i=document.createElement("div")).classList.add("xb1IsDa6e"),a.Content.appendChild(r),a.Content.appendChild(i),!(n.size/1024/1024>5)){e.next=16;break}return r.innerText="This file is too large",i.innerText="This file is ".concat(ec(n.size),", we can't afford it."),a.Overlay.onclick=function(){a.close()},e.abrupt("return");case 16:o=c(F,"uploads/"+n.name),r.innerText="Uploading",i.innerText="This may take a while, please be patient...",(s=document.createElement("div")).classList.add("xCECpHDwZ"),a.Content.appendChild(s),(u=document.createElement("div")).classList.add("xty9qDHrl"),s.appendChild(u),(v=document.createElement("div")).classList.add("xIEj1ZAnA"),v.innerHTML='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"></path><path d="M14 2v4a2 2 0 0 0 2 2h4"></path></svg>',u.appendChild(v),($=document.createElement("div")).classList.add("xxs4n9nhX"),u.appendChild($),$.innerHTML='<div class="xTGGn7ABj">'.concat(n.name).concat('</div><div class="xtyaQiCLO"></div>').concat(ec(n.size)).concat("</div>"),u.appendChild($),(m=document.createElement("div")).classList.add("xsoLox5sj"),u.appendChild(m),(_=document.createElement("div")).classList.add("xk0osKWCK"),m.appendChild(_),(g=l(o,n)).on("state_changed",function(e){var t=e.bytesTransferred/e.totalBytes*100;_.style.width="".concat(t,"%")},function(e){console.error(e)},C(b().mark(function e(){var t,o,c,l;return b().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.Overlay.onclick=function(){a.close()},s.remove(),r.innerText="Complete upload",i.innerText="This file has been uploaded successfully",e.next=6,d(g.snapshot.ref);case 6:return t=e.sent,o=(c=String(n.type)).startsWith("image/")?'<img tabindex="0" draggable="false" src="'.concat(t,'" title="').concat(n.name,'" class="xGsec9lFd">'):c.startsWith("video/")?'<video tabindex="0" src="'.concat(t,'" title="').concat(n.name,'" controlslist="nodownload" controls class="xGsec9lFd">'):c.startsWith("audio/")?'<audio tabindex="0" src="'.concat(t,'" title="').concat(n.name,'" controlslist="nodownload" controls class="xGsec9lFd">'):'I just uploaded a file "'.concat(n.name,'", <a href="').concat(t,'" class="x0ciSQShX" target="_blank">Download</a>'),l=f(h(K,"chats",X,"messages")),e.next=12,p(l,{sender:S,content:o,timestamp:Date.now()});case 12:ea(o,l.id,!0),W.fileInput.value="";case 14:case"end":return e.stop()}},e)})));case 42:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&(document.title="Structure",Z&&navigator.clearAppBadge(),ee=0)}),document.addEventListener("gesturestart",function(e){e.preventDefault()}),W.searchInput.oninput=function(e){z.forEach(function(t){t.name.toLowerCase().includes(e.target.value.toLowerCase())?t.dom.classList.remove("hide"):t.dom.classList.add("hide")})},W.messageArea.addEventListener("scroll",function(){var e=W.messageArea.pageYOffset||W.messageArea.scrollTop;I=W.messageArea.scrollHeight,0===e&&function(e){ep.apply(this,arguments)}(X)}),W.messageInput.addEventListener("input",function(){var e=W.messageInput.childNodes;1==e.length&&"BR"===e[0].nodeName&&(W.messageInput.innerHTML="")}),W.messageInput.onpaste=function(e){e.preventDefault(),document.execCommand("insertHTML",!0,ei((e.clipboardData||window.Clipboard).getData("text/plain")))},W.messageInput.addEventListener("drop",function(e){e.preventDefault();var t=e.dataTransfer.getData("text/plain");e.target.focus(),document.execCommand("insertHTML",!0,ei(t))}),W.messageInput.oncopy=function(e){e.preventDefault();var t=window.getSelection().toString();e.clipboardData.setData("text/plain",t)},W.messageInput.addEventListener("keydown",function(e){switch(e.keyCode){case 13:V||e.shiftKey||(e.preventDefault(),et());break;case 85:case 66:e.ctrlKey&&e.preventDefault()}}),W.sendButton.onclick=et,W.sendButton.onkeydown=function(e){13===e.keyCode&&et()},document.onkeydown=function(e){switch(e.keyCode){case 191:document.activeElement!=W.messageInput&&document.activeElement!==W.searchInput&&(e.preventDefault(),W.messageInput.focus());break;case 75:e.ctrlKey&&Q&&(e.preventDefault(),W.searchInput.focus());break;case 123:e.preventDefault();break;case 67:e.ctrlKey&&e.shiftKey&&e.preventDefault();break;case 85:case 79:case 187:case 189:case 80:case 83:case 109:case 107:e.ctrlKey&&e.preventDefault();break;case 37:case 39:e.altKey&&e.preventDefault()}},document.querySelectorAll("body > div").forEach(function(e){e.onwheel=function(e){e.ctrlKey&&e.preventDefault()}}),document.oncontextmenu=function(e){e.preventDefault()},W.backButton.onclick=function(){X="",W.main.classList.remove("x8VAGH6N2"),W.messageInput.innerHTML="",W.messageInput.setAttribute("contenteditable","true"),W.messageInput.setAttribute("tabindex","-1"),W.sendButton.setAttribute("tabindex","-1")},document.addEventListener("touchstart",function(e){e.touches&&e.touches.length>1&&e.preventDefault()},{passive:!1}),document.addEventListener("touchend",function(e){var t=(new Date).getTime();t-J<=300&&e.preventDefault(),J=t},!1)})();
