const allmsg=[],aa=e=>document.querySelector(e),ba=e=>localStorage.getItem(e),editor=aa(".tg1"),sendbtn=aa(".tg2"),msgb=aa(".kl1");window.focd=0;var chatroom=[];function ab(){let e=window.navigator.userAgentData;return!!e&&!!e.brands&&e.brands.some(e=>"Google Chrome"===e.brand)}function ac(e,t){for(let n=0;n<t.length;n++)if(e.includes(t))return["success",e,t];return["failure"]}function ud(){let e=new Date().getTime();return`${e}-${Math.floor(1e6*Math.random())}`}function cg(e){editor.setAttribute("contenteditable",!0),aa(".gub1").removeAttribute("disabled"),aa(".un .name").innerText="Chat Room",aa(".bn .thumbnail").src="/assets/unnamed.jpg",document.title="Structure - Chat Room",aa(".account").innerText=e,window.login=!0,window.pgin=!0,window.ddt1()}window.onload=()=>{var e=localStorage.getItem("username");e?cg(e):(aa(".account").innerText="Login",Swal.fire({iconHtml:`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512" width=70 heigh=70 fill="#2bbaea">
      <path d="M234.7 42.7L197 56.8c-3 1.1-5 4-5 7.2s2 6.1 5 7.2l37.7 14.1L248.8 123c1.1 3 4 5 7.2 5s6.1-2 7.2-5l14.1-37.7L315 71.2c3-1.1 5-4 5-7.2s-2-6.1-5-7.2L277.3 42.7 263.2 5c-1.1-3-4-5-7.2-5s-6.1 2-7.2 5L234.7 42.7zM46.1 395.4c-18.7 18.7-18.7 49.1 0 67.9l34.6 34.6c18.7 18.7 49.1 18.7 67.9 0L529.9 116.5c18.7-18.7 18.7-49.1 0-67.9L495.3 14.1c-18.7-18.7-49.1-18.7-67.9 0L46.1 395.4zM484.6 82.6l-105 105-23.3-23.3 105-105 23.3 23.3zM7.5 117.2C3 118.9 0 123.2 0 128s3 9.1 7.5 10.8L64 160l21.2 56.5c1.7 4.5 6 7.5 10.8 7.5s9.1-3 10.8-7.5L128 160l56.5-21.2c4.5-1.7 7.5-6 7.5-10.8s-3-9.1-7.5-10.8L128 96 106.8 39.5C105.1 35 100.8 32 96 32s-9.1 3-10.8 7.5L64 96 7.5 117.2zm352 256c-4.5 1.7-7.5 6-7.5 10.8s3 9.1 7.5 10.8L416 416l21.2 56.5c1.7 4.5 6 7.5 10.8 7.5s9.1-3 10.8-7.5L480 416l56.5-21.2c4.5-1.7 7.5-6 7.5-10.8s-3-9.1-7.5-10.8L480 352l-21.2-56.5c-1.7-4.5-6-7.5-10.8-7.5s-9.1 3-10.8 7.5L416 352l-56.5 21.2z"/>
      </svg>`,title:"Welcome to <span class='swalf'>Structure</span>",text:"you can use it in just a few steps",confirmButtonText:`Next&nbsp;
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" fill="#fff" width=20 height=20>
        <path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/>
        </svg>`,customClass:{icon:"no-border"}}).then(()=>{Swal.fire({title:"Enter your name",input:"text",confirmButtonText:`Next&nbsp;
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" fill="#fff" width=20 height=20>
        <path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/>
        </svg>`,allowOutsideClick:!1,inputValidator(e){if(!e)return"name cannot be empty";if(!/^[a-zA-Z0-9]+$/.test(e))return"The name can only contain letters or numbers";if(e.length<5)return"The name cannot be less than 5 characters";if(/^\d+$/.test(e))return"The name cannot be all numbers";Swal.fire({title:"Enter invitation code",input:"text",confirmButtonText:`Okay&nbsp;<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512" fill="#fff" width=20 height=20>
              <path d="M438.6 105.4c12.5 12.5 12.5 32.8 0 45.3l-256 256c-12.5 12.5-32.8 12.5-45.3 0l-128-128c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0L160 338.7 393.4 105.4c12.5-12.5 32.8-12.5 45.3 0z"/>
              </svg>`,allowOutsideClick:!1,inputValidator:t=>t?"25a3395fe136"!==t?"Invalid invitation code":void(localStorage.setItem("uuid",ud()),localStorage.setItem("username",e),cg(e)):"Invitation code cannot be empty"})}})}))};let enletters=Array.from("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz<>;-+|''\"'[](){}=~.,/\\1234567890*&^%$#@"),inited=!1;function sendmsg(){if(""!==editor.innerText.trim()&&"/"!==editor.textContent.charAt(0)){var e=editor.innerText.replaceAll("\\n","\n").replaceAll("<","&lt;").replaceAll(">","&gt;");editor.innerHTML="";let t=Date.now();window.ccc1=t,window.writeUserData(e,t),window.dc(e,!0),editor.focus()}}function getCurrentDateTime(){let e=new Date,t=e.getFullYear(),n=(e.getMonth()+1).toString().padStart(2,"0"),i=e.getDate().toString().padStart(2,"0"),a=e.getHours().toString().padStart(2,"0"),o=e.getMinutes().toString().padStart(2,"0"),s=e.getSeconds().toString().padStart(2,"0"),r=e.getMilliseconds().toString().padStart(3,"0"),l=`${t}-${n}-${i}-${a}-${o}-${s}-${r}`;return l}function getCurrentTime(){var e=new Date,t=e.getHours(),n=e.getMinutes();return`${t=t>=10?t:`0${t}`}:${n=n>=10?n:`0${n}`}`}function handlePaste(e){e.preventDefault();let t=(e.clipboardData||window.clipboardData).getData("text/plain");console.log("Process is completed"),document.execCommand("insertText",!1,t)}function E(e){for(var t=/((https?:\/\/|www\.)[^\s<)]+)/gi,n=0;n<e.childNodes.length;n++){var i=e.childNodes[n];if(i.nodeType===Node.TEXT_NODE){var a=i.nodeValue.replace(t,"<a href='$1' target='_blank' onclick='this.classList.add('visited')' draggable='false'>$1</a>"),o=document.createElement("span");o.innerHTML=a,e.replaceChild(o,i)}i.nodeType===Node.ELEMENT_NODE&&E(i)}}function getRandomInt(e){return Math.floor(Math.random()*Math.floor(e))}window.ccc1="",window.dc=function(e,t,n=!0){let i=document.createElement("div");i.classList.add("gdk"),n&&i.classList.add("rg");let a=document.createElement("div");a.classList.add("sgv0");let o=document.createElement("div");o.classList.add("sgv1"),o.setAttribute("tabindex","0");let s=document.createElement("div");s.classList.add("sgv2"),s.innerText=getCurrentTime();let r=document.createElement("div");r.classList.add("dlu"),e.length>500&&r.classList.add("longer");var l=aa(".ddh");o.oncontextmenu=t=>{l.classList.add("show"),Update(t),l.querySelector(".context_menu .option.copy").onclick=()=>{navigator.clipboard.writeText(e)},l.querySelector(".context_menu .option.share").onclick=()=>share(e),l.querySelector(".context_menu .option.delete").onclick=()=>{i.remove()}},msgb.appendChild(i),!n&&(i.appendChild(a),tippy(a,{arrow:!1,animation:"fade",trigger:"click",content:t.split("-")[0],placement:"right-start"})),i.appendChild(o),i.appendChild(s),o.appendChild(r),r.innerText=e.replaceAll("<","&lt;").replaceAll(">","&gt;"),E(r),msgb.scrollTop=msgb.scrollHeight},sendbtn.onclick=()=>{sendmsg()},editor.onkeydown=e=>{"Enter"==e.key&&e.shiftKey?key="Backspace":"Enter"==e.key?(e.preventDefault(),sendmsg()):"Tab"==e.key?e.preventDefault():key=e.key};var list=[],builtInCommands=["kick","say","ban","timeout","msg","help","settings","copilot",];for(let index=0;index<builtInCommands.length;index++)list.push(Array.from(builtInCommands[index]));function gcp(e,t){for(let n=0;n<t.length;n++)if(e.toLowerCase()===t[n][0])return t[n].slice(1).join("");return"Not found"}const websites=[["google","google.com/"],["map","maps.google.com/"],["meet","meet.google.com"],["yt","youtube.com/"],["youtube","youtube.com/"],["instagram","instagram.com/"],["github","github.com/"],["twitter","twitter.com/"],["x","x.com/"],["twitch","twitch.tv/"],["niconico","niconico.jp/"],["twitcasting","twitcasting.tv/"],["discord","discord.com/app/"],["gmail","mail.google.com/"],];function analyzeurl(){var e=editor.textContent,t=new VanillaCaret(editor),n=t.getCaretPosition();for(let i=0;i<websites.length;i++){var a=websites[i];e.includes(`~${a[0]}`)&&(editor.innerText=e.replaceAll(`~${a[0]}`,"https://"+a[1]),t.setCaretPosition(n-websites[i][0].length+websites[i][1].length+7))}}function analyzecommand(){var e=editor.textContent.replaceAll("<","&lt;").replaceAll(">","&gt;"),t=new VanillaCaret(editor),n=t.getCaretPosition(),i=e.match(/\/(\S+)/),a=i?i[1]:null;if("/"===e.charAt(0)&&/^[a-zA-Z]+/.test(a)){if(e&&e.length>1){editor.classList.add("cm");var o=-1!==builtInCommands.indexOf(a)?2:4,s=e.substr(Number(i.index+a.length+1)),r="@"===s.trim().charAt(0)&&s.trim().slice(1).split(" ")[0].length>=1?5:3;editor.innerHTML=`<div class='viewer'><span class="mk mark1">/</span><span class="mk mark${o}">${a}</span><span class="mk mark${r}">${s}</span></div>`}}else -1!==editor.classList.value.indexOf("cm")&&(editor.classList.remove("cm"),editor.innerHTML=e);t.setCaretPosition(n)}var key=void 0;function d7(e,t,n){var i="",a="",o=`<div class="gbop${i="Chat Room"===t?" active":" disabled"}" tabindex="0" data-opd="${e}" data-query="${t}">
      <div class="glc">
        <span class="un">
          ${a=1===n?`<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"></path>
        </svg>`:`
    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="#ccc" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle></svg>`}${t}</span>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512" class="ud" fill="#d9d9d9">
        <path d="M310.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-192 192c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L242.7 256 73.4 86.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l192 192z"/>
        </svg>
      </div>
      </div>`;aa(".selection.du2 .opdc").innerHTML+=o,chatroom.push(t),aa(".selection.du2").classList.add("lo")}editor.addEventListener("input",e=>{""===e.target.innerText.trim()&&(e.target.innerHTML=""),"Backspace"===key||isAppleClient||(analyzeurl(),analyzecommand())}),document.addEventListener("keydown",e=>{191===e.keyCode&&document.activeElement!==editor&&document.activeElement!==aa(".gub1")&&(e.preventDefault(),editor.focus())}),window.d7=d7,aa(".gub1").addEventListener("input",e=>{aa(".selection.du2").classList.remove("snot"),document.querySelectorAll(".opdc .gbop").forEach(t=>{t.getAttribute("data-query").toLowerCase().includes(e.target.value.toLowerCase())?t.classList.remove("hide"):t.classList.add("hide")})});let lorem_ipsum="Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.";document.addEventListener("contextmenu",e=>{e.preventDefault()}),aa(".ddh").addEventListener("contextmenu",Hide),document.addEventListener("click",Hide),["resize","blur"].forEach(e=>{window.addEventListener(e,Hide)});var c=aa(".ddh"),d=aa(".ddh .context_menu");function Hide(){c.classList.remove("show")}function Update(e){e.pageX+330>window.innerWidth?(d.style.left="auto",d.style.right="80px"):d.style.left=e.pageX+"px",d.style.top=e.pageY+"px"}const isAppleClient=/(Mac|iPhone|iPod|iPad)/i.test(window.navigator.platform);function share(e){window.open(`https://twitter.com/share?text=${e}`)}window.addTpc=function(){"visible"!==document.visibilityState?(window.focd++,document.title=`(${window.focd}) Structure - Chat Room`):(window.focd=0,document.title="Structure - Chat Room")},document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState&&0!==window.focd&&(document.title="Structure - Chat Room",window.focd=0)});