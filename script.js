/**release 0.4.9*/
import{initializeApp as e}from"https://www.gstatic.com/firebasejs/11.9.1/firebase-app.js";import{getAuth as t,signInWithPopup as n,GoogleAuthProvider as s,onAuthStateChanged as a,signInWithEmailAndPassword as i,signOut as o}from"https://www.gstatic.com/firebasejs/11.9.1/firebase-auth.js";import{getStorage as l,ref as r,uploadBytesResumable as c,getDownloadURL as d}from"https://www.gstatic.com/firebasejs/11.9.1/firebase-storage.js";import{getFirestore as h,enableMultiTabIndexedDbPersistence as u,collection as p,setDoc as m,doc as g,deleteDoc as $,getDoc as b,where as f,getDocs as v,startAfter as x,onSnapshot as C,query as y,orderBy as w,arrayUnion as k,arrayRemove as L,updateDoc as D,limit as E,serverTimestamp as S}from"https://www.gstatic.com/firebasejs/11.9.1/firebase-firestore.js";class ImageViewer{constructor(e,t={}){this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.logicalWidth=0,this.logicalHeight=0,this.devicePixelRatio=window.devicePixelRatio||1,this.updateCanvasSize(),this.options={minScale:.1,maxScale:5,onClickOutside:null,...t},this.customDrawer=null,this.lastTapTime=0,this.tapTimeout=null,this.scale=1,this.posX=0,this.posY=0,this.isDragging=!1,this.lastX=0,this.lastY=0,this.img=null,this.needsRedraw=!1,this.animationFrameId=null,this.isTouching=!1,this.initialDistance=0,this.initialScale=1,this.touchStartPosX=0,this.touchStartPosY=0,this.touchStartScale=1,this.initialCenterX=0,this.initialCenterY=0,this.rotation=0,this.velocityX=0,this.velocityY=0,this.lastTime=0,this.isInertialMoving=!1,this.decelerationRate=.85,this.minVelocityThreshold=.1,this.setupEventListeners(),this.requestRedraw()}updateCanvasSize(){let e=this.canvas.parentElement;this.logicalWidth=e.clientWidth,this.logicalHeight=e.clientHeight,this.devicePixelRatio=window.devicePixelRatio||1,this.canvas.style.width=this.logicalWidth+"px",this.canvas.style.height=this.logicalHeight+"px",this.canvas.width=Math.floor(this.logicalWidth*this.devicePixelRatio),this.canvas.height=Math.floor(this.logicalHeight*this.devicePixelRatio),this.ctx.scale(this.devicePixelRatio,this.devicePixelRatio)}setupEventListeners(){this.handleCanvasClick=this.handleCanvasClick.bind(this),this.handleCanvasTouchEnd=this.handleCanvasTouchEnd.bind(this),this.canvas.addEventListener("click",this.handleCanvasClick),this.canvas.addEventListener("touchend",this.handleCanvasTouchEnd),this.handleResize=this.handleResize.bind(this),this.handleMouseDown=this.handleMouseDown.bind(this),this.handleMouseMove=this.handleMouseMove.bind(this),this.handleMouseUp=this.handleMouseUp.bind(this),this.handleWheel=this.handleWheel.bind(this),this.handleTouchStart=this.handleTouchStart.bind(this),this.handleTouchMove=this.handleTouchMove.bind(this),this.handleTouchEnd=this.handleTouchEnd.bind(this),this.draw=this.draw.bind(this),this.handleMouseLeave=this.handleMouseLeave.bind(this),window.addEventListener("resize",this.handleResize),this.canvas.addEventListener("mousedown",this.handleMouseDown),document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp),this.canvas.addEventListener("wheel",this.handleWheel),this.canvas.addEventListener("mouseleave",this.handleMouseLeave),this.canvas.addEventListener("touchstart",this.handleTouchStart),this.canvas.addEventListener("touchmove",this.handleTouchMove),this.canvas.addEventListener("touchend",this.handleTouchEnd)}getDisplayWidth(){return this.rotation%180==90?this.img.height:this.img.width}getDisplayHeight(){return this.rotation%180==90?this.img.width:this.img.height}calculateInitialScale(){if(!this.img)return;let e=this.getDisplayWidth(),t=this.getDisplayHeight(),n=this.logicalWidth/e,s=this.logicalHeight/t;this.options.minScale=Math.min(n,s,1),this.scale=this.options.minScale}centerImage(){if(!this.img)return;let e=this.getDisplayWidth()*this.scale,t=this.getDisplayHeight()*this.scale;this.posX=(this.logicalWidth-e)/2,this.posY=(this.logicalHeight-t)/2,this.enforceBounds()}setCustomDrawer(e){"function"==typeof e?this.customDrawer=e:console.error("setCustomDrawer expects to receive a function")}clearCustomDrawer(){this.customDrawer=null}draw(){if(this.needsRedraw){if(this.needsRedraw=!1,this.ctx.clearRect(0,0,this.logicalWidth,this.logicalHeight),this.img){this.ctx.save();let e=this.getDisplayWidth()*this.scale,t=this.getDisplayHeight()*this.scale;this.ctx.translate(this.posX+e/2,this.posY+t/2),this.ctx.rotate(this.rotation*Math.PI/180),this.ctx.scale(this.scale,this.scale),this.ctx.drawImage(this.img,-this.img.width/2,-this.img.height/2),this.ctx.restore()}this.customDrawer&&this.customDrawer(this.ctx,this)}}rotate(){this.rotation=(this.rotation+90)%360,this.calculateInitialScale(),this.centerImage(),this.requestRedraw()}loadImage(e){this.img=new Image,this.img.onload=()=>{this.rotation=0,this.calculateInitialScale(),this.centerImage(),this.requestRedraw()},this.img.src=e}enforceBounds(){if(!this.img)return;let e=this.getDisplayWidth()*this.scale,t=this.getDisplayHeight()*this.scale;e>this.logicalWidth?this.posX=Math.min(Math.max(this.posX,this.logicalWidth-e),0):this.posX=(this.logicalWidth-e)/2,t>this.logicalHeight?this.posY=Math.min(Math.max(this.posY,this.logicalHeight-t),0):this.posY=(this.logicalHeight-t)/2}isInImageArea(e,t){if(!this.img)return!1;let n=this.getDisplayWidth()*this.scale,s=this.getDisplayHeight()*this.scale,a=this.posX,i=this.posY,o=Math.min(a+n,this.logicalWidth),l=Math.min(i+s,this.logicalHeight);return e>=Math.max(a,0)&&e<=o&&t>=Math.max(i,0)&&t<=l}requestRedraw(){this.needsRedraw||(this.needsRedraw=!0,this.canvas.dispatchEvent(new MouseEvent("mousemove")),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId),this.animationFrameId=requestAnimationFrame(this.draw))}handleMouseDown(e){let t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top;this.isDraggable()&&this.isInImageArea(n,s)&&(this.isDragging=!0,this.lastX=e.clientX,this.lastY=e.clientY,this.canvas.style.cursor="grabbing")}handleMouseLeave(){this.canvas.style.cursor="default"}handleMouseMove(e){let t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top;if(this.isInImageArea(n,s)?this.canvas.style.cursor=this.isDragging?"grabbing":"grab":this.canvas.style.cursor="default",this.isDragging){let a=Date.now(),i=a-this.lastTime;this.lastTime=a;let o=e.clientX-this.lastX,l=e.clientY-this.lastY;this.posX+=o,this.posY+=l,i>0&&(this.velocityX=o/i,this.velocityY=l/i),this.lastX=e.clientX,this.lastY=e.clientY,this.enforceBounds(),this.requestRedraw()}}handleMouseUp(e){this.isDragging=!1,Math.abs(this.velocityX)>this.minVelocityThreshold||Math.abs(this.velocityY)>this.minVelocityThreshold?this.startInertia():(this.velocityX=0,this.velocityY=0);let t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top;this.isInImageArea(n,s)?this.canvas.style.cursor="grab":this.canvas.style.cursor="default"}startInertia(){this.isInertialMoving=!0,this.lastTime=Date.now(),this.animateInertia()}animateInertia(){if(!this.isInertialMoving)return;let e=Date.now(),t=e-this.lastTime;this.lastTime=e,this.velocityX*=Math.pow(this.decelerationRate,t/16),this.velocityY*=Math.pow(this.decelerationRate,t/16),this.posX+=this.velocityX*t,this.posY+=this.velocityY*t,this.enforceBounds(),this.requestRedraw(),Math.abs(this.velocityX)<this.minVelocityThreshold&&Math.abs(this.velocityY)<this.minVelocityThreshold?(this.isInertialMoving=!1,this.velocityX=0,this.velocityY=0):requestAnimationFrame(this.animateInertia.bind(this))}handleWheel(e){e.preventDefault();let t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top;if(!this.isInImageArea(n,s))return;let a=e.deltaY>0?.9:1.1,i=(n-this.posX)/this.scale,o=(s-this.posY)/this.scale,l=Math.min(Math.max(this.scale*a,this.options.minScale),this.options.maxScale);this.posX=n-i*l,this.posY=s-o*l,this.scale=l,this.enforceBounds(),this.requestRedraw()}handleTouchStart(e){if(0===e.touches.length)return;let t=Array.from(e.touches),n=this.getTouchCenter(t);this.initialCenterX=n.x,this.initialCenterY=n.y,this.touchStartPosX=this.posX,this.touchStartPosY=this.posY,this.touchStartScale=this.scale,e.touches.length>=2&&(this.initialDistance=this.getTouchDistance(e.touches[0],e.touches[1])),this.isTouching=!0}handleTouchMove(e){if(!this.isTouching)return;e.preventDefault();let t=Array.from(e.touches);if(0===t.length)return;let n=this.getTouchCenter(t),s=1;if(t.length>=2){let a=this.getTouchDistance(t[0],t[1]);this.initialDistance>0&&(s=a/this.initialDistance)}let i=Math.min(Math.max(this.touchStartScale*s,this.options.minScale),this.options.maxScale),o=(this.initialCenterX-this.touchStartPosX)/this.touchStartScale,l=(this.initialCenterY-this.touchStartPosY)/this.touchStartScale;if(this.posX=n.x-o*i,this.posY=n.y-l*i,this.scale=i,this.enforceBounds(),this.requestRedraw(),1===t.length){let r=Date.now(),c=r-this.lastTime;this.lastTime=r;let d=this.canvas.getBoundingClientRect(),h=t[0],u=h.clientX-d.left,p=h.clientY-d.top;c>0&&(this.velocityX=(u-this.lastX)/c,this.velocityY=(p-this.lastY)/c),this.lastX=u,this.lastY=p}}handleTouchEnd(){this.isTouching=!1,this.initialDistance=0,Math.abs(this.velocityX)>this.minVelocityThreshold||Math.abs(this.velocityY)>this.minVelocityThreshold?this.startInertia():(this.velocityX=0,this.velocityY=0)}handleResize(){this.updateCanvasSize(),this.img&&(this.calculateInitialScale(),this.centerImage(),this.canvas.dispatchEvent(new MouseEvent("mousemove")),this.requestRedraw())}handleCanvasClick(e){if(!this.img)return;let t=this.canvas.getBoundingClientRect(),n=e.clientX-t.left,s=e.clientY-t.top;this.isInImageArea(n,s)||this.triggerClickOutside(e)}handleCanvasTouchEnd(e){if(!this.img||e.touches.length>0)return;let t=this.canvas.getBoundingClientRect(),n=e.changedTouches[0],s=n.clientX-t.left,a=n.clientY-t.top,i=new Date().getTime();if(i-this.lastTapTime<360){clearTimeout(this.tapTimeout);return}this.tapTimeout=setTimeout(()=>{this.isInImageArea(s,a)||this.triggerClickOutside(e),this.lastTapTime=i},200)}getTouchDistance(e,t){let n=e.clientX-t.clientX,s=e.clientY-t.clientY;return Math.sqrt(n*n+s*s)}isDraggable(){return this.img&&(this.img.width*this.scale>this.logicalWidth||this.img.height*this.scale>this.logicalHeight)}triggerClickOutside(e){if("function"==typeof this.options.onClickOutside){let t=this.canvas.getBoundingClientRect(),n={x:e.clientX-t.left,y:e.clientY-t.top,canvasX:e.clientX-t.left,canvasY:e.clientY-t.top,imageX:-1,imageY:-1};this.img&&(n.imageX=(n.canvasX-this.posX)/this.scale,n.imageY=(n.canvasY-this.posY)/this.scale),this.options.onClickOutside(n,e)}}getTouchCenter(e){let t=0,n=0,s=this.canvas.getBoundingClientRect();for(let a of e)t+=a.clientX-s.left,n+=a.clientY-s.top;return{x:t/e.length,y:n/e.length}}destroy(){window.removeEventListener("resize",this.handleResize),document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.canvas.removeEventListener("mouseleave",this.handleMouseLeave),this.canvas.removeEventListener("mousedown",this.handleMouseDown),this.canvas.removeEventListener("wheel",this.handleWheel),this.canvas.removeEventListener("touchstart",this.handleTouchStart),this.canvas.removeEventListener("touchmove",this.handleTouchMove),this.canvas.removeEventListener("touchend",this.handleTouchEnd),this.canvas.removeEventListener("click",this.handleCanvasClick),this.canvas.removeEventListener("touchend",this.handleCanvasTouchEnd),this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}}function cubicBezier(e,t,n,s){let a=3*e-3*n+1,i=3*n-6*e,o=3*e,l=3*t-3*s+1,r=3*s-6*t,c=3*t;function d(e){return((a*e+i)*e+o)*e}function h(e){return(3*a*e+2*i)*e+o}return e=>{var t;return((l*(t=function e(t){let n=0,s=1,a=t;for(let i=0;i<8;i++){let o=d(a)-t;if(1e-6>Math.abs(o))return a;let l=h(a);if(1e-6>Math.abs(l))break;a-=o/l}for(;s>n;){let r=d(a)-t;if(1e-6>Math.abs(r))break;r>0?s=a:n=a,a=(s+n)/2}return a}(e))+r)*t+c)*t}}function bindMenuNavigation(e,t="vertical"){function n(){if(e.length<=1){e.forEach(e=>{e._navHandler&&(e.removeEventListener("keydown",e._navHandler),delete e._navHandler)});return}e.forEach((n,s)=>{n._navHandler&&n.removeEventListener("keydown",n._navHandler),n._navHandler=n=>{let a=s;if("vertical"===t){if("ArrowDown"===n.key)a=(s+1)%e.length;else{if("ArrowUp"!==n.key)return;a=(s-1+e.length)%e.length}}else if("horizontal"!==t)return;else if("ArrowRight"===n.key)a=(s+1)%e.length;else{if("ArrowLeft"!==n.key)return;a=(s-1+e.length)%e.length}e[a].focus()},n.addEventListener("keydown",n._navHandler)})}return n(),{removeItem:function t(s){e=e.filter(e=>e!==s),n()},addItem:function t(s){e.push(s),n()},updateEventListeners:n}}HTMLElement.prototype.clear=function(){this.innerHTML=""},HTMLElement.prototype.focusable=function(e){this.tabIndex=e?"0":"-1",this.blur()},HTMLElement.prototype.bindWithCooldown=function(e,t=500){let n=this;n._bindWithCooldownHandler&&(n.removeEventListener("click",n._bindWithCooldownHandler),n.removeEventListener("keydown",n._bindWithCooldownHandler));let s=0,a=function(a){let i=Date.now();n.classList.contains("disabled")||n.hasAttribute("disabled")||"click"!==a.type&&32!==a.keyCode&&13!==a.keyCode||!(i-s>=t)&&0!==t||(s=i,e.call(n,a))};n.addEventListener("click",a),n.addEventListener("keydown",a),n._bindWithCooldownHandler=a};let myStorage={set(e,t){try{let n=JSON.stringify(t);localStorage.setItem(e,n)}catch(s){console.error("Error saving to localStorage",s)}},get(e,t=null){try{let n=localStorage.getItem(e);return null!==n?JSON.parse(n):t}catch(s){return console.error("Error reading from localStorage",s),t}},remove(e){try{localStorage.removeItem(e)}catch(t){console.error("Error removing from localStorage",t)}},clear(){try{localStorage.clear()}catch(e){console.error("Error clearing localStorage",e)}},has:e=>null!==localStorage.getItem(e),keys:()=>Object.keys(localStorage)};class MyTooltip{constructor({parent:e,text:t,placement:n="top"}){this._parent=e,this._content=t,this._placement=n,this._tooltip=null,this._tooltipId=`tooltip-${Math.random().toString(36).substr(2,9)}`,this._parent.setAttribute("aria-describedby",this._tooltipId),this.showTooltip=this.showTooltip.bind(this),this.hideTooltip=this.hideTooltip.bind(this),this._parent.addEventListener("mouseenter",this.showTooltip),this._parent.addEventListener("focus",this.showTooltip),this._parent.addEventListener("blur",this.hideTooltip),this._parent.addEventListener("mouseleave",this.hideTooltip),this._lastRect=null,this._observer=new MutationObserver(()=>{document.body.contains(this._parent)||this.destroy()}),this._observer.observe(document.body,{childList:!0,subtree:!0});let s=()=>{if(this._tooltip&&this._parent){let e=this._parent.getBoundingClientRect();this._lastRect&&e.top===this._lastRect.top&&e.left===this._lastRect.left&&e.width===this._lastRect.width&&e.height===this._lastRect.height||(this.updatePosition(),this._lastRect=e)}this._rafId=requestAnimationFrame(s)};this._rafId=requestAnimationFrame(s)}_createTooltipElement(){let e=ec("xuocLuDI6");return e.setAttribute("placement",this._placement),e.setAttribute("id",this._tooltipId),e.innerText=this._content,e}updatePosition(){if(!this._tooltip)return;let e=this._parent.getBoundingClientRect(),t=this._tooltip.getBoundingClientRect(),n,s;switch(this._placement){case"top":n=window.scrollY+e.top-t.height-8,s=window.scrollX+e.left+e.width/2-t.width/2;break;case"bottom":n=window.scrollY+e.bottom+8,s=window.scrollX+e.left+e.width/2-t.width/2;break;case"left":n=window.scrollY+e.top+e.height/2-t.height/2,s=window.scrollX+e.left-t.width-8;break;case"right":n=window.scrollY+e.top+e.height/2-t.height/2,s=window.scrollX+e.right+8;break;default:throw Error("Invalid placement value")}this._tooltip.style.top=`${n}px`,this._tooltip.style.left=`${s}px`}showTooltip(){this._tooltip||(this._tooltip=this._createTooltipElement(),document.body.appendChild(this._tooltip),this.updatePosition(),this._tooltip.setAttribute("data-state","delayed-open"),this._tooltip.setAttribute("aria-expanded","true"))}hideTooltip(){this._tooltip&&(this._tooltip.setAttribute("data-state","closed"),this._tooltip.setAttribute("aria-expanded","false"),this._tooltip.remove(),this._tooltip=null)}setText(e){this._content=e,this._tooltip&&(this._tooltip.innerText=e,this.updatePosition())}destroy(){this.hideTooltip(),this._observer&&(this._observer.disconnect(),this._observer=null),this._rafId&&(cancelAnimationFrame(this._rafId),this._rafId=null),this._parent&&(this._parent.removeAttribute("aria-describedby"),this._parent.removeEventListener("mouseenter",this.showTooltip),this._parent.removeEventListener("focus",this.showTooltip),this._parent.removeEventListener("blur",this.hideTooltip),this._parent.removeEventListener("mouseleave",this.hideTooltip)),this._tooltip=null,this._parent=null,this._content=null}}class MyPopover{constructor({trigger:e,placement:t="bottom"}){let n=`_${generateRandomString(12)}`;this.trigger=e,this.placement=t,this.Root=ec("xEHCrF5Oe"),this.Overlay=ec("overlay"),this.Content=ec("xC3Uih0ex"),this.Root.setAttribute("data-state","open"),this.Root.setAttribute("role","popover"),this.Root.setAttribute("aria-modal","true"),this.Root.id=n;let s=ec("xqUosfZYR");document.body.appendChild(this.Root),this.Root.appendChild(s),this.Root.appendChild(this.Overlay),this.Root.appendChild(this.Content),this.Root.onwheel=function(e){e.ctrlKey&&e.preventDefault()};let a=cssEscape(n);this.inertElements=document.querySelectorAll(`body > *:not(#${a}, script, style)`),this.inertElements.forEach(e=>{e.setAttribute("inert","true")}),this.Overlay.addEventListener("click",()=>this.close()),this.Overlay.addEventListener("contextmenu",()=>this.close()),document.addEventListener("keydown",this._handleKeyDown),this._setPosition(),window.addEventListener("resize",this._handleResize)}_handleResize=()=>{this._setPosition()};_setPosition(){let e=this.trigger.getBoundingClientRect(),t=this.Content.getBoundingClientRect(),n;if(Array.isArray(this.placement)){for(let s of this.placement){let a=this._calculatePosition(s,e,t);if(this._isPositionWithinViewport(a,t)){n=s;break}}n||(n=this.placement[0])}else n=this.placement;let i=this._calculatePosition(n,e,t),o=window.innerWidth,l=window.innerHeight;i.top=Math.min(Math.max(i.top,16),l-t.height-16),i.left=Math.min(Math.max(i.left,16),o-t.width-16),this.Content.style.top=`${i.top}px`,this.Content.style.left=`${i.left}px`}_calculatePosition(e,t,n){let s=0,a=0,[i,o]=e.split("-");switch(i){case"top":s=t.top-n.height;break;case"bottom":s=t.bottom;break;case"left":a=t.left-n.width;break;case"right":a=t.right}switch(o){case"start":a=t.left;break;case"end":a=t.left+t.width-n.width;break;default:"top"===i||"bottom"===i?a=t.left+(t.width-n.width)/2:s=t.top+(t.height-n.height)/2}return"top"===i&&this.Content.classList.add("xJEHQvAuh"),{top:s,left:a}}_isPositionWithinViewport(e,t){let n=window.innerWidth,s=window.innerHeight,{top:a,left:i}=e;return a>=0&&i>=0&&a+t.height<=s&&i+t.width<=n}_handleKeyDown=e=>{27===e.keyCode&&(this.close(),this.trigger.focus())};_removeListeners(){document.removeEventListener("keydown",this._handleKeyDown),window.removeEventListener("resize",this._handleResize)}addItem(e,t){let n=document.createElement("div");n.classList.add("contextmenu-item"),n.setAttribute("role","menuitem"),n.textContent=e,n.tabIndex=0,n.addEventListener("click",()=>{t?.(),this.close()}),n.addEventListener("keydown",e=>{("Enter"===e.key||" "===e.key)&&(t?.(),this.close())}),this.Content.appendChild(n),this.menuItems.push(n),this.navController.addItem(n)}onClose(e){this.onCloseCallback=e}close(){this._removeListeners(),this.inertElements.forEach(e=>{e.removeAttribute("inert")}),this.Root.setAttribute("data-state","closed"),setTimeout(()=>{this.Root.remove(),this.onCloseCallback&&this.onCloseCallback()},100)}}function cssEscape(e){return e.replace(/([!"#$%&'()*+,.\/:;<=>?@[\\\]^`{|}~])/g,"\\$&").replace(/^(-?\d)/,"\\3"+e.charAt(0)+" ")}class MyDialog{constructor({closeOnOverlayClick:e=!1,closeOnEsc:t=!1,excludeElements:n=[]}={}){let s=`_${generateRandomString(12)}`;this.Root=ec("x54SkYRT0"),this.Overlay=ec("overlay"),this.Content=ec("content");let a=ec("xqUosfZYR");this.Root.setAttribute("data-state","open"),this.Root.appendChild(a),this.Root.appendChild(this.Overlay),this.Root.appendChild(this.Content),this.Root.setAttribute("role","dialog"),this.Root.setAttribute("aria-modal","true"),this.Root.onwheel=function(e){e.ctrlKey&&e.preventDefault()},this.Lock=!1,this.Root.id=s;let i=cssEscape(s);this.inertElements=Array.from(document.querySelectorAll(`body > *:not(#${i}, script, style)`)),this.inertElements.forEach(e=>e.setAttribute("inert","true")),this._exclude_for_restore=n,document.body.appendChild(this.Root),this.Root.classList.add("show"),MyDialog.stack.push(this),e&&this.Overlay.addEventListener("click",this._handleOverlayClick),t&&document.addEventListener("keydown",this._handleKeyDown)}_handleOverlayClick=()=>{this.close()};_handleKeyDown=e=>{27===e.keyCode&&MyDialog.stack[MyDialog.stack.length-1]===this&&this.close()};onClose(e){this.onCloseCallback=e}close(){if(!this.Lock){let e=MyDialog.stack.indexOf(this);e>-1&&MyDialog.stack.splice(e,1),this.onCloseCallback&&this.onCloseCallback(),this._exclude_for_restore.length>0?this._exclude_for_restore.forEach(e=>{e instanceof HTMLElement&&e.removeAttribute("inert")}):this.inertElements.forEach(e=>{e.removeAttribute("inert")}),this.Root.setAttribute("data-state","closed"),setTimeout(()=>{this.Root.remove()},100),this._removeListeners()}}_removeListeners(){this.Overlay.onclick=null,document.removeEventListener("keydown",this._handleKeyDown)}}MyDialog.stack=[];class AlertDialog extends MyDialog{constructor({title:e,message:t,buttons:n=[],closeOnOverlayClick:s=!1,closeOnEsc:a=!0,showCloseButton:i=!1}={}){super({closeOnOverlayClick:s,closeOnEsc:a});let o=this._createHeader(e,i),l=this._createBody(t);if(this.Content.style.padding="0px",this.Content.classList.add("xv1VrMJb6"),this.Content.classList.add("xLDQZ1SSl"),this.Content.appendChild(o),this.Content.appendChild(l),n.length>0){let r=this._createFooter(n);l.appendChild(r)}}_createHeader(e,t){let n=document.createElement("div");n.className="xrYn5ZY3v lf gn";let s=document.createElement("div");if(s.className="x6Y89FynP",s.textContent=e||"Alert",n.appendChild(s),t){let a=ec("xvb5soWNa");a.focusable(!0),a.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',a.bindWithCooldown(()=>{this.close()}),n.appendChild(a)}return n}_createBody(e){let t=document.createElement("div");t.className="xWDUelLWA";let n=document.createElement("div");return n.className="xujSSErs5",n.innerHTML=e||"Are you sure?",t.appendChild(n),t}_createFooter(e){let t=document.createElement("div");t.className="xWh2LBcgj";let n=bindMenuNavigation([],"vertical");return e.forEach(({text:e,classList:s=[],onClick:a})=>{let i=ec("xtSMPpB1C"),o=document.createElement("div");o.className="xgw2tzk6r "+s.join(" "),o.setAttribute("tabindex","0"),o.textContent=e,o.bindWithCooldown(()=>{a&&a(),this.close()}),i.appendChild(o),n.addItem(o),t.appendChild(i)}),t}}let ec=e=>{let t=document.createElement("div");return t.classList.add(e),t},_=e=>document.querySelector(e);function generateRandomString(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="";for(let s=0;s<e;s++)n+=t.charAt(Math.floor(Math.random()*t.length));return n}function typewriterWithBezier(e,t,n={}){let{interval:s=24,fadeDuration:a=214,bezierControl:i=[.42,0,1,1]}=n;e.clear();let o=cubicBezier(...i),l=Array.from((new DOMParser).parseFromString(`<div>${t}</div>`,"text/html").body.firstChild.childNodes),r=[];l.forEach(t=>(function e(t,n){if(t.nodeType===Node.TEXT_NODE){let s=t.textContent.split("");for(let a of s){let i=document.createElement("span");i.classList.add("xSwoj5Cx2"),i.textContent=a,n.appendChild(i),r.push(i)}}else if(t.nodeType===Node.ELEMENT_NODE){let o=t.cloneNode(!1);n.appendChild(o),Array.from(t.childNodes).forEach(t=>e(t,o))}})(t,e)),function e(){r.length&&(function e(t){let n=performance.now();function s(e){let i=Math.min((e-n)/a,1),l=o(i);t.style.opacity=l,i<1&&requestAnimationFrame(s)}requestAnimationFrame(s)}(r.shift()),setTimeout(e,s))}()}function getScreenInfo(){return{screenWidth:window.screen.width,screenHeight:window.screen.height,devicePixelRatio:window.devicePixelRatio}}function detectDeviceOS(){let e=navigator.userAgent||navigator.vendor||window.opera,t=navigator.platform,n=navigator.maxTouchPoints||0;if(/iPad|iPhone|iPod/.test(e)||"MacIntel"===t&&n>1){let s=e.match(/OS (\d+)_?(\d+)?_?(\d+)?/i);if(s)return{os:"iOS",version:`${s[1]||"0"}.${s[2]||"0"}.${s[3]||"0"}`,deviceType:/iPad/.test(e)?"Tablet":"Mobile"}}if(/Android/.test(e)){let a=e.match(/Android (\d+)\.?(\d+)?\.?(\d+)?/i);if(a)return{os:"Android",version:`${a[1]||"0"}.${a[2]||"0"}.${a[3]||"0"}`,deviceType:/Mobile/.test(e)?"Mobile":"Tablet"}}if(/Win/.test(t)){let i=e.match(/Windows NT (\d+)\.?(\d+)?/i);return i?{os:"Windows",version:`${i[1]||"0"}.${i[2]||"0"}`,deviceType:"Desktop"}:{os:"Windows",version:null,deviceType:"Desktop"}}if(/Mac/.test(t)){let o=e.match(/Mac OS X (\d+)_?(\d+)?_?(\d+)?/i);return o?{os:"macOS",version:`${o[1]||"0"}.${o[2]||"0"}.${o[3]||"0"}`,deviceType:"Desktop"}:{os:"macOS",version:null,deviceType:"Desktop"}}return/Linux/.test(t)?{os:"Linux",version:null,deviceType:"Desktop"}:{os:"Unknown",version:null,deviceType:"Unknown"}}function convertRubySyntax(e){return e.replace(/\{RUBY_B#(.*?)\}(.*?)\{RUBY_E#\}/g,(e,t,n)=>`<ruby><rb>${n}</rb><rt>${t}</rt></ruby>`)}let platformIcons={translate:'<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M4 5h7" /><path d="M9 3v2c0 4.418 -2.239 8 -5 8" /><path d="M5 9c0 2.144 2.952 3.908 6.7 4" /><path d="M12 20l4 -9l4 9" /><path d="M19.1 18h-6.2" /></svg>',edit:'<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"  stroke-linecap="round" stroke-linejoin="round"><path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" /><path d="M13.5 6.5l4 4" /></svg>',trash:'<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M4 7l16 0" /><path d="M10 11l0 6" /><path d="M14 11l0 6" /><path d="M5 7l1 12a2 2 0 0 0 2 2h8a2 2 0 0 0 2 -2l1 -12" /><path d="M9 7v-3a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v3" /></svg>',copy:'<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M7 7m0 2.667a2.667 2.667 0 0 1 2.667 -2.667h8.666a2.667 2.667 0 0 1 2.667 2.667v8.666a2.667 2.667 0 0 1 -2.667 2.667h-8.666a2.667 2.667 0 0 1 -2.667 -2.667z" /><path d="M4.012 16.737a2.005 2.005 0 0 1 -1.012 -1.737v-10c0 -1.1 .9 -2 2 -2h10c.75 0 1.158 .385 1.5 1" /></svg>',filter1:'<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16v2.172a2 2 0 0 1 -.586 1.414l-4.414 4.414v7l-6 2v-8.5l-4.48 -4.928a2 2 0 0 1 -.52 -1.345v-2.227z" /></svg>',chevron4:'<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path><path d="M6 9l6 6l6 -6"></path></svg>',check:'<svg  aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M5 12l5 5l10 -10" /></svg>'};class MyDrawer{constructor({closeOnOverlayClick:e=!1,closeOnEsc:t=!1,excludeElements:n=[]}={}){let s=`_${generateRandomString(12)}`,a=ec("xqUosfZYR");this.Root=ec("drawer-root"),this.Overlay=ec("drawer-overlay"),this.Content=ec("drawer-content"),this.Header=ec("drawer-header"),this.Handle=document.createElement("div"),this.Handle.className="drawer-drag-handle",this.Header.appendChild(this.Handle),this.Body=ec("drawer-body"),this.Content.appendChild(this.Header),this.Content.appendChild(this.Body),this.Root.setAttribute("data-state","open"),this.Root.appendChild(a),this.Root.appendChild(this.Overlay),this.Root.appendChild(this.Content),this.Root.setAttribute("role","dialog"),this.Root.setAttribute("aria-modal","true"),this.Root.onwheel=e=>{e.ctrlKey&&e.preventDefault()},this.Root.id=s;let i=cssEscape(s);this.inertElements=Array.from(document.querySelectorAll(`body > *:not(#${i}, script, style)`)),this.inertElements.forEach(e=>e.setAttribute("inert","true")),this._exclude_for_restore=n,document.body.appendChild(this.Root),this.Root.classList.add("show"),MyDrawer.stack.push(this),e&&this.Overlay.addEventListener("click",this._handleOverlayClick),t&&document.addEventListener("keydown",this._handleKeyDown),this._setupDrag()}_handleOverlayClick=()=>{this.close()};_handleKeyDown=e=>{27===e.keyCode&&MyDrawer.stack[MyDrawer.stack.length-1]===this&&this.close()};onClose(e){this.onCloseCallback=e}close(){let e=MyDrawer.stack.indexOf(this);e>-1&&MyDrawer.stack.splice(e,1),this.onCloseCallback&&this.onCloseCallback();let t=()=>{this._exclude_for_restore.length>0?this._exclude_for_restore.forEach(e=>e.removeAttribute("inert")):this.inertElements.forEach(e=>e.removeAttribute("inert"))},n=window.getComputedStyle(this.Content).transform;"none"===n||n.includes("matrix")?(this.Content.classList.remove("x9GmoP75O"),this.Content.style.transform="translateY(100%)",setTimeout(()=>{t(),this.Root.remove()},300)):(t(),this.Root.remove()),this._removeListeners()}_removeListeners(){this.Overlay.onclick=null,document.removeEventListener("keydown",this._handleKeyDown)}_setupDrag(){let e=0,t=0,n=0,s=!1,a=t=>{0===t.target.scrollTop&&(e=t.touches?t.touches[0].clientY:t.clientY,n=Date.now(),s=!0,this.Content.classList.add("x9GmoP75O"))},i=n=>{if(!s)return;let a=(t=n.touches?n.touches[0].clientY:n.clientY)-e,i=this.Content.offsetHeight;a>0&&(this.Content.style.transform=`translateY(${a}px)`,this.Overlay.style.opacity=Math.max(1-a/i,0))},o=()=>{if(!s)return;let a=t-e,i=(Date.now()-n)/1e3,o=this.Content.offsetHeight;this.Content.classList.remove("x9GmoP75O"),a>.5*o||a/i>600?this.close():(this.Content.style.transform="translateY(0)",this.Overlay.style.opacity=1),s=!1};this.Header.addEventListener("touchstart",a,{passive:!0}),this.Content.addEventListener("touchmove",i,{passive:!0}),this.Content.addEventListener("touchend",o),this.Header.addEventListener("mousedown",e=>{a(e);let t=e=>i(e),n=()=>{o(),document.removeEventListener("mousemove",t),document.removeEventListener("mouseup",n)};document.addEventListener("mousemove",t),document.addEventListener("mouseup",n)})}}MyDrawer.stack=[];class Translator{constructor(){this.baseUrl="https://translate.googleapis.com/translate_a/single",this.client="gtx"}async translate(e,t="en",n="auto"){let s=new URLSearchParams({client:this.client,sl:n,tl:t,dt:"t",q:e});try{let a=await fetch(`${this.baseUrl}?${s}`);if(!a.ok)throw Error(`Translation failed, status code: ${a.status}`);let i=await a.json(),o="";i[0]&&i[0].forEach(e=>{e[0]&&(o+=e[0])});let l=i[2]||n;return{original:{text:e,language:l},translated:{text:o,language:t}}}catch(r){throw Error(`Translation error: ${r.message}`)}}}let faceEmojis=[{content:"\uD83D\uDE00",en:"Grinning Face",zh:"咧嘴笑"},{content:"\uD83D\uDE01",en:"Beaming Face with Smiling Eyes",zh:"眯眼笑"},{content:"\uD83D\uDE02",en:"Face with Tears of Joy",zh:"笑哭"},{content:"\uD83E\uDD23",en:"Rolling on the Floor Laughing",zh:"笑得打滚"},{content:"\uD83D\uDE03",en:"Grinning Face with Big Eyes",zh:"開口大笑"},{content:"\uD83D\uDE04",en:"Grinning Face with Smiling Eyes",zh:"瞇眼大笑"},{content:"\uD83D\uDE05",en:"Grinning Face with Sweat",zh:"尷尬笑"},{content:"\uD83D\uDE06",en:"Grinning Squinting Face",zh:"哈哈笑"},{content:"\uD83D\uDE09",en:"Winking Face",zh:"眨眼"},{content:"\uD83D\uDE0A",en:"Smiling Face with Smiling Eyes",zh:"微笑"},{content:"\uD83D\uDE0B",en:"Face Savoring Food",zh:"美味臉"},{content:"\uD83D\uDE0E",en:"Smiling Face with Sunglasses",zh:"戴墨鏡笑"},{content:"\uD83D\uDE0D",en:"Smiling Face with Heart-Eyes",zh:"花痴笑"},{content:"\uD83D\uDE18",en:"Face Blowing a Kiss",zh:"飛吻"},{content:"\uD83E\uDD70",en:"Smiling Face with Hearts",zh:"幸福笑"},{content:"\uD83D\uDE17",en:"Kissing Face",zh:"親吻"},{content:"\uD83D\uDE19",en:"Kissing Face with Smiling Eyes",zh:"瞇眼親"},{content:"\uD83D\uDE1A",en:"Kissing Face with Closed Eyes",zh:"閉眼親"},{content:"\uD83D\uDE42",en:"Slightly Smiling Face",zh:"微微笑"},{content:"\uD83E\uDD17",en:"Hugging Face",zh:"擁抱臉"},{content:"\uD83E\uDD29",en:"Star-Struck",zh:"追星臉"},{content:"\uD83E\uDD14",en:"Thinking Face",zh:"思考臉"},{content:"\uD83E\uDD28",en:"Face with Raised Eyebrow",zh:"挑眉臉"},{content:"\uD83D\uDE10",en:"Neutral Face",zh:"無表情"},{content:"\uD83D\uDE11",en:"Expressionless Face",zh:"冷漠臉"},{content:"\uD83D\uDE36",en:"Face Without Mouth",zh:"無言臉"},{content:"\uD83D\uDE44",en:"Face with Rolling Eyes",zh:"白眼"},{content:"\uD83D\uDE0F",en:"Smirking Face",zh:"得意笑"},{content:"\uD83D\uDE23",en:"Persevering Face",zh:"忍耐臉"},{content:"\uD83D\uDE25",en:"Sad but Relieved Face",zh:"悲傷但解脫"},{content:"\uD83D\uDE2E",en:"Face with Open Mouth",zh:"張嘴驚訝"},{content:"\uD83E\uDD10",en:"Zipper-Mouth Face",zh:"閉嘴臉"},{content:"\uD83D\uDE2F",en:"Hushed Face",zh:"沉默臉"},{content:"\uD83D\uDE2A",en:"Sleepy Face",zh:"睏倦臉"},{content:"\uD83D\uDE2B",en:"Tired Face",zh:"疲憊臉"},{content:"\uD83E\uDD71",en:"Yawning Face",zh:"打哈欠"},{content:"\uD83D\uDE34",en:"Sleeping Face",zh:"睡覺臉"},{content:"\uD83D\uDE0C",en:"Relieved Face",zh:"解脫臉"},{content:"\uD83D\uDE1B",en:"Face with Tongue",zh:"吐舌臉"},{content:"\uD83D\uDE1C",en:"Winking Face with Tongue",zh:"眨眼吐舌"},{content:"\uD83D\uDE1D",en:"Squinting Face with Tongue",zh:"搞怪臉"},{content:"\uD83E\uDD24",en:"Drooling Face",zh:"流口水"},{content:"\uD83D\uDE12",en:"Unamused Face",zh:"不爽臉"},{content:"\uD83D\uDE13",en:"Downcast Face with Sweat",zh:"冷汗臉"},{content:"\uD83D\uDE14",en:"Pensive Face",zh:"憂鬱臉"},{content:"\uD83D\uDE15",en:"Confused Face",zh:"困惑臉"},{content:"\uD83D\uDE43",en:"Upside-Down Face",zh:"倒臉"},{content:"\uD83E\uDEE0",en:"Melting Face",zh:"融化臉"},{content:"\uD83E\uDD11",en:"Money-Mouth Face",zh:"財迷臉"},{content:"\uD83D\uDE32",en:"Astonished Face",zh:"震驚臉"},{content:"☹️",en:"Frowning Face",zh:"哭喪臉"},{content:"\uD83D\uDE41",en:"Slightly Frowning Face",zh:"微皺眉"},{content:"\uD83D\uDE16",en:"Confounded Face",zh:"崩潰臉"},{content:"\uD83D\uDE1E",en:"Disappointed Face",zh:"失望臉"},{content:"\uD83D\uDE1F",en:"Worried Face",zh:"擔心臉"},{content:"\uD83D\uDE24",en:"Face with Steam From Nose",zh:"噴射臉"},{content:"\uD83D\uDE22",en:"Crying Face",zh:"哭泣"},{content:"\uD83D\uDE2D",en:"Loudly Crying Face",zh:"大哭"},{content:"\uD83D\uDE26",en:"Frowning Face with Open Mouth",zh:"張嘴皺眉"},{content:"\uD83D\uDE27",en:"Anguished Face",zh:"痛苦臉"},{content:"\uD83D\uDE28",en:"Fearful Face",zh:"害怕臉"},{content:"\uD83D\uDE29",en:"Weary Face",zh:"厭煩臉"},{content:"\uD83E\uDD2F",en:"Exploding Head",zh:"頭腦爆炸"},{content:"\uD83D\uDE2C",en:"Grimacing Face",zh:"齜牙咧嘴"},{content:"\uD83D\uDE30",en:"Anxious Face with Sweat",zh:"冷汗緊張"},{content:"\uD83D\uDE31",en:"Face Screaming in Fear",zh:"驚恐尖叫"},{content:"\uD83E\uDD75",en:"Hot Face",zh:"臉發熱"},{content:"\uD83E\uDD76",en:"Cold Face",zh:"臉發冷"},{content:"\uD83D\uDE33",en:"Flushed Face",zh:"臉紅"},{content:"\uD83E\uDD2A",en:"Zany Face",zh:"滑稽臉"},{content:"\uD83D\uDE35",en:"Dizzy Face",zh:"暈頭轉向"},{content:"\uD83E\uDD74",en:"Woozy Face",zh:"醉醺醺"},{content:"\uD83D\uDE20",en:"Angry Face",zh:"生氣"},{content:"\uD83D\uDE21",en:"Pouting Face",zh:"怒容滿面"},{content:"\uD83E\uDD2C",en:"Face with Symbols on Mouth",zh:"罵人嘴臉"},{content:"\uD83D\uDE37",en:"Face with Medical Mask",zh:"戴口罩"},{content:"\uD83E\uDD12",en:"Face with Thermometer",zh:"量體溫"},{content:"\uD83E\uDD15",en:"Face with Head-Bandage",zh:"受傷臉"},{content:"\uD83E\uDD22",en:"Nauseated Face",zh:"噁心臉"},{content:"\uD83E\uDD2E",en:"Face Vomiting",zh:"嘔吐臉"},{content:"\uD83E\uDD27",en:"Sneezing Face",zh:"打噴嚏"},{content:"\uD83E\uDD79",en:"Face Holding Back Tears",zh:"含淚臉"},{content:"\uD83E\uDEE5",en:"Dotted Line Face",zh:"虛線臉"},{content:"\uD83D\uDE07",en:"Smiling Face with Halo",zh:"天使光環"},{content:"\uD83E\uDD73",en:"Partying Face",zh:"派對臉"},{content:"\uD83E\uDD78",en:"Disguised Face",zh:"偽裝臉"},{content:"\uD83E\uDD7A",en:"Pleading Face",zh:"懇求臉"},{content:"\uD83E\uDD20",en:"Cowboy Hat Face",zh:"牛仔臉"},{content:"\uD83E\uDD21",en:"Clown Face",zh:"小丑臉"},{content:"\uD83E\uDD25",en:"Lying Face",zh:"說謊臉"},{content:"\uD83E\uDEE2",en:"Face with Open Eyes and Hand Over Mouth",zh:"摀嘴驚訝"},{content:"\uD83E\uDEE3",en:"Face with Peeking Eye",zh:"偷看臉"},];function addLongPressListener(e,t,n=500){let s=null,a=0,i=0;function o(e){e.type.startsWith("touch")?(a=e.touches[0].clientX,i=e.touches[0].clientY):(a=e.clientX,i=e.clientY),s=setTimeout(()=>{t(e),s=null},n)}function l(){s&&(clearTimeout(s),s=null)}function r(e){let t,n;e.type.startsWith("touch")?(t=e.touches[0].clientX,n=e.touches[0].clientY):(t=e.clientX,n=e.clientY),(Math.abs(t-a)>10||Math.abs(n-i)>10)&&l()}e.addEventListener("mousedown",o),e.addEventListener("touchstart",o),e.addEventListener("mouseup",l),e.addEventListener("mouseleave",l),e.addEventListener("touchend",l),e.addEventListener("touchcancel",l),e.addEventListener("mousemove",r),e.addEventListener("touchmove",r)}function setupSimpleVibratePolyfill(){let e=function e(){let t=navigator.userAgent;if(t.includes("Safari")&&!t.includes("Chrome")){let n=t.match(/Version\/(\d+(\.\d+)?)/);return n?parseFloat(n[1]):null}return null}();if(!e||navigator.vibrate||e<18.4)return;let t=document.createElement("label");t.style.display="none",t.innerHTML='<input type="checkbox" switch />',document.body.appendChild(t),navigator.vibrate=()=>{t.click()}}function isPWA(){return window.matchMedia("(display-mode: standalone)").matches||!0===window.navigator.standalone||document.referrer.startsWith("android-app://")}let lang=myStorage.get("lang"),currentLanguage="zh";lang?currentLanguage=lang:(currentLanguage="zh",myStorage.set("lang","zh"));let locales={zh:{a1:"搜尋…",a3:"在這裡輸入訊息…",a4:"更新了什麼",a5:"私人",a6:"說明",a7:"公開",a10:"查看全部",a14:"送出",a15:"查看個人資料",a16:"登出",a18:"$0 秒前",a19:"$0 個月前",a20:"$0 分鐘前",a21:"$0 小時前",a22:"$0 年前",a23:"$0 天前",a24:"無法預覽這個文件",a25:"下載",a26:"你",b1:"描述",b2:"最後上線",b3:"描述",b4:"暱稱",b5:"編輯個人資料",b6:"完成",b7:"完成",b8:"歡迎回來",b9:"登入帳號後即可使用我們的服務",b10:"等待中…",b11:"使用 Google 繼續",b12:"使用 電子郵件 登入",b13:"返回上一頁",b14:"密碼錯誤，請重新嘗試",b15:"找不到這個帳號，請重新嘗試",b16:"網路請求錯誤，請檢查網路連線",b17:"發生未知的錯誤",b18:"$0 則訊息",b19:"沒有訊息",b20:"所有成員",b21:"查看所有成員",b23:"退出",b24:"電子郵件地址",b25:"密碼",b26:"送出",b27:"電子郵件登入",b28:"@未知",b29:"未知",b30:"已成功清除緩存，重新載入後即生效",b31:"未知的指令，請重新嘗試",b32:"載入中…",b33:"確定要退出這個聊天室嗎，之後仍可重新加入",b34:"退出",b35:"取消",b36:"確定",c3:"已更新介面語言為：$0",c6:"系統通知",c7:"開啟後即可接收推送通知服務",c8:"自動調整排序",c9:"根據使用頻率自動排序",c10:"界面語言",c11:"需要重開才能更新語言",b42:"上傳中",b43:"正在上傳中，請耐心等待",b44:"上傳遭中斷",b45:"已取消上傳",b46:"上傳完成",b47:"這個文件已經成功上傳了",b48:"上傳失敗",b49:"這個文件有 $0 ，我們無法負擔",b50:"動態",b51:"暫無動態",b52:"點擊查看",b53:"還剩 $0 秒，速度 $1/s",b54:"登入帳號後即可加入這個聊天室",b55:"使用者名稱",d0:"附加文件",d1:"發送",d2:"選擇表情符號",d3:"標記為重要",d4:"取消標記",d5:"任何人都能加入這個聊天室",d6:"只有受邀人能加入本聊天室",d7:"重新載入後方可完整更新您的資料",d8:"這裡還沒有訊息，現在就開始聊天吧",d9:"未知",d10:"暫時還沒有描述哦",d13:"尚未加入任何聊天室",d14:"還沒有任何行程，現在就創建一個吧",d15:"全部內容",f1:"暫時沒有人欸…\xa0等等你不是人?",f2:"今天",f3:"明天",f4:"昨天",f5:"$0 天前",f6:"$0 天後",f11:"清除快取",f12:"隱藏動態",f13:"最後上線時間將不會公開",f14:"同步訊息更新",f15:"訊息被修改、刪除都將即時同步",f16:"攔截推銷與廣告內容",f17:"自動識別並攔截此類內容，可能不準確",f20:"設定",f21:"已清除",f22:"所有人",f23:"絕對時間表示",f24:"將從相對法改成絕對法，時間可能會因遭篡改而變得不準確",f25:"最多 24 個字符，不建議使用真名",f26:"最多 12 個字符，只能包含包含數字、英文字母、底線和句號",f27:"最多 108 個字符，可不填",f28:"清除緩存（$0）",s1:"當前版本：$0",s2:"開發者：$0",s3:"關於",s4:"翻譯",s5:"翻譯中…",s6:"查看原文",s7:"重試",s8:"$0:$1",s9:"一般",s10:"實驗性功能",s11:"其他",s12:"翻譯",s13:"刪除訊息",s14:"確定要刪除這則訊息嗎，刪除後將無法復原",s15:"刪除這則訊息",s16:"複製內容",s17:"複製連結",k1:"提示",k2:"你已提交過加入請求了，請等待管理員審批並授權加入權限",k3:"確定",k4:"你想要加入 $0 嗎？提交請求且被授權後即可加入",k5:"取消",k6:"邀請其他成員",k7:"點擊此連結以加入，$0個成員在線上",k8:"你想要加入 $0 嗎？公開聊天室可直接加入",g1:"本應用程式需要通過安裝 PWA 才能運行，具體安裝步驟如下：",g2:"1. 點擊右上角三個點的按鈕",g3:"2. 找到「加入主畫面」選項，點擊它",g4:"3. 點擊對話框右下角的「加入」按鈕",g5:"1. 點擊底下標籤欄中間的「分享」按鈕",g6:"2. 往下滑找到「加入主畫面」按鈕",g7:"3. 點擊右上角「加入」即安裝完成",g8:"界面外觀",g9:"可根據你的喜好自由更換色調主題",g10:"經典",g11:"二代",g12:"確定要清除所有緩存嗎，設定選項將會重置。",g13:"確定要登出嗎，稍後可重新登入"},zh2:{a1:"搜索…",a3:"在这里输入消息…",a4:"更新了什么",a5:"私人",a6:"说明",a7:"公开",a10:"查看全部",a14:"送出",a15:"查看个人资料",a16:"登出",a18:"$0 秒前",a19:"$0 个月前",a20:"$0 分钟前",a21:"$0 小时前",a22:"$0 年前",a23:"$0 天前",a24:"无法预览这个文件",a25:"下载",a26:"你",b1:"描述",b2:"最后上线",b3:"描述",b4:"昵称",b5:"编辑个人资料",b6:"完成",b7:"完成",b8:"欢迎回来",b9:"登入帐号后即可使用我们的服务",b10:"等待中…",b11:"使用 Google 继续",b12:"使用 电子邮件 登入",b13:"返回上一页",b14:"密码错误，请重新尝试",b15:"找不到这个帐号，请重新尝试",b16:"网路请求错误，请检查网路连线",b17:"发生未知的错误",b18:"$0 则消息",b19:"没有消息",b20:"所有成员",b21:"查看所有成员",b23:"退出",b24:"電子郵件地址",b25:"密碼",b26:"送出",b27:"电子邮件地址",b28:"@未知",b29:"未知",b30:"已成功清除缓存，重新载入后即生效",b31:"未知的指令，请重新尝试",b32:"加载中…",b33:"确定要退出这个聊天室吗，之后仍可重新加入",b34:"退出",b35:"取消",b36:"确定",c3:"已更新介面语言为：$0",c6:"系统通知",c7:"开启后即可接收推送通知服务",c8:"自动调整排序",c9:"根据使用频率自动排序",c10:"界面语言",c11:"需要重开才能更新语言",b42:"上传中",b43:"正在上传中，请耐心等待",b44:"上传遭中断",b45:"已取消上传",b46:"上传完成",b47:"这个文件已经成功上传了",b48:"上传失败",b49:"这个文件有 $0 ，我们无法负担",b50:"动态",b51:"暂无动态",b52:"点击查看",b53:"还剩 $0 秒，速度 $1/s",b54:"登入帐号后即可加入这个聊天室",b55:"用户名",d0:"附加文件",d1:"发送",d2:"選擇表情符號",d3:"标记为重要",d4:"取消标记",d5:"任何人都能加入这个聊天室",d6:"只有受邀人能加入本聊天室",d7:"重新载入后方可完整更新您的资料",d8:"这里还没有消息，现在就开始聊天吧",d9:"未知",d10:"暂时还没有描述哦",d13:"尚未加入任何聊天室",d14:"还没有任何行程，现在就创建一个吧",d15:"全部内容",f1:"暂时没有人欸…\xa0等等你不是人?",f2:"今天",f3:"明天",f4:"昨天",f5:"$0 天前",f6:"$0 天后",f11:"清除缓存",f12:"隐藏动态",f13:"最后上线时间将不会公开",f14:"同步消息更新",f15:"消息被修改、删除都将即时同步",f16:"拦截推销与广告内容",f17:"自动识别并拦截此类内容，可能不准确",f20:"设置",f21:"已清除",f22:"所有人",f23:"绝对时间表示",f24:"将从相对法改成绝对法，时间可能会因遭篡改而变得不准确",f25:"最多 24 个字符，不建议使用真名",f26:"最多 12 个字符，只能包含包含数字、英文字母、底线和句号",f27:"最多 108 个字符，可不填",f28:"清除缓存（$0）",s1:"当前版本：$0",s2:"开发者：$0",s3:"关于",s4:"翻译",s5:"翻译中…",s6:"查看原文",s7:"重试",s8:"$0:$1",s9:"一般",s10:"实验性功能",s11:"其他",s12:"翻译",s13:"删除消息",s14:"确定要删除这则消息吗，删除后将无法复原",s15:"删除这则消息",s16:"复制内容",s17:"复制连结",k1:"提示",k2:"你已提交过加入请求了，请等待管理员审批并授权加入权限",k3:"確定",k4:"你想要加入 $0 吗？提交请求且被授权后即可加入",k5:"取消",k6:"邀请其他成员",k7:"点击此连结以加入，$0个成员在线上",k8:"你想要加入 $0 吗？公开聊天室可直接加入",g1:"本应用程序需要通过安装 PWA 才能运行，具体安装步骤如下：",g2:"1. 点击右上角三个点的按钮",g3:"2. 找到「加入主画面」选项，点击它",g4:"3. 点击对话框右下角的「加入」按钮",g5:"1. 点击底下标签栏中间的「分享」按钮",g6:"2. 往下滑找到「加入主画面」按钮",g7:"3. 点击右上角「加入」即安装完成",g8:"界面外观",g9:"可根据你的喜好自由更换色调主题",g10:"经典",g11:"二代",g12:"确定要清除所有缓存吗，设定选项将会重置。",g13:"确定要登出吗，稍后可重新登入"},ja:{a1:"検索…",a3:"ここにメッセージを入力してください…",a4:"更新内容",a5:"プライベート",a6:"説明する",a7:"公共",a10:"すべて見る",a14:"送り出す",a15:"プロフィールを見る",a16:"サインアウト",a18:"$0秒前",a19:"$0ヶ月前",a20:"$0分前",a21:"$0時間前",a22:"$0年前",a23:"$0日前",a24:"このファイルをプレビューできません",a25:"ダウンロード",a26:"あなた",b1:"説明する",b2:"最後にオンラインで",b3:"説明する",b4:"ニックネーム",b5:"プロフィールの編集",b6:"仕上げる",b7:"仕上げる",b8:"おかえり",b9:"サービスをご利用いただくにはアカウントにログインしてください",b10:"等待中…",b11:"Google を続ける",b12:"電子メールを使用してログインする",b13:"前のページに戻る",b14:"パスワードが間違っています。もう一度お試しください。",b15:"このアカウントが見つかりません。もう一度お試しください。",b16:"ネットワーク要求エラー。ネットワーク接続を確認してください",b17:"不明なエラーが発生しました",b18:"$0 件のメッセージ",b19:"メッセージはありません",b20:"メンバー全員",b21:"メンバー全員",b23:"やめる",b24:"電子メールアドレス",b25:"パスワード",b26:"送り出す",b27:"メールログイン",b28:"@未知",b29:"未知",b30:"キャッシュは正常にクリアされました。リロード後に有効になります。",b31:"不明なコマンドです。もう一度お試しください。",b32:"読み込み中…",b33:"このチャットルームから退出してもよろしいですか？ 後で再度参加できます。",b34:"やめる",b35:"キャンセル",b36:"仕上げる",b37:"旅程",b38:"タイトル",b39:"始める",b40:"仕上げる",b41:"キャンセル",c3:"更新されたインターフェース言語:$0",c6:"システム通知",c7:"有効にすると、プッシュ通知を受け取ることができます",c8:"並べ替えを自動調整",c9:"使用頻度で並べ替え",c10:"インターフェース言語",c11:"言語を更新するには再起動が必要です",b42:"アップロード中",b43:"アップロード中です。しばらくお待ちください。",b44:"アップロードが中断されました",b45:"アップロードがキャンセルされました",b46:"アップロード完了",b47:"ファイルは正常にアップロードされました",b48:"アップロードに失敗しました",b49:"這個文件有 $0 ，我們無法負擔",b50:"動的",b51:"まだニュースはありません",b52:"クリックして表示",b53:"残り$0秒、速度$1/s",b54:"このチャットルームに参加するにはログインしてください",b55:"ユーザー名",d0:"添付ファイル",d1:"送信",d2:"絵文字を選択してください",d3:"重要としてマークする",d4:"マークを外す",d5:"このチャットルームには誰でも参加できます",d6:"このチャットルームに参加できるのは招待された人だけです",d7:"情報を完全に更新するにはリロードしてください",d8:"まだメッセージはありません。今すぐチャットを始めましょう。",d9:"未知",d10:"まだ説明はありません",d13:"まだどのチャットルームにも参加していません",d14:"まだ旅程をお持ちでないですか？今すぐ作成しましょう",d15:"すべてのコンテンツ",f1:"暫時沒有人欸…\xa0等等你不是人?",f2:"今日",f3:"明日",f4:"昨日",f5:"$0 天前",f6:"$0 天後",f7:"終わった",f8:"無効な時間範囲です",f11:"キャッシュをクリアする",f12:"アクティビティを非表示にする",f13:"最終オンライン時間は非公開です",f14:"メッセージの更新を同期する",f15:"変更または削除されたメッセージはすぐに同期されます",f16:"プロモーションや広告コンテンツをブロックする",f17:"正確ではない可能性のあるコンテンツを自動的に識別してブロックします",f20:"設定",f21:"クリアされた",f22:"みんな",f23:"絶対時間表現",f24:"相対法から絶対法へ変わる",f25:"最大24文字。​​実名は推奨されません。",f26:"数字、文字、アンダースコア、ピリオドを含む最大12文字",f27:"最大108文字、オプション",f28:"キャッシュをクリアする（$0）",s1:"現在のバージョン：$0",s2:"開発者：$0",s3:"について",s4:"翻訳する",s5:"翻訳中…",s6:"原文を見る",s7:"もう一度やり直してください",s8:"$0:$1",s9:"一般的に",s10:"実験的な機能",s11:"他の",s12:"翻訳する",s13:"メッセージを削除する",s14:"このメッセージを削除してもよろしいですか? 削除後は復元できません。",s15:"このメッセージを削除",s16:"コンテンツをコピーする",s17:"リンクをコピー",k1:"ヒント",k2:"参加リクエストを送信しました。管理者が承認して参加を許可するまでお待ちください。",k3:"もちろん",k4:"$0 に参加しますか？リクエストが承認されたら参加できます",k5:"キャンセル",k6:"他のメンバーを招待する",k7:"参加するにはこのリンクをクリックしてください。オンラインメンバーは $0 人です",k8:"$0 に参加しますか？",g1:"このアプリケーションを使用するにはPWAのインストールが必要です。具体的なインストール手順は以下のとおりです。",g2:"1. 右上隅の3つの点のボタンをクリックします",g3:"2. 「ホーム画面に追加」オプションを見つけてクリックします",g4:"3. ダイアログボックスの右下にある「参加」ボタンをクリックします。",g5:"1. 画面下部のタブバーの中央にある「共有」ボタンをクリックします。",g6:"2. 下にスクロールして「ホーム画面に追加」ボタンを見つけます",g7:"3. 右上の「参加」をクリックしてインストールを完了します。",g8:"インターフェースの外観",g9:"好みに応じてカラーテーマを自由に変更できます",g10:"クラシック",g11:"二代目",g12:"すべてのキャッシュをクリアしてもよろしいですか？設定がリセットされます。",g13:"ログアウトしてもよろしいですか？ 後で再度ログインできます。"},en:{a1:"Search…",a3:"Enter message here…",a4:"What's new",a5:"Private",a6:"Illustrate",a7:"Public",a10:"Show all",a14:"Submit",a15:"View profile",a16:"Logout",a18:"$0 second(s) ago",a19:"$0 month(s) ago",a20:"$0 minute(s) ago",a21:"$0 hour(s) ago",a22:"$0 years ago",a23:"$0 days ago",a24:"Unable to preview this file",a25:"Download",a26:"You",b1:"Description",b2:"Last online",b3:"Description",b4:"Nickname",b5:"Edit Profile",b6:"Save",b7:"Save",b8:"Welcome back",b9:"Log in to your account to use our services",b10:"Waiting…",b11:"Continue with Google",b12:"Continue with Email",b13:"Return to previous page",b14:"Wrong password, please try again",b15:"The account could not be found. Please try again.",b16:"Network request error, please check the network connection",b17:"An unknown error occurred",b18:"$0 message(s)",b19:"No message",b20:"All members",b21:"View members",b23:"Leave",b24:"Email Address",b25:"Password",b26:"Submit",b27:"Login with Email",b28:"@unknown",b29:"unknown",b30:"The cache has been successfully cleared and will take effect after reloading",b31:"Unknown command, please try again",b32:"Loading…",b33:"Are you sure you want to leave this group? You can rejoin later.",b34:"Leave",b35:"Cancel",b36:"Comfirm",b37:"All itinerary",b38:"Title",b39:"Start",b40:"End",b41:"Edit itinerary",c3:"Updated language: $0",b42:"Uploading",b43:"Uploading, please wait patiently",b44:"Upload interrupted",b45:"Upload canceled",b46:"Upload completed",b47:"The file has been uploaded successfully",b48:"Upload failed",b49:"This file is $0 and we can't afford it",b50:"Dynamics",b51:"No dynamic",b52:"Click here to view",b53:"$0 seconds left, speed $1/s",b54:"Log in to join this group",b55:"Username",d0:"Attach files",d1:"Send",d2:"Select Emoticons",d3:"Mark as important",d4:"Unmark",d5:"Anyone can join this group",d6:"Only invited people can join this group",d7:"Reload to fully update your information",d8:"There are no messages here yet. Start chatting now.",d9:"Unknown",d10:"There is no description yet",d13:"Not joined any group yet",d14:"No itinerary yet",f1:"There's\xa0no\xa0one\xa0here\xa0at\xa0the\xa0moment...",f2:"Today",f3:"Tomorrow",f4:"Yesterday",f5:"$0 days ago",f6:"$0 days later",f7:"Ended",f8:"Invalid\xa0time\xa0range",f11:"Clear cache",f12:"Hide activity",f13:"The last online time will not be disclosed",f14:"Sync message updates",f15:"Messages that are modified or deleted will be synchronized immediately",f16:"Block promotional and advertising content",f17:"Automatically identify and block such content, which may not be accurate",f20:"Settings",f21:"Cleared",f22:"everyone",f23:"Absolute time representation",f24:"Will change from relative law to absolute law",f25:"Maximum 24 characters. Real names are not recommended.",f26:"Maximum 12 characters, including numbers, letters, underscores, and periods",f27:"Maximum 108 characters, optional",f28:"Clear cache ($0)",s1:"Current version: $0",s2:"Developer: $0",s3:"About",s4:"Translate",s5:"Translating…",s6:"View original",s7:"Try again",s8:"$0:$1",s9:"General",s10:"Experimental features",s11:"Others",s12:"Translate",c6:"System notification",c7:"Once enabled, you can receive push notifications",c8:"Automatically adjust sorting",c9:"Sort by frequency of use",c10:"Interface language",c11:"Restart is required to update the language",s13:"Delete message",s14:"Are you sure you want to delete this message? It cannot be restored after deletion.",s15:"Delete this",s16:"Copy content",s17:"Copy link",k1:"Prompt",k2:"You have submitted a request to join. Please wait for the administrator to approve and authorize joining.",k3:"Comfirm",k4:"Do you want to join $0? You can join after your request is authorized",k5:"Cancel",k6:"Invite other members",k7:"Click this link to join, $0 members online",k8:"Do you want to join $0?",g1:"This application requires PWA to be installed. The specific installation steps are as follows:",g2:"1. Click the three-dot button in the upper right corner",g3:'2. Find the "Add to Home Screen" option and click it',g4:'3. Click the "Join" button in the lower right corner of the dialog box',g5:'1. Click the "Share" button in the middle of the tab bar at the bottom',g6:'2. Scroll down to find the "Add to Home Screen" button',g7:'3. Click "Join" in the upper right corner to complete the installation',g8:"Appearance Theme",g9:"You can freely change the color theme according to your preferences",g10:"Classic",g11:"2ND",g12:"Are you sure you want to clear all caches? Settings will be reset.",g13:"Are you sure you want to log out? You can log in again later."},kr:{a1:"찾다…",a3:"여기에 메시지를 입력하세요...",a4:"업데이트된 내용",a5:"사적인",a6:"지침",a7:"공공의",a10:"모두 보기",a14:"보내다",a15:"프로필 보기",a16:"로그아웃",a18:"$0초 전",a19:"$0개월 전",a20:"$0분 전",a21:"$0시간 전",a22:"$0년 전",a23:"$0일 전",a24:"이 문서를 미리 볼 수 없습니다.",a25:"다운로드",a26:"너",b1:"설명하다",b2:"마지막 온라인",b3:"설명하다",b4:"별명",b5:"프로필 편집",b6:"마치다",b7:"마치다",b8:"돌아온 것을 환영합니다",b9:"당사 서비스를 이용하려면 귀하의 계정에 로그인하세요",b10:"대기 중…",b11:"Google로 계속하기",b12:"이메일을 사용하여 로그인",b13:"이전 페이지로 돌아가기",b14:"잘못된 비밀번호입니다. 다시 시도해 주세요.",b15:"이 계정을 찾을 수 없습니다. 다시 시도해 주세요.",b16:"네트워크 요청 오류입니다. 네트워크 연결을 확인해 주세요.",b17:"알 수 없는 오류가 발생했습니다.",b18:"메시지 $0",b19:"메시지 없음",b20:"전원",b21:"모든 회원 보기",b23:"그만두다",b24:"이메일 주소",b25:"비밀번호",b26:"보내다",b27:"이메일 로그인",b28:"@알려지지 않은",b29:"알려지지 않은",b30:"캐시가 성공적으로 지워졌으며 다시 로드하면 적용됩니다.",b31:"알 수 없는 명령입니다. 다시 시도해 주세요.",b32:"로드 중…",b33:"이 채팅방을 나가시겠습니까? 나중에 다시 참여하실 수 있습니다.",b34:"그만두다",b35:"취소",b36:"확신하는",c3:"업데이트된 인터페이스 언어:$0",c6:"시스템 알림",c7:"활성화되면 푸시 알림을 받을 수 있습니다.",c8:"정렬을 자동으로 조정합니다",c9:"사용 빈도에 따라 자동 정렬",c10:"인터페이스 언어",c11:"언어를 업데이트하려면 재시작이 필요합니다.",b42:"업로드 중",b43:"업로드 중입니다. 잠시만 기다려주세요.",b44:"업로드가 중단되었습니다.",b45:"업로드가 취소되었습니다.",b46:"업로드 완료",b47:"파일이 성공적으로 업로드되었습니다.",b48:"업로드 실패",b49:"이 파일의 $0은 우리가 감당할 수 없습니다.",b50:"동적",b51:"아직 소식이 없습니다",b52:"보려면 클릭하세요",b53:"0초 남음, 속도 $1/초",b54:"이 채팅방에 참여하려면 로그인하세요",b55:"사용자 이름",d0:"첨부파일",d1:"보내다",d2:"이모티콘 선택",d3:"중요한 것으로 표시",d4:"표시 해제",d5:"누구나 이 채팅방에 참여할 수 있습니다",d6:"초대받은 사람만 이 채팅방에 참여할 수 있습니다.",d7:"정보를 완전히 업데이트하려면 다시 로드하세요",d8:"아직 메시지가 없습니다. 지금 채팅을 시작하세요.",d9:"未知",d10:"아직 설명이 없습니다",d13:"아직 채팅방에 참여하지 않았습니다",d14:"아직 여행 일정이 없으신가요? 지금 만들어 보세요.",d15:"모든 콘텐츠",f1:"지금은 아무도 없어요... 잠깐, 당신은 인간이 아니죠?",f2:"오늘",f3:"내일",f4:"어제",f5:"$0일 전",f6:"$0일 후",f11:"캐시 지우기",f12:"활동 숨기기",f13:"마지막 온라인 접속 시간은 공개되지 않습니다.",f14:"메시지 업데이트 동기화",f15:"수정되거나 삭제된 메시지는 즉시 동기화됩니다.",f16:"홍보 및 광고 콘텐츠 차단",f17:"정확하지 않을 수 있는 해당 콘텐츠를 자동으로 식별하고 차단합니다.",f20:"설정",f21:"삭제됨",f22:"모든 사람",f23:"절대 시간 표현",f24:"상대적 법칙에서 절대적 법칙으로 변경하면 변조로 인해 시간이 부정확해질 수 있습니다.",f25:"최대 24자까지 입력 가능합니다. 실명은 권장하지 않습니다.",f26:"숫자, 문자, 밑줄, 마침표를 포함하여 최대 12자",f27:"최대 108자, 선택 사항",f28:"캐시 지우기($0)",s1:"현재 버전: $0",s2:"개발자: $0",s3:"~에 대한",s4:"번역하다",s5:"번역 중…",s6:"원문 보기",s7:"다시 시도하세요",s8:"$0:$1",s9:"일반적으로",s10:"실험적 기능",s11:"다른",s12:"번역하다",s13:"메시지 삭제",s14:"이 메시지를 삭제하시겠습니까? 삭제 후에는 복원할 수 없습니다.",s15:"이 메시지 삭제",s16:"콘텐츠 복사",s17:"링크 복사",k1:"힌트",k2:"가입 요청을 제출했습니다. 관리자가 가입을 승인하고 허가할 때까지 기다려 주세요.",k3:"확신하는",k4:"$0에 가입하시겠습니까? 가입 요청을 제출하시면 승인을 받은 후 가입하실 수 있습니다.",k5:"취소",k6:"다른 회원을 초대하세요",k7:"이 링크를 클릭하여 가입하세요. 온라인 회원은 $0입니다.",k8:"$0으로 참여하시겠습니까? 공개 채팅방은 바로 참여 가능합니다.",g1:"이 애플리케이션을 사용하려면 PWA 설치가 필요합니다. 구체적인 설치 단계는 다음과 같습니다.",g2:"1. 오른쪽 상단에 있는 세 개의 점 버튼을 클릭하세요.",g3:'2. "홈 화면에 추가" 옵션을 찾아 클릭합니다.',g4:'3. 대화 상자 오른쪽 하단에 있는 "참여" 버튼을 클릭하세요.',g5:'1. 하단 탭바 중앙에 있는 "공유" 버튼을 클릭하세요.',g6:'2. 아래로 스크롤하여 "홈 화면에 추가" 버튼을 찾으세요.',g7:'3. 오른쪽 상단의 "가입"을 클릭하여 설치를 완료하세요.',g8:"인터페이스 외관",g9:"사용자의 취향에 맞게 색상 테마를 자유롭게 변경 가능합니다.",g10:"권위 있는",g11:"2세대",g12:"모든 캐시를 삭제하시겠습니까? 설정이 초기화됩니다.",g13:"로그아웃하시겠습니까? 나중에 다시 로그인할 수 있습니다."}};function loadTrans(e){return locales[e]}setupSimpleVibratePolyfill();let app=e({apiKey:"AIzaSyAp73V5ZsBUtpy4kS3-QyGirGSpz71DPWo",authDomain:"smiling-theory-397204.firebaseapp.com",databaseURL:"https://smiling-theory-397204-default-rtdb.asia-southeast1.firebasedatabase.app",projectId:"smiling-theory-397204",storageBucket:"smiling-theory-397204.appspot.com",messagingSenderId:"360479398694",appId:"1:360479398694:web:05b7df5ce277f89ea8ffe7",measurementId:"G-6BKTT1K7D1"}),translations=loadTrans(currentLanguage),db=h(app),storage=l(app),provider=new s,auth=t(),mySearchParams=new URLSearchParams(window.location.search),translator=new Translator;u(db).then(()=>{console.log("Offline caching is enabled")}).catch(e=>{"failed-precondition"===e.code?console.error("Persistence failed (multiple tabs without multi-tab sync)"):"unimplemented"===e.code&&console.error("Browser doesn't support persistence")});let isMobileDevice=/(Android|webOS|Windows Phone|iPhone|iPod|iPad)/i.test(window.navigator.platform)||window.innerWidth<550,allGroups=[],components={sidebar:_(".xFz8bwNFr"),main:_(".x8o58HttN"),messageInput:_(".xtsARDHTI"),searchInput:_(".xujXllYgW"),messageContainer:_(".xikyLwDf4"),sendButton:_(".xuwRtDpu4"),fileInput:_(".xVEJA40Qh"),attachButton:_(".xpbRox0hO#xJTcQcZ9E"),stickerButton:_(".xpbRox0hO#xbXZpIWEa"),markButton:_(".xpbRox0hO#xsVrze5YA"),brushButton:_(".xpbRox0hO#xrfvUzMAG"),heading:_(".xehdiGgBv"),backButton:_(".xehdiGgBv .xMyenRl7K .x8JU9DbQZ"),primaryArea:_(".xemr1y6ie"),spinnerContainer:_(".xemr1y6ie .spinner"),spinnerLabel:_(".xemr1y6ie .spinner .xkT2bkntT"),_mb_att_btn:_(".xDADAUUv4"),roomNameLabel:_(".x8o58HttN .xMyenRl7K .xvwhg72ii"),signatureLabel:_(".xlKSJ67AP"),nameLabel:_(".xt4GQkVIo"),avatarLabel:_(".xbVHF6S6B"),avatarWrapper:_(".xaoteDJh4"),profileContainer:_(".xQ6gFUtqT"),layoutResizer:_(".xrFP6D2e1"),layoutResizer2:_(".xZddo7wlf")},spinner_strc=`<svg aria-hidden="true" class="xxA4Cqchz" style="min-width: 20px" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M12 3a9 9 0 1 0 9 9"></path>
							</svg>${translations.b32}`,versionInfo={current:"0.4.9",cacheId:"xln4JZolf",directions:`<ul class="xxmjDL5xB xbH7v2Hbn"><li class="xcKqXW8uF">修復了Drawer容易誤觸關閉的問題。</li><li class="xcKqXW8uF">改進了搜尋功能，優化模糊搜索算法。</li><li class="xcKqXW8uF">重構了部分代碼，分離本地化邏輯。</li>`},allMessages=[],allListener={},userProfileCache={},roomDataCache={},pageSize=20,chatPrompt,initialized=!1,currentRoom="",lastDoc,unreadCount=0,userId,isScrollEventActive=!1,contextOpened=!1,markingState=!1,myStickerSelector,messagesCF=components.messageContainer,useAbsTime;function updateParams(){useAbsTime=myStorage.get("STG-71b4e340-577f-4b7b-aead-6958f2b19aa1")}let userPSCState={state:!1,_a:null,_b:null,_c:null,_k:!1,_d:"",_f:"",_n:"",_d:"",_m:[]},lastMessageInfo="",activingView=null;if(isMobileDevice){document.body.classList.add("mobile"),components._mb_att_btn.bindWithCooldown(function(){navigator.vibrate(30),components.fileInput.click()});let M=!1,T=0,I=0,R=0,A=0,P=e=>{M=!0,I=0,T=Date.now(),A=(R=e.touches?e.touches[0].clientX:e.clientX)-e.target.getBoundingClientRect().left,document.addEventListener("mousemove",z),document.addEventListener("mouseup",W),document.addEventListener("touchmove",z,{passive:!0}),document.addEventListener("touchend",W)},z=e=>{if(!M)return;let t=(e.touches?e.touches[0].clientX:e.clientX)-A,n=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;I=t,components.main.classList.add("xp4HXkJGa"),components.sidebar.classList.add("xgu6pGjzk"),components.main.style.transform=`translate3d(${Math.max(Math.min(t,n),0)}px, 0, 0)`,components.sidebar.style.transform=`translate3d(${Math.max(Math.min(-30*(1-t/n),0),-30)}%, 0, 0)`},W=()=>{if(!M)return;M=!1;let e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;components.main.classList.remove("xp4HXkJGa"),components.sidebar.classList.remove("xgu6pGjzk"),document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",W),document.removeEventListener("touchmove",z,{passive:!0}),document.removeEventListener("touchend",W);let t=(I-R)/((Date.now()-T)/1e3),n=e;(I/e>.5||t>n)&&back()};window.addEventListener("blur",()=>{M=!1,components.main.classList.remove("xp4HXkJGa"),components.sidebar.classList.remove("xgu6pGjzk"),document.removeEventListener("mousemove",z),document.removeEventListener("mouseup",W),document.removeEventListener("touchmove",z,{passive:!0}),document.removeEventListener("touchend",W)}),components.layoutResizer2.addEventListener("mousedown",e=>{P(e)}),components.layoutResizer2.addEventListener("touchstart",P,{passive:!0})}else{document.body.classList.add("desktop"),new MyTooltip({parent:components.attachButton,text:translations.d0,placement:"top"}),components.attachButton.bindWithCooldown(function(){components.fileInput.click()}),new MyTooltip({parent:components.sendButton,text:translations.d1,placement:"top"}),new MyTooltip({parent:components.stickerButton,text:translations.d2,placement:"top"});let B=new MyTooltip({parent:components.markButton,text:translations.d3,placement:"top"});new MyTooltip({parent:components.brushButton,text:"潤色文本",placement:"top"}),bindMenuNavigation([components.attachButton,components.brushButton,components.markButton,components.stickerButton,],"horizontal"),components.stickerButton.bindWithCooldown(function(){myStickerSelector?(myStickerSelector.destroy(),myStickerSelector=null):myStickerSelector=stickerSelector({right:"48px",bottom:"48px"})},0),components.brushButton.bindWithCooldown(function(){let e=HeadingDialog("潤色文本",!0);e.content.classList.add("lg"),e.body.classList.add("xDLwiKdTE")}),components.markButton.bindWithCooldown(function(){markingState?(markingState=!1,components.markButton.classList.remove("x3zdxRXQ6"),B.setText(translations.d3)):(markingState=!0,components.markButton.classList.add("x3zdxRXQ6"),B.setText(translations.d4))},0);let H=!1,F=0,O=0,Y=e=>{H=!0,document.body.classList.add("xz7kq9zLe");let t=e.target.getBoundingClientRect();O=e.clientX-t.left,document.addEventListener("mousemove",U),document.addEventListener("mouseup",X)},U=e=>{if(!H)return;let t=components.sidebar.getBoundingClientRect().left,n=Math.max(e.clientX-t-O,0);F=n,components.sidebar.style.width=n+"px"},X=()=>{H=!1,myStorage.set("xjS4MkN99",F),document.body.classList.remove("xz7kq9zLe"),document.removeEventListener("mousemove",U),document.removeEventListener("mouseup",X)};window.addEventListener("blur",()=>{document.body.classList.remove("xz7kq9zLe"),H=!1}),components.layoutResizer.addEventListener("mousedown",e=>{Y(e)})}function updateProperties(){let e=components.messageContainer.getBoundingClientRect();components.messageContainer.style.setProperty("--x9LFHiVqv",`${Number((.6*e.height-24).toFixed(2))}px`),components.messageContainer.style.setProperty("--xVizV2ybq",`${Number((.72*e.height).toFixed(2))-24}px`)}function HeadingDialog(e,t=!1,...n){console.log(n);let s=new MyDialog({closeOnEsc:!0,closeOnOverlayClick:!0,excludeElements:n}),a=ec("xrYn5ZY3v");a.classList.add("lf"),s.Content.style.padding="0";let i=ec("x6Y89FynP");a.appendChild(i),i.innerText=e,s.Content.appendChild(a);let o=ec("xWDUelLWA");s.Content.appendChild(o);let l;t&&((l=ec("xvb5soWNa")).focusable(!0),l.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',s.close=s.close.bind(s),l.bindWithCooldown(s.close),a.appendChild(l));let r=a.getBoundingClientRect();return a.style.minHeight=r.height+"px",{root:s,body:o,content:s.Content,closebtn:l,Root:s.Root,Overlay:s.Overlay,Content:s.Content}}async function parseMessageContent(e,t,n=!1){let s=[],a=t.content,i,o=!1,l="";if(t.content.startsWith("<")){let r=t.content.match(/<\s*(\S+)\s+(\S+)(?:\s+(\S+))?/),c=r[1],d=r[2],h=r[3];if("image"===c){s.push("image-link"),l=d;let u=document.createElement("img");u.focusable(!0),u.classList.add("xGsec9lFd"),u.classList.add("xUSR4cuWD"),u.setAttribute("data-state","loading"),u.loading="lazy",u.onerror=function(){u.setAttribute("data-state","failed"),u.classList.remove("xUSR4cuWD")},h&&(h<1?u.style.height="9999px":u.style.width="9999px",u.style.aspectRatio=`${h} / 1`),u.onload=function(){u.setAttribute("data-state","loaded"),u.classList.remove("xUSR4cuWD"),e.content.classList.add("xFIqZCKV3");let t=!1;u.bindWithCooldown(function(){if(t)return;t=!0;let e=new MyDialog({closeOnEsc:!0,closeOnOverlayClick:!0});e.Content.classList.add("xPSnkbRat");let n=document.createElement("canvas");n.classList.add("xWuhDLG1C"),e.Content.appendChild(n);let s=new ImageViewer(n,{maxScale:2,onClickOutside(e,t){a(e,t)}});function a(){s.destroy(),e.close(),t=!1}e.onClose(function(){s.destroy(),t=!1}),s.loadImage(d);let i=ec("x8o1OSu71");i.focusable(!0),i.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',i.bindWithCooldown(a),e.Content.appendChild(i);let o=ec("x8o1OSu71");o.classList.add("xHZuqwWhI"),o.focusable(!0),o.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19.95 11a8 8 0 1 0 -.5 4m.5 5v-5h-5" /></svg>',bindMenuNavigation([i,o],"horizontal"),o.bindWithCooldown(function(){s.rotate()},0),e.Content.appendChild(o)},0)},navigator.serviceWorker?.controller?.postMessage({action:"cache-url",url:d}),u.src=d,e.content.appendChild(u)}else if("video"===c){let p=document.createElement("video");p.setAttribute("muted",""),p.focusable(!0),p.playsInline=!0,p.setAttribute("controls","false"),p.setAttribute("controlslist","nodownload"),navigator.serviceWorker?.controller?.postMessage({action:"cache-url",url:d}),p.src=d,p.classList.add("xGsec9lFd"),e.content.appendChild(p)}else if("audio"===c){let m=document.createElement("audio");m.focusable(!0),m.setAttribute("controls","true"),navigator.serviceWorker?.controller?.postMessage({action:"cache-url",url:d}),m.src=d,m.classList.add("xGsec9lFd"),e.content.appendChild(m)}else"custom"===c?e.content.innerHTML=t.data||translations.d9:e.content.innerHTML=`<div class="xUiYNFhtR">${translations.a24} <a class="x0ciSQShX no-wrap" href="${d}" target="_blank" rel="noreferrer noopener">${translations.a25}</a></div>`}else(i=document.createElement("span")).classList.add("xVlceg4Ab"),renderTextWithMentions(i,t.content),e.content.appendChild(i),s.push("copy"),i.getBoundingClientRect().height>125&&(e.content.classList.add("xDVzL7FIt"),s.push("show-all"));function b(){let t=new MyPopover({trigger:e.content,placement:["bottom-start","bottom-end","top-start","top-end"]}),n=bindMenuNavigation([],"vertical");t.onClose(function(){openedMenu=!1}),t.Overlay.classList.add("xOjXmYkxE"),s.forEach(s=>{if("divider"===s){let i=ec("xcoXgMpFW");i.setAttribute("role","separator"),t.Content.appendChild(i)}else if("copy"===s){let r=ec("xrQdSHI2A");r.focusable(!0),r.innerHTML=`${platformIcons.copy}${translations.s16}`,r.bindWithCooldown(async function(){t.close(),await navigator.clipboard.writeText(a)}),n.addItem(r),t.Content.appendChild(r)}else if("image-link"===s){let c=ec("xrQdSHI2A");c.focusable(!0),c.innerHTML=`<svg style="min-width: 24px;" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M9 15l6 -6" /><path d="M11 6l.463 -.536a5 5 0 0 1 7.071 7.072l-.534 .464" /><path d="M13 18l-.397 .534a5.068 5.068 0 0 1 -7.127 0a4.972 4.972 0 0 1 0 -7.071l.524 -.463" /></svg>${translations.s17}`,c.bindWithCooldown(async function(){t.close(),await navigator.clipboard.writeText(l)}),n.addItem(c),t.Content.appendChild(c)}else if("show-all"===s){let d=ec("xrQdSHI2A");d.focusable(!0),d.innerHTML=`<svg style="min-width: 24px;" aria-hidden="true" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M4 6l16 0" /><path d="M4 18l5 0" /><path d="M4 12h13a3 3 0 0 1 0 6h-4l2 -2m0 4l-2 -2" /></svg>${translations.a10}`,d.bindWithCooldown(function(){if(t.close(),isMobileDevice){let e=new MyDrawer({closeOnEsc:!0,closeOnOverlayClick:!0});e.Root.classList.add("xAQPbc7N3");let n=ec("xBWmlKrN2");e.Body.appendChild(n),renderTextWithMentions(n,a)}else{let s=HeadingDialog(translations.d15,!0);s.Content.classList.add("xb4MnocjO"),s.Content.classList.add("lg");let i=ec("xBWmlKrN2");s.body.appendChild(i),renderTextWithMentions(i,a)}}),n.addItem(d),t.Content.appendChild(d)}else if("delete"===s){let h=ec("xrQdSHI2A");h.classList.add("xGy5QqsmI"),h.focusable(!0),h.innerHTML=`${platformIcons.trash}${translations.s15}`,h.bindWithCooldown(function(){if(t.close(),allMessages.includes(e.id))new AlertDialog({title:translations.s13,message:translations.s14,closeOnEsc:!0,closeOnOverlayClick:!0,buttons:[{text:translations.b36,classList:["xTJA9U7y9"],onClick:async function(){await $(g(db,"chats",currentRoom,"messages",e.id)),o=!0}},{text:translations.b35},]}).Overlay.classList.add("xOjXmYkxE");else try{e.root.classList.add("xl4gtQk5f"),o=!0,setTimeout(function(){e.root.remove()},3e3)}catch(n){console.log("Unable to delete element")}}),n.addItem(h),t.Content.appendChild(h)}}),t._setPosition()}t.sender===userId&&(0!==s.length&&s.push("divider"),s.push("delete")),n&&0!==s.length&&(isMobileDevice?addLongPressListener(e.content,function(){openedMenu||o||(navigator.vibrate(30),openedMenu=!0,b())}):e.root.addEventListener("contextmenu",function(e){openedMenu||o||(e.preventDefault(),openedMenu=!0,b())}))}async function renderTextWithMentions(e,t){let n=/@(\w+)/g,s=0,a;for(e.clear();null!==(a=n.exec(t));){let{index:i}=a,o=a[1];i>s&&appendTextWithUrlsAndLineBreaks(e,t.slice(s,i));let l=document.createElement("a");l.classList.add("x0ciSQShX"),l.focusable(!0),l.dataset.userId=o,userPSCState._m.push({userId:o,dom:l}),"everyone"===o?l.textContent=`@${translations.f22}`:getUserProfile2(o).then(function(e){e?(l.textContent=`@${e.name||translations.b29}`,l.bindWithCooldown(function(){userInfoShowCase(activingView,{data:e,type:isMobileDevice?"mobile":"desktop"})},0)):l.textContent=translations.b28}).catch(function(e){l.textContent=`@${o}`,console.log("Unable to load nickname for this user",e)}),e.appendChild(l),s=n.lastIndex}s<t.length&&appendTextWithUrlsAndLineBreaks(e,t.slice(s))}function appendTextWithUrlsAndLineBreaks(e,t){let n=t.split("\n");n.forEach((t,s)=>{if(t){let a=replaceUrlsWithLinks(t),i=document.createElement("div");i.innerHTML=a,Array.from(i.childNodes).forEach(t=>{e.appendChild(t)})}s<n.length-1&&e.appendChild(document.createElement("br"))})}function replaceUrlsWithLinks(e){return e.replace(/https?:\/\/[^\s/$.?#].[^\s]*/g,function(e){let t=e.replace(/^https?:\/\//,"");return'<span class="xCe4Btdzm"><a class="x0ciSQShX" translate="no" href="'+e+'" target="_blank" rel="noreferrer noopener">'+decodeURIComponent(t)+"</a></span>"})}window.addEventListener("resize",updateProperties);let allCommands={};function registerCommand(e,t){if(allCommands[e])throw Error("This command has already been registered");if("string"!=typeof e||!/^[A-Za-z0-9]+$/.test(e)||"function"!=typeof t)throw Error("Parameter format error");allCommands[e]=function(e){t({displaySentMessage:function(e,t="0"){displaySentMessage({content:e,sender:userId,tag:t},generateRandomString(20),"3")},displayReceivedMessage:function(e,t,n,s="0"){displayReceivedMessage({content:e,sender:t,timestamp:n,tag:s},generateRandomString(20),"3")},components:components,inputParams:e.replace(/ {2,}/g," ").split(" "),generateRandomString:generateRandomString,getUserProfile:getUserProfile,currentRoomId:currentRoom,currentUserId:userId,allMessages:allMessages,currentLanguage:currentLanguage})},console.log(`New command successfully registered: ${e}`)}async function checkImageUrl(e){try{let t=await fetch(e,{method:"HEAD"});if(!t.ok)return{ok:!1,status:t.status,reason:"Request failed"};if(!(t.headers.get("content-type")||"").startsWith("image/"))return{ok:!1,status:t.status,reason:"Not an image resource"};return{ok:!0,status:t.status}}catch(n){return{ok:!1,status:null,reason:n.message}}}async function handleSendMessage(){let e=components.messageInput.innerText.trim();if(!e||!currentRoom||""===e)return;components.sendButton.classList.add("disabled"),components.sendButton.focusable(!1),components.messageInput.clear();let t=e.match(/^\/(\w+)\s*(.*)/);if(t){let n=t[1],s=t[2];if(allCommands[n]){allCommands[n](s);return}components.messageInput.clear(),displaySentMessage({tag:"3",sender:userId,content:translations.b31},generateRandomString(20),"3");return}e=e.replace(/&([^;]+)/g,"&amp;$1").replaceAll("<","&lt;").replaceAll(">","&gt;").replace(/\.\.\./g,"…").replace(/(\r?\n){3,}/g,"\n\n"),components.messageInput.clear();let a=markingState?"1":null;components.markButton.classList.remove("x3zdxRXQ6"),markingState=!1;let i=g(p(db,"chats",currentRoom,"messages"));allMessages.push(i.id),await m(i,{sender:userId,content:e,timestamp2:S(),timestamp:Date.now(),tag:a}),displaySentMessage({content:e,tag:a,sender:userId},i.id,"3"),lastMessageInfo={sender:userId}}window.allCommands=allCommands,registerCommand("1145",function(e){let t=e.inputParams[0];try{checkImageUrl(t).then(async t=>{t.ok?(await updateUserProfile(userId,{avatarUrl:e.inputParams[0]}),e.displaySentMessage("The avatar has been changed successfully, refresh to update","1")):e.displaySentMessage(`Image not available: ${t.reason||t.status}`,"3")})}catch(n){e.displaySentMessage(`An unknown error occurred: ${n}`,"3")}}),registerCommand("1146",async function(e){let t=e.inputParams[0];try{checkImageUrl(t).then(async t=>{t.ok?(await updateUserProfile(userId,{bannerUrl:e.inputParams[0]}),e.displaySentMessage("The banner has been changed successfully, refresh to update","1")):e.displaySentMessage(`Image not available: ${t.reason||t.status}`,"3")})}catch(n){e.displaySentMessage(`An unknown error occurred: ${n}`,"3")}}),window.registerCommand=registerCommand;let totalHeight=0,openedMenu=!1;function displaySentMessage(e,t,n="1"){let s=ec("xVC8gtuyS"),a=ec("xMyW2iRSH"),i=ec("xKljxgVJA"),o=ec("xu4Celbbq"),l=ec("xc4iCj2Gy"),r=ec("xRHoYYwoZ");switch(s.setAttribute("data-visible","true"),s.setAttribute("data-message-id",t),s.classList.add("xiOw4dg0O"),s.appendChild(i),i.appendChild(r),r.appendChild(o),o.appendChild(l),r.appendChild(a),l.innerText=translations.a26,lastMessageInfo.sender===userId&&s.classList.add("xOmVIOA3e"),"1"===e.tag?a.classList.add("x4rKxFxLl"):"2"===e.tag?a.classList.add("xHJfZfjT1"):"3"===e.tag&&a.classList.add("xPETmaR5q"),chatPrompt&&(chatPrompt.remove(),chatPrompt=null),n){case"1":components.messageContainer.appendChild(s);break;case"2":messagesCF.appendChild(s),totalHeight+=s.offsetHeight;break;case"3":components.messageContainer.appendChild(s),isScrollEventActive=!0,components.messageContainer.scrollTo({top:components.messageContainer.scrollHeight,behavior:"smooth"}),isScrollEventActive=!1}parseMessageContent({content:a,root:s,id:t},e,!0)}function displayReceivedMessage(e,t,n="1"){let s=ec("xVC8gtuyS"),a=ec("xMyW2iRSH"),i=ec("xSYcbYqTG"),o=ec("xKljxgVJA"),l=ec("xu4Celbbq"),r=ec("xc4iCj2Gy"),c=ec("xt8fROB2L"),d=ec("xRHoYYwoZ"),h=document.createElement("img");switch(s.setAttribute("data-visible","true"),c.classList.add("xt8fROB2L"),h.loading="lazy",s.appendChild(i),s.appendChild(o),o.appendChild(d),d.appendChild(l),l.appendChild(r),d.appendChild(a),l.appendChild(c),i.appendChild(h),s.setAttribute("data-message-id",t),"1"===e.tag&&a.classList.add("x4rKxFxLl"),useAbsTime?c.innerText="2001/9/11 8:46":c.innerText=translations.a18.replace("$0","0"),r.innerText=translations.d9,h.draggable=!1,chatPrompt&&(chatPrompt.remove(),chatPrompt=null),lastMessageInfo.sender===e.sender&&s.classList.add("xOmVIOA3e"),n){case"1":components.messageContainer.appendChild(s);break;case"2":messagesCF.appendChild(s),totalHeight+=s.offsetHeight;break;case"3":components.messageContainer.appendChild(s),isScrollEventActive=!0,components.messageContainer.scrollTo({top:components.messageContainer.scrollHeight,behavior:"smooth"}),isScrollEventActive=!1}function u(){c.innerText=timeAgo(e.timestamp)}parseMessageContent({content:a,root:s,id:t},e,!0);let p=lastMessageInfo.sender;getUserProfile(e.sender).then(n=>{function s(){userInfoShowCase(components.main,{data:n,type:isMobileDevice?"mobile":"desktop"})}p!==e.sender&&(useAbsTime?c.innerText=absTime(e.timestamp):(u(),updateHandlers[t]=u)),h.src=n.avatarUrl||"/assets/avatar.png",h.onload=function(){i.classList.add("xWzeTGC6P")},r.onclick=s,i.focusable(!0),i.bindWithCooldown(s),r.innerText=n.name||translations.d9}).catch(e=>{console.error(e)})}function updateApp(e,t,n){components.signatureLabel.textContent=n||"unknown",components.avatarWrapper.classList.remove("xJd2GT7MI"),components.avatarLabel.src=e||"assets/avatar.png",components.nameLabel.textContent=t||translations.d9}let loadInterval,intervalWorks={},updateHandlers={};async function initialize(){if(initialized)return;console.log("Initializing application"),components.roomNameLabel.innerText=translations.d9,components.searchInput.placeholder=translations.a1,components.messageInput.setAttribute("placeholder",translations.a3),components.spinnerLabel.innerText=translations.b32,components.nameLabel.innerText=translations.d9,components.signatureLabel.innerText=translations.d9,document.body.setAttribute("theme",myStorage.get("globalTheme","default"));let e=myStorage.get("xjS4MkN99");e&&!isMobileDevice&&(components.sidebar.style.width=e+"px"),document.body.classList.add("xmKH3ad5R");let t=detectDeviceOS(),n=getScreenInfo();loadAllChatRoom(),updateParams();try{getUserProfile(userId).then(async e=>{(!e.deviceInfo||Date.now()-e.deviceInfo.lastUpdate>6e5)&&(await updateUserProfile(userId,{deviceInfo:{lastUpdate2:S(),lastUpdate:Date.now(),os:`${t.os} ${t.version}`,screen:`${n.screenWidth}x${n.screenHeight} @${n.devicePixelRatio}x`}}),console.log("Device information uploaded"))})}catch(s){console.error("An unknown error occurred",s)}updateProperties(),loadInterval=setInterval(function(){tryToLoad(),updateProperties(),Object.values(intervalWorks).forEach(e=>{e()}),Object.values(updateHandlers).forEach(e=>{e()}),document.body.classList.contains("xYIbDcl9T")&&document.activeElement!==components.messageInput&&document.body.classList.remove("xYIbDcl9T")},1e3),components.searchInput.removeAttribute("disabled"),components.searchInput.focusable(!0),components.profileContainer.classList.remove("disabled"),components.profileContainer.focusable(!0),localStorage.getItem("cvs")===versionInfo.current||mySearchParams.get("j")||(isMobileDevice?new MyDrawer({closeOnEsc:!0,closeOnOverlayClick:!0}).Body.innerHTML=`<div class="xa6f2dQXX">${translations.a4}</div><div class="x68JrA5Ak">${versionInfo.directions}</div>`:HeadingDialog(translations.a4,!0).body.innerHTML=`<div class="xeUKJgV96">${versionInfo.directions}</div>`,localStorage.setItem("cvs",versionInfo.current)),navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"reset-unread"}),initialized=!0}let install_prompt={Android:{title:translations.k1,steps:[translations.g1,translations.g2,translations.g3,translations.g4,]},iOS:{title:translations.k1,steps:[translations.g1,translations.g5,translations.g6,translations.g7,]}};function PromptInstall(){let e=detectDeviceOS();if(!isPWA()&&"Mobile"===e.deviceType){let t=new MyDialog({closeOnEsc:!1,closeOnOverlayClick:!1}),n=install_prompt[e.os];t.Content.innerHTML=`
			<div class="xvbgHUJac">${n.title}</div>
			<div class="xyQxDo8tZ">
			<div class="xRIEdIdxf">${n.steps[0]}</div>
			<div class="xRIEdIdxf">${n.steps[1]}</div>
			<div class="xRIEdIdxf">${n.steps[2]}</div>
			<div class="xRIEdIdxf">${n.steps[3]}</div>
		</div>`}}function escapeHTML(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/ /g,"&nbsp;").replace(/\n/g,"<br>")}function formatNumberWithCommas(e){return e.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",")}let titleTemplete="Structure";function createChatRoom(e){var t;let n=ec("x2fP9fkxS"),s=ec("xQ65c0Nkc"),a=ec("xybvM5cRF"),i=ec("xT3Ta8vKw"),o=ec("x6HyfOZS7"),l=ec("xQkxrD9ZA");async function r(){if(currentRoom!==e.id||isMobileDevice&&!contextOpened){components.messageInput.innerHTML="",Object.keys(updateHandlers).forEach(e=>delete updateHandlers[e]),currentRoom=e.id,userPSCState._m.length=0,activingView=components.main,contextOpened=!0,lastDoc=null,updateParams(),PromptInstall(),isMobileDevice&&components.sidebar.setAttribute("inert","true"),lastMessageInfo="",titleTemplete=`${e.name||translations.d9} - Structure`,document.title=titleTemplete,components.roomNameLabel.innerText=e.name,allMessages.length=0;let t=new URLSearchParams(window.location.search);t.set("r",e.id),window.history.replaceState({},"","?"+t.toString()),components.messageContainer.classList.remove("xVjpzmyej"),components.fileInput.removeAttribute("disabled"),components.attachButton.classList.remove("disabled"),components.attachButton.focusable(!0),components.stickerButton.classList.remove("disabled"),components.stickerButton.focusable(!0),components.markButton.classList.remove("disabled"),components.markButton.focusable(!0),components.markButton.classList.remove("x3zdxRXQ6"),markingState=!1,components.brushButton.classList.remove("disabled"),components.brushButton.focusable(!0),components.messageInput.setAttribute("contenteditable","true"),isMobileDevice?(components._mb_att_btn.classList.remove("disabled"),components._mb_att_btn.focusable(!0),components.backButton.classList.remove("disabled"),components.backButton.focusable(!0),components.main.classList.add("x8VAGH6N2")):(_(".x2fP9fkxS.active")&&_(".x2fP9fkxS.active").classList.remove("active"),n.classList.add("active")),components.messageInput.setAttribute("contenteditable","true"),components.messageInput.focusable(!0),components.messageContainer.clear(),(chatPrompt=ec("xqBX9i6rZ")).classList.add("spinner"),chatPrompt.innerHTML=spinner_strc,components.messageContainer.appendChild(chatPrompt);let s=await v(y(p(db,"chats",e.id,"messages"),w("timestamp","desc"),E(20)));lastDoc=s.docs[19];let a=[];s.forEach(e=>{a.push(e)}),0===a.length&&chatPrompt&&(chatPrompt.innerHTML=translations.d8),a.reverse(),a.map(e=>{var t=e.data();-1===allMessages.indexOf(e.id)&&(t.sender===userId?(allMessages.push(e.id),displaySentMessage(t,e.id,"3")):(allMessages.push(e.id),displayReceivedMessage(t,e.id,"3")),lastMessageInfo=t)}),isScrollEventActive=!0,components.messageContainer.scrollTo({top:components.messageContainer.scrollHeight,behavior:"instant"}),isScrollEventActive=!1,createListener(e.id)}}n.bindWithCooldown(r),allGroups.push({id:e.id,length:e.size,name:e.name||translations.d9,launch:r,dom:n}),n.appendChild(s),n.appendChild(o),o.appendChild(l);let c=function(){let t=new MyPopover({trigger:l,placement:["bottom-start","bottom-end","top-start","top-end"]});t.Content.classList.add("xoV8hdbgt");let s=ec("xrQdSHI2A"),a=ec("xcoXgMpFW"),i=ec("xrQdSHI2A");a.setAttribute("role","separator"),s.bindWithCooldown(function(){t.close();let n=ec("xPAY7PmDq"),s;isMobileDevice?((s=new NavigationView({parent:components.sidebar,title:translations.b20})).Content.classList.add("xU2hUavXh"),s.Content.appendChild(n)):((s=HeadingDialog(translations.b20,!0)).content.classList.add("lg"),s.content.classList.add("xb4MnocjO"),s.body.appendChild(n)),e.members.map(e=>(function e(t){getUserProfile(t).then(e=>{let t=ec("xScefCkPw"),a=ec("xZHdsOFDz"),i=document.createElement("img");i.classList.add("xxnnTDIPC"),i.src=e.avatarUrl||"assets/avatar.png",i.draggable=!1,i.loading="lazy",navigator.serviceWorker?.controller?.postMessage({action:"cache-url",url:e.avatarUrl}),a.appendChild(i);let o=ec("xs8tjkwHJ"),l=ec("xt4GQkVIo"),r=ec("xlKSJ67AP");l.innerText=e.name,r.innerText=e.qid||e.id,t.focusable(!0),o.appendChild(l),o.appendChild(r),t.appendChild(a),t.appendChild(o),t.bindWithCooldown(function(){isMobileDevice?userInfoShowCase(s.Root,{data:e,type:"mobile"}):(s.root.close(),userInfoShowCase(components.main,{data:e,type:"desktop"}))}),n.appendChild(t)}).catch(e=>{console.error(e)})})(e))}),s.innerHTML=`<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"  fill="none"  stroke="currentColor" stroke-width="2" stroke-linecap="round"  stroke-linejoin="round"><path d="M9 7m-4 0a4 4 0 1 0 8 0a4 4 0 1 0 -8 0" /><path d="M3 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /><path d="M21 21v-2a4 4 0 0 0 -3 -3.85" /></svg>${translations.b21}`,[s,i].forEach(e=>{e.focusable(!0)}),i.bindWithCooldown(function(){t.close(),new AlertDialog({closeOnEsc:!0,closeOnOverlayClick:!0,title:translations.b34,message:translations.b33,buttons:[{text:translations.b36,classList:["xTJA9U7y9"],onClick:async function(){let t=allGroups.findIndex(t=>t.id===e.id);if(-1!==t)try{await D(g(db,"users",userId),{joined:L(e.id)}),await D(g(db,"chats",e.id),{members:L(userId)}),allGroups.splice(t,1),n.remove(),currentRoom===e.id&&(currentRoom="",components.roomNameLabel.innerText=translations.d9,components.messageContainer.clear()),0===allGroups.length&&(components.primaryArea.innerHTML=`<div class="xzF3bjGCc">${translations.d13}</div>`)}catch(s){console.error("Error while deleting item:",s)}}},{text:translations.b35,classList:["A5o980bj"]},]})}),t.Content.appendChild(s),t.Content.appendChild(a),i.innerHTML=`<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M13 12v.01" /><path d="M3 21h18" /><path d="M5 21v-16a2 2 0 0 1 2 -2h7.5m2.5 10.5v7.5" /><path d="M14 7h7m-3 -3l3 3l-3 3" /></svg>${translations.b23}`,i.classList.add("xGy5QqsmI"),t.Content.appendChild(i),bindMenuNavigation([s,i]),t._setPosition()};l.bindWithCooldown(function(e){e.stopPropagation();try{navigator.vibrate(30)}catch(t){console.log(t)}c()}),l.focusable(!0),n.focusable(!0),l.innerHTML='<svg aria-hidden="true" style="min-width: 20px;" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>',s.appendChild(a),a.innerText=e.name||translations.d9,t=e.description?e.description:0===e.size?translations.b19:translations.b18.replace("$0",formatNumberWithCommas(e.size)),i.innerText=t,s.appendChild(i),components.primaryArea.appendChild(n),e.focus&&(r(),n.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"}))}function absTime(e){let t=new Date(e);return t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+" "+t.getHours().toString()+":"+t.getMinutes().toString().padStart(2,"0")}function timeAgo(e){let t=Math.max(Math.floor((Date.now()-e)/1e3),0);return t<60?translations.a18.replace("$0",t):t<3600?translations.a20.replace("$0",Math.floor(t/60)):t<86400?translations.a21.replace("$0",Math.floor(t/3600)):t<2592e3?translations.a23.replace("$0",Math.floor(t/86400)):t<31536e3?translations.a19.replace("$0",Math.floor(t/2592e3)):translations.a22.replace("$0",formatNumberWithCommas(Math.floor(t/31536e3)))}function formatFileSize(e){let t=["B","KB","MB","GB","TB","PB"],n=e,s=0;for(;n>=1024&&s<t.length-1;)n/=1024,s++;return`${n.toFixed(2)} ${t[s]}`}async function updateUserProfile(e,t){try{let n=g(db,"users",e);if(t){await D(n,t),userProfileCache[e]&&(userProfileCache[e]={...userProfileCache[e],...t});let s=sessionStorage.getItem(`upf_${e}`);if(s){let a={...JSON.parse(s),...t};sessionStorage.setItem(`upf_${e}`,JSON.stringify(a))}}else delete userProfileCache[e],sessionStorage.removeItem(`upf_${e}`);return!0}catch(i){return console.error("Failed to update user profile:",i),!1}}async function getUserProfile(e){if(userProfileCache[e])return userProfileCache[e];let t=sessionStorage.getItem(`upf_${e}`);if(t){let n=JSON.parse(t);return userProfileCache[e]=n,n}try{let s=await b(g(db,"users",e));if(!s.exists())return null;{let a=s.data();return userProfileCache[e]=a,sessionStorage.setItem(`upf_${e}`,JSON.stringify(a)),a}}catch(i){throw i}}async function getUserProfile2(e){if(userProfileCache[e])return userProfileCache[e];let t=sessionStorage.getItem(`upg_${e}`);if(t){let n=JSON.parse(t);return userProfileCache[e]=n,n}try{let s=await v(y(p(db,"users"),f("qid","==",e)));if(s.empty)return null;{let a=s.docs[0],i=a.data();return userProfileCache[a.id]&&(userProfileCache[a.id]=i),userProfileCache[e]=i,sessionStorage.setItem(`upf_${a.id}`,JSON.stringify(i)),sessionStorage.setItem(`upg_${e}`,JSON.stringify(i)),i}}catch(o){throw o}}async function getRoomData(e){if(roomDataCache[e])return roomDataCache[e];let t=sessionStorage.getItem(`rpf_${e}`);if(t){let n=JSON.parse(t);return roomDataCache[e]=n,n}try{let s=await b(g(db,"chats",e));if(!s.exists())return null;{let a=s.data();return userProfileCache[e]=a,sessionStorage.setItem(`rpf_${e}`,JSON.stringify(a)),a}}catch(i){throw i}}async function loadMessages(e,t){if(void 0!==lastDoc){isScrollEventActive=!0;let n=await v(y(p(db,"chats",e,"messages"),w("timestamp","desc"),x(lastDoc),E(20)));if(console.log(`${n.docs.length} messages left`),0===n.docs.length)return;lastDoc=20===n.docs.length?n.docs[19]:null;let s=[];n.forEach(e=>{s.push(e)}),s.reverse();let a=0;messagesCF=ec("xWIHJooz8"),lastMessageInfo="";let i=components.messageContainer.firstChild;components.messageContainer.insertBefore(messagesCF,i);let o=components.messageContainer.scrollHeight;s.map(e=>{a++;let t=e.data();-1===allMessages.indexOf(e.id)&&(t.sender===userId?(allMessages.push(e.id),displaySentMessage(t,e.id,"2")):(allMessages.push(e.id),displayReceivedMessage(t,e.id,"2")),lastMessageInfo=t)}),isScrollEventActive=!0,totalHeight=components.messageContainer.scrollHeight-o,components.messageContainer.scrollTo({top:totalHeight,left:0,behavior:"instant"}),totalHeight=0,setTimeout(function(){isScrollEventActive=!1},200)}else isScrollEventActive=!1}let messageTemplete='.xikyLwDf4 .xVC8gtuyS[data-message-id="{sid}"]';function createListener(e){if(allListener[e]){console.log(`Listener for ${e} already exists.`);return}let t=C(p(db,"chats",e,"messages"),t=>{let n=t.docChanges();n.forEach(t=>{if(currentRoom!==e||n.length>=20)return;let s=t.doc.data();switch(t.type){case"added":-1!==allMessages.indexOf(t.doc.id)||t.doc.metadata.fromCache||("hidden"===document.visibilityState&&(unreadCount++,document.title=`(${unreadCount}) ${titleTemplete}`),allMessages.push(t.doc.id),s.sender===userId?displaySentMessage(s,t.doc.id,"3"):displayReceivedMessage(s,t.doc.id,"3"),lastMessageInfo=t.doc.id);break;case"removed":let a=_(messageTemplete.replace("{sid}",t.doc.id));try{a.classList.add("xl4gtQk5f"),updateHandlers[t.doc.id]&&delete updateHandlers[t.doc.id],setTimeout(function(){a.remove()},3e3)}catch(i){console.log(i)}break;case"modified":try{let o=_(messageTemplete.replace("{sid}",t.doc.id)).querySelector(".xMyW2iRSH");o?(o.clear(),parseMessageContent({content:o},s,!1)):console.log("No matching message container found")}catch(l){console.log("An unknown error occurred while modifying the message",l)}}})},e=>{console.error("An unknown error occurred",e)});allListener[e]=t}function setupLoginUI(){let e=ec("xrYn5ZY3v");e.innerText=translations.b8;let t=mySearchParams.get("j"),a=ec("x4V8Jejrz");t?a.innerText=translations.b54:a.innerText=translations.b9;let o=ec("xRRuA0Z3S"),l=document.createElement("div");l.id="x7BYgkdiJ",l.focusable(!0);let r=`<svg aria-hidden="true" class="xGBqJjpdr" viewBox="0 0 20 20"><path d="M19.6 10.23c0-.82-.1-1.42-.25-2.05H10v3.72h5.5c-.15.96-.74 2.31-2.04 3.22v2.45h3.16c1.89-1.73 2.98-4.3 2.98-7.34z" fill=#4285F4></path><path d="M13.46 15.13c-.83.59-1.96 1-3.46 1-2.64 0-4.88-1.74-5.68-4.15H1.07v2.52C2.72 17.75 6.09 20 10 20c2.7 0 4.96-.89 6.62-2.42l-3.16-2.45z" fill=#34A853></path><path d="M3.99 10c0-.69.12-1.35.32-1.97V5.51H1.07A9.973 9.973 0 000 10c0 1.61.39 3.14 1.07 4.49l3.24-2.52c-.2-.62-.32-1.28-.32-1.97z" fill=#FBBC05></path><path d="M10 3.88c1.88 0 3.13.81 3.85 1.48l2.84-2.76C14.96.99 12.7 0 10 0 6.09 0 2.72 2.25 1.07 5.51l3.24 2.52C5.12 5.62 7.36 3.88 10 3.88z" fill=#EA4335></path></svg>${translations.b11}`,c=`<div class="spinner">
							<svg aria-hidden="true" class="xxA4Cqchz" style="min-width: 20px" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="M12 3a9 9 0 1 0 9 9"></path>
							</svg>
							<span class="xkT2bkntT">${translations.b10}</span>
						</div>`;l.innerHTML=r;let d=document.createElement("div");d.focusable(!0),d.id="xBnuWNG6V",d.className="actionbtn xYIKBnbHS",l.className="actionbtn xYIKBnbHS",d.innerHTML=`<svg aria-hidden="true" class="xGBqJjpdr" viewBox="0 0 20 20"><path d="M1 5.006A2 2 0 012.995 3h14.01A2 2 0 0119 5.006v9.988A2 2 0 0117.005 17H2.995A2 2 0 011 14.994V5.006zM3 5l7 4 7-4v2l-7 4-7-4V5z" fill-rule=evenodd fill=#788aa2></path></svg>${translations.b12}`,o.appendChild(l),o.appendChild(d);let h=new MyDialog;h.Content.classList.add("bt"),h.Root.classList.add("xCmJYJQtp"),h.Content.classList.add("xySmLVr4a"),h.Content.appendChild(e),h.Content.appendChild(a),h.Content.appendChild(o);let u=ec("xrYn5ZY3v");u.classList.add("lf"),u.classList.add("gc");let p=ec("xZyuwxZPZ");p.focusable(!0),p.innerHTML='<svg style="min-width: 24px" aria-hidden="true" class="xRmN7l0Zc" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m12 19-7-7 7-7"></path><path d="M19 12H5"></path></svg>',u.appendChild(p);let m=ec("x6Y89FynP");m.innerText=translations.b27,u.appendChild(m);let g=ec("xWDUelLWA");g.classList.add("xwxpzc3QF"),h.Content.appendChild(u),h.Content.appendChild(g);let $=document.createElement("div");g.appendChild($),$.classList.add("xZdL9CF5M");let b=document.createElement("div");b.classList.add("xGGKUZ7B3"),$.appendChild(b);let f=document.createElement("label");f.classList.add("xF37V7xd0"),f.innerText=translations.b24,b.appendChild(f);let v=document.createElement("input");v.classList.add("xYvZ9WF6d"),v.autocomplete="off",v.type="text",v.disabled=!0,v.spellcheck=!1,b.appendChild(v);let x=document.createElement("div");x.classList.add("xGGKUZ7B3"),x.style.marginTop="10px",x.style.marginBottom="5px",$.appendChild(x);let C=document.createElement("label");C.classList.add("xF37V7xd0"),C.innerText=translations.b25,x.appendChild(C);let y=document.createElement("input");y.classList.add("xYvZ9WF6d"),y.type="password",y.disabled=!0,y.autocomplete="off",x.appendChild(y);let w=document.createElement("div");w.classList.add("xw0IanPrC"),$.appendChild(w);let k=document.createElement("div");k.innerText=translations.b26,k.classList.add("disabled"),k.classList.add("x40AApYkW"),$.appendChild(k);let L=ec("xPT7rhLdL");L.focusable(!0),L.innerHTML=`<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M9 14l-4 -4l4 -4" /><path d="M5 10h11a4 4 0 1 1 0 8h-1" /></svg>${translations.b13}`,L.bindWithCooldown(function(){h.Content.classList.remove("xA7y7OLtP"),k.classList.add("disabled"),k.focusable(!1),v.disabled=!0,y.disabled=!0}),$.appendChild(L),p.bindWithCooldown(function(){h.Content.classList.remove("xA7y7OLtP"),k.classList.add("disabled"),k.focusable(!1),v.disabled=!0,y.disabled=!0});let D=!0,E=function(){D&&(D=!1,p.classList.add("disabled"),p.focusable(!1),w.classList.remove("show"),k.innerHTML='<svg aria-hidden="true" class="x3xXCjYFp" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"/></svg>',v.disabled=!0,y.disabled=!0,k.classList.add("disabled"),k.focusable(!1),k.blur(),L.classList.add("disabled"),L.focusable(!1),i(auth,v.value,y.value).then(e=>{try{h.close(),α.close()}catch(t){}let n=e.user;console.log("User is logged in: ",n)}).catch(e=>{setTimeout(function(){let t=e.code;switch(w.classList.add("show"),t){case"auth/invalid-login-credentials":w.innerText=translations.b14;break;case"auth/invalid-email":w.innerText=translations.b15;break;case"auth/network-request-failed":w.innerText=translations.b16;break;default:w.innerText=translations.b17}k.innerHTML=translations.b26,k.classList.remove("disabled"),k.focusable(!0),L.classList.remove("disabled"),L.focusable(!0),v.disabled=!1,y.disabled=!1,p.classList.remove("disabled"),p.focusable(!0),D=!0},3e3)}))};y.onkeydown=function(e){13===e.keyCode&&E()},k.bindWithCooldown(E),l.bindWithCooldown(function(){l.classList.add("disabled"),d.classList.add("disabled"),l.innerHTML=c,l.focusable(!1),d.focusable(!1),n(auth,provider).then(e=>{s.credentialFromResult(e).accessToken,getUserProfile(userId=e.user.uid).then(e=>{try{updateApp(e.avatarUrl,e.name,e.qid||e.id)}catch(t){console.error("Unable to set")}h.close()}).catch(e=>{console.error(e)})}).catch(e=>{"auth/popup-closed-by-user"===e.code&&(l.classList.remove("disabled"),d.classList.remove("disabled"),l.focusable(!0),d.focusable(!0),l.innerHTML=r)})}),d.bindWithCooldown(function(){h.Content.classList.add("xA7y7OLtP"),v.disabled=!1,y.disabled=!1,k.focusable(!0),k.classList.remove("disabled"),v.focus()})}function setupProfileSettingUI(e="",t="",n="",...s){let a=new MyDialog({closeOnEsc:!0,closeOnOverlayClick:!0,excludeElements:s});a.Root.classList.add("xMCbxIsn5"),a.Content.style.padding="0";let i=ec("xrYn5ZY3v");i.classList.add("lf");let o=ec("x6Y89FynP");o.innerText=translations.b5,i.appendChild(o);let l=ec("xvb5soWNa");l.focusable(!0),l.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>',a.close=a.close.bind(a),l.bindWithCooldown(a.close),i.appendChild(l),a.Content.appendChild(i);let r=ec("xWDUelLWA");a.Content.appendChild(r);let c=ec("xGGKUZ7B3"),d=document.createElement("label");d.innerText=translations.b4,d.classList.add("xF37V7xd0");let h=`_${generateRandomString(12)}`;d.htmlFor=h;let u=document.createElement("input");u.value=e,u.classList.add("xYvZ9WF6d"),u.id=h,u.type="text",u.maxLength="24",u.autocomplete="off",u.spellcheck=!1,u.onfocus=function(){$.classList.add("xGeitQv44")},u.onblur=function(){$.classList.remove("xGeitQv44")};let $=ec("x4GdmVqBP");$.innerText=translations.f25,r.appendChild(c),c.appendChild(d),c.appendChild(u),c.appendChild($);let x=!1,C=ec("xGGKUZ7B3"),w=document.createElement("label");w.innerText=translations.b55,w.classList.add("xF37V7xd0");let k=`_${generateRandomString(12)}`;w.htmlFor=k;let L=document.createElement("input");function D(){x=L.value.trim()!==n}L.value=n,L.classList.add("xYvZ9WF6d"),L.id=k,L.type="text",L.maxLength="12",L.autocomplete="off",L.spellcheck=!1,L.oninput=function(){D()},L.onkeydown=function(){D()},L.onkeyup=function(){D()},L.onfocus=function(){E.classList.add("xGeitQv44")},L.onblur=function(){E.classList.remove("xGeitQv44")};let E=ec("x4GdmVqBP");E.innerText=translations.f26,C.appendChild(w),C.appendChild(L),C.appendChild(E),r.appendChild(C);let S=ec("xGGKUZ7B3"),M=document.createElement("label");M.innerText=translations.b3,M.classList.add("xF37V7xd0");let T=`_${generateRandomString(12)}`;M.htmlFor=T;let I=document.createElement("textarea");I.value=t,I.classList.add("xGuwEx6qN"),I.id=T,I.rows="3",I.maxLength="108",I.autocomplete="off",I.spellcheck=!1,I.onfocus=function(){R.classList.add("xGeitQv44")},I.onblur=function(){R.classList.remove("xGeitQv44")};let R=ec("x4GdmVqBP");R.innerText=translations.f27,r.appendChild(S),S.appendChild(M),S.appendChild(I),S.appendChild(R);let A=ec("x40AApYkW");function P(){I.value.trim()!==t.trim()||u.value.trim()!==e.trim()||L.value.trim()!==n.trim()?(A.classList.remove("disabled"),A.focusable(!0)):(A.classList.add("disabled"),A.focusable(!1))}async function z(){A.classList.add("disabled"),A.innerHTML='<svg aria-hidden="true" class="x3xXCjYFp" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12a9 9 0 1 1-6.219-8.56"></path></svg>',A.focusable(!1),u.disabled=!0,L.disabled=!0,I.disabled=!0;let e=!1,t=L.value.trim();if(!0===x){var n;if(n=t,/^[a-zA-Z0-9_.]+$/.test(n)){let s=await v(y(p(db,"users"),f("qid","==",t)));s.empty?e=!0:s.docs[0].id===userId&&(e=!0)}}let i=u.value,o=I.value.trim(),l=t,r=await b(g(db,"users",userId)),c={name:i,signature:o};!0===e&&(c.qid=l),r.exists()?await updateUserProfile(userId,c):(c.id=userId,c.joined=[],c.deviceInfo="",await m(g(db,"users",userId),c),components.primaryArea.innerHTML=`<div class="xzF3bjGCc">${translations.d7}</div>`),components.nameLabel.innerText=i,userPSCState._m.forEach(e=>{e.userId===userId&&(e.dom.textContent=`@${i}`)}),userPSCState.state&&(userPSCState._n=i,userPSCState._d=o,e&&(userPSCState._f=l,components.signatureLabel.textContent=l,userPSCState._k&&(userPSCState._c.textContent=l)),userPSCState._a.innerText=i,userPSCState._b.innerHTML=replaceUrlsWithLinks(escapeHTML(o))||translations.d10),a.close()}A.innerText=translations.b7,A.classList.add("disabled"),A.style.marginTop="0",r.appendChild(A),I.oninput=P,L.oninput=P,u.oninput=P,A.bindWithCooldown(z),u.focus()}async function preActionofCreate(e,t){let n=await v(p(db,"chats",e.id,"messages"));allGroups.some(t=>t.id===e.id)||createChatRoom({name:e.name,id:e.id,type:e.type,tag:e.tag,description:e.description,size:n.size,members:e.members,focus:t,identity:e.identity})}async function loadAllChatRoom(){components.primaryArea.classList.add("xuGldtFot");let e=await b(g(db,"users",userId)),t=e.data(),n=mySearchParams.get("r"),s=mySearchParams.get("j"),a=t.joined||[];async function i(t){await D(g(db,"chats",t),{members:k(userId)}),await D(g(db,"users",userId),{joined:k(t)}),getRoomData(t).then(async s=>{preActionofCreate({id:t,name:s.name,type:s.type,tag:s.tag,plugins:s.plugins,members:s.members,description:s.description,identity:s.identity},n===e)})}if(s&&-1===a.indexOf(s)){let o=g(db,"chats",s,"joinRequests",userId),l=!1;try{l=(await b(o)).exists()}catch(r){l=!1}if(l){let c=new URL(window.location.href);c.searchParams.delete("j"),window.history.replaceState({},"",c),new AlertDialog({title:translations.k1,message:translations.k2,closeOnEsc:!0,closeOnOverlayClick:!0,buttons:[{text:translations.k3},]}).Root.classList.add("xTgytTEJX")}else getRoomData(s).then(e=>{"public"===e.type?new AlertDialog({title:translations.k1,message:translations.k8.replace("$0",`<span class="xgdnWC7ey">${e.name}</span>`),closeOnEsc:!0,closeOnOverlayClick:!0,buttons:[{text:translations.k3,onClick:function(){try{i(s)}catch(e){console.log(e)}},classList:["xqYxvdVGo"]},{text:translations.k5,onClick:function(){let e=new URL(window.location.href);e.searchParams.delete("j"),window.history.replaceState({},"",e)}},]}).Root.classList.add("xTgytTEJX"):new AlertDialog({title:translations.k1,message:translations.k4.replace("$0",`<span class="xgdnWC7ey">${e.name}</span>`),closeOnEsc:!0,closeOnOverlayClick:!0,buttons:[{text:translations.k3,onClick:async function(){try{await m(o,{userId:userId,status:"pending",createdAt:S()});let e=new URL(window.location.href);e.searchParams.delete("j"),window.history.replaceState({},"",e)}catch(t){console.log(t)}},classList:["xqYxvdVGo"]},{text:translations.k5,onClick:function(){let e=new URL(window.location.href);e.searchParams.delete("j"),window.history.replaceState({},"",e)}},]}).Root.classList.add("xTgytTEJX")})}a.length>0?t.joined.map(async e=>{try{getRoomData(e).then(async t=>{preActionofCreate({id:e,name:t.name,type:t.type,tag:t.tag,plugins:t.plugins,members:t.members,description:t.description,identity:t.identity},n===e)})}catch(t){console.error("Error fetching document for ID:",e,t)}}):components.primaryArea.innerHTML=`<div class="xzF3bjGCc">${translations.d13}</div>`}a(auth,e=>{e?(getUserProfile(userId=e.uid).then(e=>{if(!e){setupProfileSettingUI();return}updateApp(e.avatarUrl,e.name,e.qid||e.id)}).catch(e=>{console.error(e),updateApp()}),initialize()):(userId="",setupLoginUI())});let fileIcons={audio:'<path d="M17.5 22h.5a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3" /><path d="M14 2v4a2 2 0 0 0 2 2h4" /><path d="M2 19a2 2 0 1 1 4 0v1a2 2 0 1 1-4 0v-4a6 6 0 0 1 12 0v4a2 2 0 1 1-4 0v-1a2 2 0 1 1 4 0" />',video:'<path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z" /><path d="M14 2v4a2 2 0 0 0 2 2h4" /><path d="m10 11 5 3-5 3v-6Z" />',image:'<path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z" /><path d="M14 2v4a2 2 0 0 0 2 2h4" /><circle cx="10" cy="12" r="2" /><path d="m20 17-1.296-1.296a2.41 2.41 0 0 0-3.408 0L9 22" />',archive:'<path d="M10 12v-1" /><path d="M10 18v-2" /><path d="M10 7V6" /><path d="M14 2v4a2 2 0 0 0 2 2h4" /><path d="M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01" /><circle cx="10" cy="20" r="2" />',others:'<path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z" /><path d="M14 2v4a2 2 0 0 0 2 2h4" />'};function tryToLoad(){let e=components.messageContainer.scrollTop;""!==userId&&""!==currentRoom&&!isScrollEventActive&&e<=0&&loadMessages(currentRoom)}function updateButtonsStatus(){""!==components.messageInput.innerText.trim()?(components.sendButton.classList.remove("disabled"),components.sendButton.focusable(!0)):(components.sendButton.classList.add("disabled"),components.sendButton.focusable(!1))}function back(){components.backButton.classList.add("disabled"),components.backButton.focusable(!1),contextOpened=!1,components.sidebar.removeAttribute("inert"),activingView=components.sidebar,components._mb_att_btn.classList.add("disabled"),components._mb_att_btn.focusable(!1);let e=window.location.href.replace(/\?.*$/,"");window.history.replaceState(null,"",e),components.main.classList.remove("x8VAGH6N2"),isScrollEventActive=!0,components.messageContainer.clear(),isScrollEventActive=!1,currentRoom="",titleTemplete="Structure",document.title=titleTemplete,components.messageInput.clear(),components.messageInput.setAttribute("contenteditable","true"),components.messageInput.focusable(!1),components.sendButton.classList.add("disabled"),components.sendButton.focusable(!1)}components.fileInput.onchange=async function(e){let t=e.target.files[0];if(!t||""===currentRoom)return;let n=new MyDialog({closeOnEsc:!0,closeOnOverlayClick:!0});n.Overlay.classList.add("xOjXmYkxE"),n.Lock=!0;let s=ec("xrYn5ZY3v");s.classList.add("lf");let a=ec("xWDUelLWA");a.classList.add("xIOucKmLX"),n.Content.appendChild(s),n.Content.appendChild(a),n.Content.classList.add("gt");let i=ec("x6Y89FynP"),o=ec("xujSSErs5");s.appendChild(i),a.appendChild(o);let l=ec("xvb5soWNa");if(l.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',l.focusable(!0),s.appendChild(l),t.size>52428800){i.innerText=translations.b48,o.innerText=translations.b49.replace("$0",formatFileSize(t.size)),l.onclick=function(){components.fileInput.value="",n.close.bind(n)()},n.Lock=!1;return}i.innerText=translations.b42,o.innerText=translations.b43;let h=document.createElement("div");h.classList.add("xCECpHDwZ"),h.focusable(!0),a.appendChild(h);let u=document.createElement("div");u.classList.add("xty9qDHrl"),h.appendChild(u);let $=document.createElement("div");$.classList.add("xIEj1ZAnA");let b=String(t.type),f="",v="";if(b.startsWith("image/")){f=fileIcons.image;try{let x=new Image;x.onload=function(){v=`< image {u} ${x.width/x.height}`,L()},x.src=URL.createObjectURL(t)}catch(C){v="< image {u}",L()}}else b.startsWith("video/")?(f=fileIcons.video,v="< video {u}",L()):b.startsWith("audio/")?(f=fileIcons.audio,v="< audio {u}",L()):-1!==["application/x-zip-compressed","application/zip","application/x-rar-compressed","application/vnd.rar","application/x-compressed",].indexOf(b)?(f=fileIcons.archive,v="< other {u}",L()):"application/pdf"===b?(f=fileIcons.others,v="< pdf {u}",L()):(f=fileIcons.others,v="< other {u}",L());$.innerHTML=`<svg aria-hidden="true" style="min-width: 28px" xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">${f}</svg>`,u.appendChild($);let y=document.createElement("div");y.classList.add("xxs4n9nhX"),u.appendChild(y),y.innerHTML='<div class="xTGGn7ABj">'.concat(t.name).concat(`</div><div class="xtyaQiCLO">${formatFileSize(t.size)}</div>`),u.appendChild(y);let w=document.createElement("div");w.classList.add("xsoLox5sj"),u.appendChild(w);let k=document.createElement("div");function L(){let e="";try{e=`${generateRandomString(12)}-${t.name}`}catch(s){console.log("An unknown error occurred while generating the file name",s)}let a=r(storage,`uploads/${currentRoom}/attachment/${e}`),u=c(a,t);l.onclick=function(){i.innerText=translations.b44,o.innerText=translations.b45,n.Lock=!1,u.cancel(),components.fileInput.value="",n.close()};let $=Date.now(),b=0;u.on("state_changed",e=>{let t=Date.now(),n=(t-$)/1e3;if(n<.3)return;let s=e.bytesTransferred,a=(s-b)/n,i=e.totalBytes-s;$=t,b=s,o.innerText=translations.b53.replace("$0",formatNumberWithCommas((a>0?i/a:0).toFixed(0))).replace("$1",formatFileSize(a||0));let l=e.bytesTransferred/e.totalBytes*100;k.style.width=`${l}%`},e=>{console.log(e)},async()=>{let e=await d(u.snapshot.ref),t="";t=v.replace("{u}",e);let s=g(p(db,"chats",currentRoom,"messages"));allMessages.push(s.id),await m(s,{sender:userId,content:t,timestamp:Date.now(),timestamp2:S()}),displaySentMessage({content:t},s.id,"3"),lastMessageInfo={sender:userId},components.fileInput.value="",h.remove(),i.innerText=translations.b46,o.innerText=translations.b47,l.onclick=()=>{},n.Lock=!1,l.bindWithCooldown(function(){n.close()})})}k.classList.add("xk0osKWCK"),w.appendChild(k)},document.addEventListener("visibilitychange",function(){"visible"===document.visibilityState&&(document.title=titleTemplete,unreadCount=0,navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({action:"reset-unread"}))}),components.searchInput.oninput=function(){let e=components.searchInput.value.toLowerCase().trim();""!==e?allGroups.forEach(t=>{t.name.toLowerCase().includes(e)?t.dom.classList.remove("hide"):t.dom.classList.add("hide")}):allGroups.forEach(e=>{e.dom.classList.remove("hide")})},components.searchInput.onfocus=function(){document.body.classList.add("x53lmwdXM")},components.searchInput.onblur=function(){document.body.classList.remove("x53lmwdXM")},components.messageContainer.addEventListener("scroll",function(){tryToLoad()}),components.messageInput.oninput=function(){let e=components.messageInput.childNodes;1==e.length&&("BR"===e[0].nodeName||"DIV"===e[0].nodeName)&&components.messageInput.clear(),updateButtonsStatus()},components.messageInput.onfocus=function(){document.body.classList.add("xYIbDcl9T")},components.messageInput.onblur=function(){document.body.classList.remove("xYIbDcl9T")},components.messageInput.onpaste=function(e){e.preventDefault(),document.execCommand("insertHTML",!0,escapeHTML((e.clipboardData||window.Clipboard).getData("text/plain")))},components.messageInput.ondrop=function(e){e.preventDefault();let t=e.dataTransfer.getData("text/plain");e.target.focus(),document.execCommand("insertHTML",!0,escapeHTML(t))},components.messageInput.oncopy=function(e){e.preventDefault();var t=window.getSelection().toString();e.clipboardData.setData("text/plain",t)},components.messageInput.addEventListener("keydown",function(e){switch(e.keyCode){case 13:isMobileDevice||e.shiftKey||(e.preventDefault(),handleSendMessage());break;case 85:case 66:case 73:e.ctrlKey&&e.preventDefault()}}),components.sendButton.bindWithCooldown(function(){navigator.vibrate(30),handleSendMessage()}),document.onkeydown=function(e){switch(e.keyCode){case 191:let t=document.activeElement;t==components.messageInput||t==components.searchInput||"INPUT"==t.tagName.toUpperCase()||t.classList.contains("xGuwEx6qN")||t.classList.contains("xYvZ9WF6d")||(e.preventDefault(),components.messageInput.focus());break;case 75:e.ctrlKey&&initialized&&(e.preventDefault(),components.searchInput.focus());break;case 123:e.preventDefault();break;case 67:e.ctrlKey&&e.shiftKey&&e.preventDefault();break;case 85:case 187:case 189:case 80:case 83:case 79:case 109:case 107:e.ctrlKey&&e.preventDefault();break;case 37:case 39:e.altKey&&e.preventDefault()}},document.querySelectorAll("body > div").forEach(function(e){e.onwheel=function(e){e.ctrlKey&&e.preventDefault()}}),components.backButton.bindWithCooldown(function(){back()});let cacheCleared=!1;components.profileContainer.bindWithCooldown(function(){components.sidebar.classList.add("x9EnCPd4S");try{navigator.vibrate(30)}catch(e){console.log(e)}let t=new MyPopover({trigger:components.profileContainer,placement:"top"});t.Content.classList.add("xLhiIL2Wm");let n=ec("xrQdSHI2A");n.focusable(!0),n.innerHTML=`<svg aria-hidden="true" style="min-width: 24px;" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M14 6m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M4 6l8 0" /><path d="M16 6l4 0" /><path d="M8 12m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M4 12l2 0" /><path d="M10 12l10 0" /><path d="M17 18m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" /><path d="M4 18l11 0" /><path d="M19 18l1 0" /></svg>${translations.f20}`,n.bindWithCooldown(function(){t.close();let e;if(isMobileDevice)e=new NavigationView({parent:components.sidebar,title:translations.f20}).Content;else{let n=new HeadingDialog(translations.f20,!0);n.Content.classList.add("lg"),e=n.body}function s(e,t){let n=document.createElement("label");n.classList.add("xXhKBDWcA");let s=ec("xnrc3UgAV");if(n.appendChild(s),"cb"===t.type){let a=ec("xoKmBEVCz"),i=ec("xhaYJ4QyT");a.textContent=t.title,i.textContent=t.desc;let o=document.createElement("input");o.type="checkbox";let l=`_${generateRandomString(12)}`;o.id=l,n.htmlFor=l,o.classList.add("cls-switch"),null==myStorage.get(t.id)?o.checked=t.checked:o.checked=myStorage.get(t.id),o.onchange=function(){navigator.vibrate(30),myStorage.set(t.id,o.checked),t.onChange&&t.onChange(o.checked)},n.appendChild(o),s.appendChild(a),s.appendChild(i)}else if("cl"===t.type){let r=ec("xoKmBEVCz"),c=ec("xhaYJ4QyT");r.textContent=t.title,c.textContent=t.desc;let d=document.createElement("select"),h=`_${generateRandomString(12)}`;for(let u in d.id=h,n.htmlFor=h,d.classList.add("cls-select"),t.options)if(t.options.hasOwnProperty(u)){let p=document.createElement("option");p.textContent=t.options[u],p.value=u,u===t.default&&p.setAttribute("selected",!0),d.appendChild(p)}d.onchange=function(){},d.onchange=function(){navigator.vibrate(30),myStorage.set(t.id,d.checked),t.onChange&&t.onChange(d.value)},n.appendChild(d),s.appendChild(r),s.appendChild(c)}else if("btn"===t.type){let m=ec("xoKmBEVCz");n.classList.add("xmdgdJduU"),n.focusable(!0),t.disabled&&n.classList.add("disabled"),m.textContent=t.label,n.bindWithCooldown(function(){t.trigger({labelEle:m,ButtonEle:n})}),t._init&&t._init({_labelEle:m}),s.appendChild(m)}else{let g=ec("xoKmBEVCz"),$=ec("xhaYJ4QyT");g.textContent=translations.d9,$.textContent=translations.d9,s.appendChild(g),s.appendChild($)}e.appendChild(n)}let a=ec("x1jN4Fp9f"),i=ec("x1jN4Fp9f"),o=ec("xWbgA3bRM"),l=ec("xmRZa1NtY");o.textContent=translations.s9,a.appendChild(o),a.appendChild(l);let r=ec("xWbgA3bRM"),c=ec("xmRZa1NtY");r.textContent=translations.s11,i.appendChild(r),i.appendChild(c),[{id:"globalTheme",title:translations.g8,desc:translations.g9,default:myStorage.get("globalTheme","default"),options:{default:translations.g10,gray:translations.g11},onChange:function(e){document.body.setAttribute("theme",e),myStorage.set("globalTheme",e)},type:"cl"},{id:"STG-ed2ae423-e0f2-4c34-88b2-0f70ec91d1a4",title:translations.c10,desc:translations.c11,default:currentLanguage,options:{zh:"繁體中文",zh2:"简体中文",en:"English",ja:"日本語",kr:"한국어"},onChange:function(e){myStorage.set("lang",e)},type:"cl"},{id:"STG-fd830aa6-3d32-40f4-a765-4eccc1229d4a",title:translations.c6,desc:translations.c7,checked:!1,onChange:function(e){!0===e&&initPush()},type:"cb"},{id:"STG-8dac6660-22f9-412e-b1b4-14a1e1657ad2",title:translations.f12,desc:translations.f13,checked:!1,type:"cb"},{id:"STG-71b4e340-577f-4b7b-aead-6958f2b19aa1",title:translations.f23,desc:translations.f24,checked:!1,type:"cb"},{id:"STG-e2136432-cb43-46c2-8f5b-bfbdd738dadf",title:translations.c8,desc:translations.c9,checked:!0,type:"cb"},].forEach(e=>{s(l,e)}),[{id:"STG-252a9b54-19c6-4ecd-9d22-ba36aa6e45ee",label:translations.s3,type:"btn",trigger:function(){let e=new MyDrawer({closeOnEsc:!0,closeOnOverlayClick:!0});e.Overlay.classList.add("xIkbBJgzp"),e.Body.innerHTML=`
					<div class="xHNNAeZhF">
						<div class="xyctbgO0V">
							<div class="xLu4Zx9Ip">
								<img class="x1CwyTvZp xic1QFKBR" src="assets/draft1.png" draggable="false" loading="lazy">
								<img class="x1CwyTvZp xiFFOSLtS" src="assets/draft2.png" draggable="false" loading="lazy">
							</div>
						</div>
						<div class="xrbR4QxkX">
							<span class="xRDXgIF4B">${translations.s1.replace("$0",versionInfo.current)}</span>
							<span class="xRDXgIF4B">${translations.s2.replace("$0","kunelinmc")}</span>
						</div>
					</div>`}},{id:"STG-b09e309b-bccb-41a5-a17a-8579ce9854c6",label:cacheCleared?translations.f21:translations.f11,disabled:cacheCleared,_init:function(e){navigator.storage&&navigator.storage.estimate&&!cacheCleared&&navigator.storage.estimate().then(t=>{let n=t.usage;e._labelEle.textContent=translations.f28.replace("$0",formatFileSize(n))})},type:"btn",trigger:function(e){new AlertDialog({title:translations.k1,message:translations.g12,closeOnEsc:!0,closeOnOverlayClick:!0,buttons:[{text:translations.b36,classList:["xTJA9U7y9"],onClick:function(){navigator.serviceWorker?.controller?.postMessage({action:"clear-all-caches"}),e.labelEle.textContent=translations.f21,e.ButtonEle.classList.add("disabled"),myStorage.clear(),cacheCleared=!0}},{text:translations.b35},]})}},].forEach(e=>{s(c,e)}),e.appendChild(a),e.appendChild(i)});let s=ec("xrQdSHI2A");s.focusable(!0),s.innerHTML=`<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M8 7a4 4 0 1 0 8 0a4 4 0 0 0 -8 0" /><path d="M6 21v-2a4 4 0 0 1 4 -4h1.5" /><path d="M18 18m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /><path d="M20.2 20.2l1.8 1.8" /></svg>${translations.a15}`,s.bindWithCooldown(function(){t.close(),getUserProfile(userId).then(e=>{userInfoShowCase(components.sidebar,{data:e,type:isMobileDevice?"mobile":"desktop"})}).catch(e=>{console.error(e)})});let a=ec("xcoXgMpFW");a.setAttribute("role","separator");let i=ec("xrQdSHI2A");i.focusable(!0),i.bindWithCooldown(function(){t.close(),new AlertDialog({title:translations.k1,message:translations.g13,closeOnEsc:!0,closeOnOverlayClick:!0,buttons:[{text:translations.b36,classList:["xqYxvdVGo"],onClick:function(){o(auth).then(()=>{myStorage.clear(),userId="",currentRoom="",Object.keys(updateHandlers).forEach(e=>delete updateHandlers[e]),allGroups.length=0,allMessages.length=0,initialized=!1,lastMessageInfo="";let e=window.location.href.replace(/\?.*$/,"");for(let t in window.history.replaceState(null,"",e),components.primaryArea.clear(),components.messageContainer.clear(),allListener)allListener[t](),console.log(`Listener for ${t} removed.`);Object.keys(allListener).forEach(e=>delete allListener[e]),loadInterval&&clearInterval(loadInterval),localStorage.setItem("cvs",""),chatPrompt&&(chatPrompt.remove(),chatPrompt=null),document.body.classList.remove("xmKH3ad5R"),components.profileContainer.classList.remove("disabled"),components.profileContainer.focusable(!0),components.markButton.classList.add("disabled"),components.brushButton.classList.add("disabled"),components.attachButton.classList.add("disabled"),components.stickerButton.classList.add("disabled"),markingState=!1,components.avatarWrapper.classList.add("xJd2GT7MI"),components.avatarLabel.src="",components.nameLabel.innerText="",components.signatureLabel.innerText=""}).catch(e=>{console.error("Sign out error",e)})}},{text:translations.b35},]})}),i.innerHTML=`<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"><path d="M14 8v-2a2 2 0 0 0 -2 -2h-7a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h7a2 2 0 0 0 2 -2v-2" /><path d="M9 12h12l-3 -3" /><path d="M18 15l3 -3" /></svg>${translations.a16}`,bindMenuNavigation([n,s,i]),t.Content.appendChild(n),t.Content.appendChild(s),t.Content.appendChild(a),t.Content.appendChild(i),t._setPosition(),t.onClose(()=>{components.sidebar.classList.remove("x9EnCPd4S")})});class NavigationView{constructor({parent:e,title:t,moveBySide:n=!0}){let s=e,a=ec("xB4hVI3El"),i=ec("xopQXJrX5"),o=ec("xZz4zYjIm"),l=ec("xMyenRl7K"),r=ec("x8JU9DbQZ"),c=ec("xvwhg72ii"),d=ec("xrmHEPLUI"),h=ec("xEKOvqsme");this._parent=s,this._overlay=d,this.Root=a,this.Content=o,this.Heading=i,this._backButton=r,this._sidehandle=h;let u=!1,p=0,m=0,g=0,$=0;a.onwheel=function(e){e.ctrlKey&&e.preventDefault()};let b=e=>{u=!0,m=0,p=Date.now(),$=(g=e.touches?e.touches[0].clientX:e.clientX)-e.target.getBoundingClientRect().left,document.addEventListener("mousemove",f),document.addEventListener("mouseup",v),document.addEventListener("touchmove",f,{passive:!0}),document.addEventListener("touchend",v)},f=t=>{if(!u)return;let n=(t.touches?t.touches[0].clientX:t.clientX)-$,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;m=n,this.Root.classList.add("xp4HXkJGa"),e.classList.add("xgu6pGjzk"),this.Root.style.transform=`translate3d(${Math.max(Math.min(n,s),0)}px, 0, 0)`,e.style.transform=`translate3d(${Math.max(Math.min(-30*(1-n/s),0),-30)}%, 0, 0)`},v=()=>{if(!u)return;u=!1;let t=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;this.Root.classList.remove("xp4HXkJGa"),e.classList.remove("xgu6pGjzk"),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",f,{passive:!0}),document.removeEventListener("touchend",v);let n=(m-g)/((Date.now()-p)/1e3),s=t;(m/t>.5||n>s)&&this.close()},x=()=>{u=!1,e.classList.remove("xgu6pGjzk"),this.Root.classList.remove("xp4HXkJGa"),document.removeEventListener("mousemove",f),document.removeEventListener("mouseup",v),document.removeEventListener("touchmove",f,{passive:!0}),document.removeEventListener("touchend",v)};window.addEventListener("blur",x),this._descriptWOB=function(){window.removeEventListener("blur",x)},h.addEventListener("mousedown",e=>{b(e)}),h.addEventListener("touchstart",b,{passive:!0}),this._deactivated_elements=document.querySelectorAll("body > *:not(.xEHCrF5Oe, script, [hidden])"),this._deactivated_elements.forEach(e=>{e.setAttribute("inert","true")}),i.appendChild(l),l.appendChild(r),l.appendChild(c),c.textContent=t,r.focusable(!0),r.innerHTML=`<svg style="min-width: 24px" aria-hidden="true" class="xvx75W2b4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
								<path d="m12 19-7-7 7-7"></path>
								<path d="M19 12H5"></path>
							</svg>`,r.bindWithCooldown(this.close.bind(this)),a.appendChild(i),a.appendChild(o),a.appendChild(h),a.appendChild(d),document.body.appendChild(a),setTimeout(function(){activingView=a,s.classList.add("xCr0RyqCg"),a.classList.add("xa2pPtuLq")},50)}onClose(e){this.onCloseCallback=e}close(){this.onCloseCallback&&this.onCloseCallback(),this._descriptWOB&&this._descriptWOB(),this._deactivated_elements.forEach(e=>{e.removeAttribute("inert")}),activingView=this._parent,this.Root.classList.remove("xa2pPtuLq"),this._parent.classList.remove("xCr0RyqCg"),this._parent.classList.remove("xjv5U11Kz"),this.Root.classList.remove("xjv5U11Kz"),setTimeout(()=>{this.Root.remove()},100)}}async function userInfoShowCase(e,t){console.log(t),userPSCState.state=!0,userPSCState._n||(userPSCState._n=t.data.name||""),userPSCState._d||(userPSCState._d=t.data.signature||""),userPSCState._f&&t.data.id!==userId||(userPSCState._f=t.data.qid||"");let n=ec("xkyfCNAI0"),s=ec("x0zSVRG3y"),a;navigator.serviceWorker?.controller?.postMessage({action:"cache-url",url:t.data.bannerUrl}),navigator.serviceWorker?.controller?.postMessage({action:"cache-url",url:t.data.avatarUrl}),"video"===t.data.bannerType?((a=document.createElement("video")).loop=!0,a.controlslist="nodownload",a.controls=!1,a.setAttribute("muted",""),a.playsInline=!0,a.preload=!0,a.autoplay=!0,a.src=t.data.bannerUrl):((a=document.createElement("img")).draggable=!1,a.src=t.data.bannerUrl||"assets/default-banner.png",a.loading="lazy"),a.classList.add("x96ofpjeu");let i=ec("xkKF4v6d2"),o=ec("xwvIJoAtO"),l=ec("xXPV6OBbA"),r=document.createElement("img");r.classList.add("xVwXc1fhM");let c=ec("xzCCWGB1D"),d=ec("xCYnK7ffo"),h=ec("xqYV0G7JT"),u=ec("xBjZoCxmV"),p=ec("xjam05uvc"),m=ec("xodqSvoQM"),g=ec("xt0pX9m5p");n.appendChild(s),s.appendChild(a),n.appendChild(i),h.appendChild(o),o.appendChild(r),o.appendChild(l),r.draggable=!1,r.src=t.data.avatarUrl||"assets/avatar.png",r.loading="lazy",i.appendChild(d),i.appendChild(c),c.appendChild(h);let $=ec("x2OCp76zA");c.appendChild($);let b=ec("xokk3UP7N");h.appendChild(b);let f=userPSCState._n,v=ec("x117sdiIx");v.textContent=f,u.appendChild(v),u.appendChild(p);let x=ec("xxXoB6W0R");userPSCState._c=x;let C=1,y=t.data.id===userId?userPSCState._f:t.data.qid;t.data.qid?(userPSCState._k=!0,x.textContent=t.data.qid,x.bindWithCooldown(function(){navigator.vibrate(30),0===C?(C=1,userPSCState._k=!0,typewriterWithBezier(x,y,{interval:10,fadeDuration:144})):(C=0,userPSCState._k=!1,typewriterWithBezier(x,t.data.id,{interval:10,fadeDuration:144}))},0)):x.textContent=t.data.id,b.appendChild(u),b.appendChild(x),userPSCState._a=v,userPSCState._b=m,m.innerHTML=replaceUrlsWithLinks(escapeHTML(userPSCState._d||translations.d10)),i.appendChild(g);let w=ec("xaoY16XE5"),k=ec("xylvbLNlS");k.textContent=translations.b1,w.appendChild(k),w.appendChild(m),g.appendChild(w);let L=ec("xaoY16XE5"),D=ec("xylvbLNlS");D.id="xY3QPRePs",D.textContent=translations.b2;let E=ec("xodqSvoQM");function S(){E.innerText=`${timeAgo(t.data.deviceInfo.lastUpdate)||translations.d9} (${absTime(t.data.deviceInfo.lastUpdate)||translations.d9})`}let M=`_${generateRandomString(12)}`;if(S(),intervalWorks[M]=function(){S()},L.appendChild(D),L.appendChild(E),g.appendChild(L),t.data.verified){let T=ec("xTKxbdpu3");T.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 6 9 17l-5-5"/></svg>',p.appendChild(T)}if("desktop"===t.type){let I=new MyDialog({closeOnEsc:!0,closeOnOverlayClick:!0});I.Content.classList.add("xlY0G76Nv"),I.Content.classList.add("lg"),I.Content.classList.add("gb");let R=ec("xjMiLDVEU"),A=ec("xUHiz9aGO"),P=ec("xhMhXcFlu"),z=ec("xIl46kG8k"),W=ec("xjMYgfYFc");z.appendChild(W),W.textContent=t.data.name,A.appendChild(z),A.appendChild(P);let B=ec("xHPTUCUar");if(B.bindWithCooldown(I.close.bind(I)),B.innerHTML='<svg aria-hidden="true" style="min-width: 24px" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"></path><path d="m6 6 12 12"></path></svg>',B.focusable(!0),t.data.id===userId){let H=ec("xHPTUCUar");H.bindWithCooldown(function(){setupProfileSettingUI(userPSCState._n,userPSCState._d,userPSCState._f,I.Root)}),H.innerHTML=platformIcons.edit,H.focusable(!0),P.appendChild(H),bindMenuNavigation([H,B],"horizontal")}P.appendChild(B),R.appendChild(A),I.Content.appendChild(R),R.appendChild(n);let F=I.Content.getBoundingClientRect();I.Content.style.setProperty("--xD672nKxG",`${F.height}px`),R.onscroll=function(){R.scrollTop>60?R.classList.add("xORN7XV1j"):R.classList.remove("xORN7XV1j")},I.onClose(function(){intervalWorks[M]&&delete intervalWorks[M],userPSCState.state=!1,userPSCState._a=null,userPSCState._b=null,userPSCState._n="",userPSCState._d=""})}else{let O=new NavigationView({parent:e,title:t.data.name});if(t.data.id===userId){let Y=ec("x8JU9DbQZ");Y.classList.add("xnS3FTqjp"),Y.bindWithCooldown(function(){setupProfileSettingUI(userPSCState._n,userPSCState._d,userPSCState._f,O.Root)}),Y.innerHTML=platformIcons.edit,Y.focusable(!0),O.Heading.appendChild(Y)}O.Root.classList.add("xwMgtrL2x"),O.onClose(function(){intervalWorks[M]&&delete intervalWorks[M],userPSCState.state=!1,userPSCState._a=null,userPSCState._b=null,userPSCState._n="",userPSCState._d=""}),O.Root.onscroll=function(){O.Root.scrollTop>0?(O.Root.classList.add("xORN7XV1j"),O.Root.style.setProperty("--xXImc4YaL",`${Math.min(O.Root.scrollTop,60)/5}px`),O.Root.style.setProperty("--xD3Zhkxes",`${Math.min(O.Root.scrollTop,60)/60}`)):(O.Root.classList.remove("xORN7XV1j"),O.Root.style.setProperty("--xXImc4YaL","0px"))},O._backButton.classList.add("xnS3FTqjp"),O.Content.appendChild(n)}}function stickerSelector(e){let t=ec("xUvg7MXC1"),n=ec("xkOSPm9l8"),s=ec("x7q9IoUp7"),a=ec("xRu6ImvzG"),i=ec("xFcpeZeI9"),o=ec("xGUlpzeip");n.appendChild(o);let l=0,r=0,c=!1,d=0,h=0;function u(e){c&&(t.style.left=d+(e.clientX-l)+"px",t.style.top=h+(e.clientY-r)+"px",t.style.right="initial",t.style.bottom="initial")}function p(){c=!1}n.onmousedown=function e(n){l=n.clientX,r=n.clientY;let s=t.getBoundingClientRect();d=s.left,h=s.top,c=!0},document.addEventListener("mousemove",u),document.addEventListener("mouseup",p),s.appendChild(a);let m=[],g=currentLanguage;return -1===["en","zh"].indexOf(g)&&(g="en"),faceEmojis.forEach(e=>{let t=ec("x8oBTYsTf");t.textContent=e.content,t.focusable(!0),new MyTooltip({parent:t,text:e[g],placement:"top"}),t.bindWithCooldown(function(){!function e(t){let n=window.getSelection();if(!n.rangeCount)return;let s=n.getRangeAt(0),a=s.commonAncestorContainer;if(3===a.nodeType&&(a=a.parentNode),!components.messageInput.contains(a)){console.warn("caret not in the specified editing area");return}s.deleteContents();let i=document.createTextNode(t);s.insertNode(i),s.setStartAfter(i),s.setEndAfter(i),n.removeAllRanges(),n.addRange(s),updateButtonsStatus()}(e.content)},0),m.push(t),a.appendChild(t)}),bindMenuNavigation(m,"horizontal"),t.style.right=e.right,t.style.bottom=e.bottom,t.appendChild(n),t.appendChild(s),t.appendChild(i),document.body.appendChild(t),{root:t,destroy:function e(){t.remove(),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",p)}}}async function saveSubscription(e){await m(g(p(db,"subscriptions"),btoa(e.endpoint)),serializeSubscription(e)),console.log("Subscription has been written")}function urlBase64ToUint8Array(e){let t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/\-/g,"+").replace(/_/g,"/"),s=window.atob(n);return Uint8Array.from([...s].map(e=>e.charCodeAt(0)))}function serializeSubscription(e){return{endpoint:e.endpoint,userId:userId,timestamp:S(),keys:{p256dh:e.getKey("p256dh")?btoa(String.fromCharCode(...new Uint8Array(e.getKey("p256dh")))):null,auth:e.getKey("auth")?btoa(String.fromCharCode(...new Uint8Array(e.getKey("auth")))):null}}}async function initPush(){saveSubscription(await (await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:urlBase64ToUint8Array("BOPTi31_UE2bvMbFABIvPRgPqrobDICVVkGSTnJNhQOdfmTVZYQ7fn-vIFE4aZ6ckc-89q4dfiXoGrqDmqHQjWA")}))}"serviceWorker"in navigator&&navigator.serviceWorker.register("/sw.js").then(e=>{e.onupdatefound=()=>{let t=e.installing;t.onstatechange=()=>{"installed"===t.state&&window.location.reload()}}}).catch(e=>{console.log("Registration failed:",e)}),document.addEventListener("contextmenu",function(e){e.preventDefault()});
